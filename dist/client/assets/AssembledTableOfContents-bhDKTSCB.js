import{r as b,j as e,a5 as I}from"./index-C76Zc80P.js";import{D as $,e as T,h as w,a as E}from"./index-Ch13Ujs8.js";const y=794,k=1123,h=3.78,L={portada:"Portada",intermedia:"Contenido",contraportada:"Contraportada"},S=new Set(["intervention_data","client_data"]);function A(l){const s=[];let t={blocks:[]};for(const o of l)o.type==="section_separator"?((t.blocks.length>0||t.separator)&&s.push(t),t={separator:o,blocks:[]}):t.blocks.push(o);return(t.blocks.length>0||t.separator)&&s.push(t),s}function M(l){const s=[],t=[],o=[];let n=!1;for(const a of l)$.has(a.type)?(a.type==="back_cover"&&(n=!0),(T[a.type]||"top")==="bottom"?o.push(a):s.push(a)):t.push(a);return{topChrome:s,content:t,bottomChrome:o,hasBackCover:n}}function O(l){const s=[];let t=[];for(const o of l)o.type==="page_break"?(s.push(t),t=[]):t.push(o);return(t.length>0||s.length===0)&&s.push(t),s}function P(l){const s=[];let t=[];for(const o of l)S.has(o.type)?(t.length>0&&(s.push({type:"group",blocks:[...t]}),t=[]),s.push({type:"alignable",block:o})):t.push(o);return t.length>0&&s.push({type:"group",blocks:t}),s}function C(l,s,t){const o=[];for(const n of l)n._source==="component"&&n._componenteInformeId!==void 0&&n._componenteInformeId!==t.current&&(t.current=n._componenteInformeId,o.push(e.jsxs("div",{className:"w-full flex items-center gap-2 py-2 px-1 my-1",children:[e.jsx(w,{className:"h-3.5 w-3.5 text-blue-500"}),e.jsx("span",{className:"text-xs font-medium text-blue-600",children:n._componenteEtiqueta}),e.jsx("div",{className:"flex-1 border-t border-blue-200"})]},`comp-sep-${n._componenteInformeId}`))),o.push(e.jsx(I.Fragment,{children:s(n)},n.id));return o}function D({canvasWidth:l,canvasHeight:s,pageConfig:t,topChrome:o,bottomChrome:n,contentBlocks:a,hasBackCover:c,marginTop:i,marginRight:g,marginBottom:j,marginLeft:N,renderBlock:m,keyPrefix:d}){const _=b.useMemo(()=>P(a),[a]),x=b.useMemo(()=>({current:void 0}),[]);return e.jsx("div",{className:"bg-white shadow-lg border overflow-hidden",style:{width:l,minHeight:s,fontSize:`${t.fontSize}px`,fontFamily:t.fontFamily?`"${t.fontFamily}", sans-serif`:void 0},children:e.jsxs("div",{className:"flex flex-col",style:{minHeight:s},children:[o.length>0&&e.jsx("div",{className:c?"flex flex-col flex-1":"shrink-0",children:o.map(r=>e.jsx("div",{className:`w-full ${c&&r.type==="back_cover"?"flex-1 flex flex-col":""}`,children:m(r)},`${d}_tc_${r.id}`))}),!c&&a.length>0&&e.jsx("div",{style:{flex:"1 1 0%",display:"flex",flexDirection:"column",overflow:"hidden",padding:`${o.length>0?8:i}px ${g}px ${n.length>0?8:j}px ${N}px`},children:_.map((r,v)=>{if(r.type==="group")return e.jsx("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",flexShrink:0},children:C(r.blocks,m,x)},`${d}_grp_${v}`);const u=r.block.config.verticalAlign||"top",p={flexShrink:0,width:"100%"};u==="center"?(p.marginTop="auto",p.marginBottom="auto"):u==="bottom"&&(p.marginTop="auto");const f=[];return r.block._source==="component"&&r.block._componenteInformeId!==void 0&&r.block._componenteInformeId!==x.current&&(x.current=r.block._componenteInformeId,f.push(e.jsxs("div",{className:"w-full flex items-center gap-2 py-2 px-1 my-1",style:{flexShrink:0},children:[e.jsx(w,{className:"h-3.5 w-3.5 text-blue-500"}),e.jsx("span",{className:"text-xs font-medium text-blue-600",children:r.block._componenteEtiqueta}),e.jsx("div",{className:"flex-1 border-t border-blue-200"})]},`comp-sep-${r.block._componenteInformeId}`))),e.jsxs(I.Fragment,{children:[f,e.jsx("div",{style:p,children:m(r.block)})]},r.block.id)})}),n.length>0&&e.jsx("div",{className:"shrink-0 mt-auto",children:n.map(r=>e.jsx("div",{className:"w-full",children:m(r)},`${d}_bc_${r.id}`))})]})})}function F({blocks:l,pageConfig:s,renderBlock:t}){const o=b.useMemo(()=>A(l),[l]),n=s.orientation==="portrait",a=n?y:k,c=n?k:y,i=s.margins.top*h,g=s.margins.right*h,j=s.margins.bottom*h,N=s.margins.left*h;return e.jsx("div",{className:"flex flex-col items-center gap-8",children:o.map((m,d)=>{const{topChrome:_,content:x,bottomChrome:r,hasBackCover:v}=M(m.blocks),u=O(x);return e.jsxs("div",{className:"flex flex-col items-center w-full gap-6",children:[m.separator&&e.jsxs("div",{className:"w-full flex items-center gap-2 py-2",style:{maxWidth:a},children:[e.jsx("div",{className:"flex-1 border-t-2 border-dashed border-gray-300"}),e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:L[m.separator.config.section]??m.separator.config.section}),e.jsx("div",{className:"flex-1 border-t-2 border-dashed border-gray-300"})]}),u.map((p,f)=>e.jsx(D,{canvasWidth:a,canvasHeight:c,pageConfig:s,topChrome:_,bottomChrome:r,contentBlocks:p,hasBackCover:v&&f===0,marginTop:i,marginRight:g,marginBottom:j,marginLeft:N,renderBlock:t,keyPrefix:`s${d}_p${f}`},`s${d}_p${f}`))]},d)})})}function W({block:l,allBlocks:s}){const t=l.config.title||"Tabla de contenidos",o=b.useMemo(()=>{const n=[];let a=1,c=0;for(const i of s){if(i.type==="section_separator"||i.type==="page_break"){a++;continue}i.type==="section_title"&&(c++,n.push({number:c,title:i.config.title||"",level:i.config.level||1,pageNumber:a}))}return n},[s]);return e.jsxs("div",{className:"py-4 px-2",children:[e.jsx("h3",{className:"text-base font-bold mb-4",children:t}),o.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("p",{className:"text-xs italic",children:"No hay titulos de seccion en el documento"})]}):e.jsx("div",{className:"space-y-2 pl-4 pr-2",children:o.map(n=>e.jsxs("div",{className:"flex items-baseline gap-2",style:{paddingLeft:n.level>1?`${(n.level-1)*16}px`:0},children:[e.jsx("span",{className:"font-semibold text-sm shrink-0 w-5 text-right",children:n.number}),e.jsx("span",{className:"font-medium text-sm truncate",children:n.title}),e.jsx("span",{className:"flex-1 border-b border-dotted border-gray-300 min-w-[20px] self-end mb-0.5"}),e.jsx("span",{className:"text-sm text-muted-foreground shrink-0 font-medium",children:n.pageNumber})]},n.number))})]})}export{W as A,F as D};
