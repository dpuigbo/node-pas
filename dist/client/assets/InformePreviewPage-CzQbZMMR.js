import{c as h,u as p,r as v,j as e,L as _,B as d,A as j,a as u,F as b}from"./index-TL7IIWQo.js";import{a as N}from"./useInformes-Dmygd8DM.js";import{g as w,B as C,F as y}from"./index-DEVkfgGY.js";import{A as B,D as E}from"./AssembledTableOfContents-DFUNxL7m.js";import{C as L}from"./circle-alert-DFzrxT8i.js";import{E as S}from"./eye-CUN2dvri.js";const A={borrador:"bg-gray-100 text-gray-700",finalizado:"bg-amber-100 text-amber-700",entregado:"bg-green-100 text-green-700"},F={borrador:"Borrador",finalizado:"Finalizado",entregado:"Entregado"},k=new Set(["header","section_title","divider","section_separator","cover_header","page_header","page_footer","back_cover","table_of_contents","page_break","content_placeholder","component_section"]),P=new Set(["header","section_title","divider","section_separator","tristate","checklist","table","equipment_exchange","cover_header","page_header","page_footer","back_cover","table_of_contents","page_break","intervention_data","client_data"]);function U(){var x;const{id:s}=h(),a=Number(s),r=p(),{data:t,isLoading:m,error:n}=N(a||void 0),o=(x=t==null?void 0:t.assembled)==null?void 0:x.blocks,l=v.useCallback(c=>c.type==="table_of_contents"&&o?e.jsx("div",{className:"w-full pointer-events-none",children:e.jsx(B,{block:c,allBlocks:o})}):e.jsx($,{block:c}),[o]);if(m)return e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(_,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(n||!t)return e.jsxs("div",{className:"flex h-screen flex-col items-center justify-center gap-4",children:[e.jsx(L,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:(n==null?void 0:n.message)||"No se pudo cargar el informe ensamblado"}),e.jsx(d,{variant:"outline",onClick:()=>r(-1),children:"Volver"})]});const{informe:i,assembled:f,documentTemplate:g}=t;return e.jsxs("div",{className:"flex h-screen flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex h-14 items-center justify-between border-b bg-background px-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>r(`/informes/${a}`),title:"Volver al formulario",children:e.jsx(j,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-semibold",children:i.sistema.nombre}),e.jsx(u,{className:"bg-blue-100 text-blue-800",children:g.nombre}),e.jsx(u,{className:A[i.estado]??"bg-gray-100 text-gray-700",children:F[i.estado]??i.estado})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>r(`/informes/${a}`),children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),"Formulario"]})})]}),e.jsx("div",{className:"flex-1 overflow-auto bg-gray-100",children:e.jsx("div",{className:"py-8 px-4",children:e.jsx(E,{blocks:f.blocks,pageConfig:f.pageConfig,renderBlock:l})})})]})}function $({block:s}){const a=w(s.type);if(!a)return null;const r=T(s),t=C[s.config.align||"left"],n=s.type==="back_cover"?"flex-1 flex flex-col":"";if(k.has(s.type)){const i=a.EditorPreview;return e.jsx("div",{className:`${r} ${t} pointer-events-none ${n}`,children:e.jsx(i,{block:s,isSelected:!1})})}const o=a.FormField;if(o&&s._dataKey)return e.jsx("div",{className:`${r} ${t}`,children:e.jsx(o,{block:s,value:s._dataValue??null,onChange:()=>{},readOnly:!0})});const l=a.EditorPreview;return e.jsx("div",{className:`${r} ${t} pointer-events-none ${n}`,children:e.jsx(l,{block:s,isSelected:!1})})}function T(s){if(P.has(s.type))return"w-full";const a=s.config.width||"full";return y[a]||"w-full"}export{U as default};
