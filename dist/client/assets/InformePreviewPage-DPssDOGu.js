import{c as h,u as p,r as v,j as e,L as _,B as d,A as j,a as x,F as b}from"./index-C76Zc80P.js";import{a as N}from"./useInformes-BC_tZ1nV.js";import{g as w,B as C,F as y}from"./index-Ch13Ujs8.js";import{A as E,D as B}from"./AssembledTableOfContents-bhDKTSCB.js";import{C as L}from"./circle-alert-Bs5d4Wwy.js";import{E as S}from"./eye-CUvNwhTI.js";const A={borrador:"bg-gray-100 text-gray-700",finalizado:"bg-amber-100 text-amber-700",entregado:"bg-green-100 text-green-700"},F={borrador:"Borrador",finalizado:"Finalizado",entregado:"Entregado"},P=new Set(["header","section_title","divider","section_separator","cover_header","page_header","page_footer","back_cover","table_of_contents","page_break","content_placeholder","intervention_data","client_data","component_section"]),T=new Set(["header","section_title","divider","section_separator","tristate","checklist","table","equipment_exchange","cover_header","page_header","page_footer","back_cover","table_of_contents","page_break","intervention_data","client_data"]);function U(){var f;const{id:s}=h(),t=Number(s),r=p(),{data:a,isLoading:o,error:n}=N(t||void 0),i=(f=a==null?void 0:a.assembled)==null?void 0:f.blocks,u=v.useCallback(c=>c.type==="table_of_contents"&&i?e.jsx("div",{className:"w-full pointer-events-none",children:e.jsx(E,{block:c,allBlocks:i})}):e.jsx(k,{block:c}),[i]);if(o)return e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(_,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(n||!a)return e.jsxs("div",{className:"flex h-screen flex-col items-center justify-center gap-4",children:[e.jsx(L,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:(n==null?void 0:n.message)||"No se pudo cargar el informe ensamblado"}),e.jsx(d,{variant:"outline",onClick:()=>r(-1),children:"Volver"})]});const{informe:l,assembled:m,documentTemplate:g}=a;return e.jsxs("div",{className:"flex h-screen flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex h-14 items-center justify-between border-b bg-background px-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>r(`/informes/${t}`),title:"Volver al formulario",children:e.jsx(j,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-semibold",children:l.sistema.nombre}),e.jsx(x,{className:"bg-blue-100 text-blue-800",children:g.nombre}),e.jsx(x,{className:A[l.estado]??"bg-gray-100 text-gray-700",children:F[l.estado]??l.estado})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>r(`/informes/${t}`),children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),"Formulario"]})})]}),e.jsx("div",{className:"flex-1 overflow-auto bg-gray-100",children:e.jsx("div",{className:"py-8 px-4",children:e.jsx(B,{blocks:m.blocks,pageConfig:m.pageConfig,renderBlock:u})})})]})}function k({block:s}){const t=w(s.type);if(!t)return null;const r=$(s),a=C[s.config.align||"left"];if(P.has(s.type)){const i=t.EditorPreview;return e.jsx("div",{className:`${r} ${a} pointer-events-none`,children:e.jsx(i,{block:s,isSelected:!1})})}const o=t.FormField;if(o&&s._dataKey)return e.jsx("div",{className:`${r} ${a}`,children:e.jsx(o,{block:s,value:s._dataValue??null,onChange:()=>{},readOnly:!0})});const n=t.EditorPreview;return e.jsx("div",{className:`${r} ${a} pointer-events-none`,children:e.jsx(n,{block:s,isSelected:!1})})}function $(s){if(T.has(s.type))return"w-full";const t=s.config.width||"full";return y[t]||"w-full"}export{U as default};
