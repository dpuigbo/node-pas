import{c as g,u,r as h,j as e,L as p,B as c,A as v,a as m,F as _}from"./index-6p6AKDyn.js";import{a as j}from"./useInformes-BvSm6jd1.js";import{g as b,B as N,F as w}from"./index-B_I_kZhs.js";import{D as C}from"./DocumentPageLayout-kilSMoyd.js";import{C as y}from"./circle-alert-7ALUcFfl.js";import{E}from"./eye-D0yu_nwH.js";const L={borrador:"bg-gray-100 text-gray-700",finalizado:"bg-amber-100 text-amber-700",entregado:"bg-green-100 text-green-700"},S={borrador:"Borrador",finalizado:"Finalizado",entregado:"Entregado"},B=new Set(["header","section_title","divider","section_separator","cover_header","page_header","page_footer","back_cover","table_of_contents","page_break","content_placeholder","intervention_data","client_data","component_section"]),A=new Set(["header","section_title","divider","section_separator","tristate","checklist","table","equipment_exchange","cover_header","page_header","page_footer","back_cover","table_of_contents","page_break","intervention_data","client_data"]);function O(){const{id:s}=g(),a=Number(s),t=u(),{data:r,isLoading:i,error:n}=j(a||void 0),l=h.useCallback(x=>e.jsx(F,{block:x}),[]);if(i)return e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(p,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(n||!r)return e.jsxs("div",{className:"flex h-screen flex-col items-center justify-center gap-4",children:[e.jsx(y,{className:"h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:(n==null?void 0:n.message)||"No se pudo cargar el informe ensamblado"}),e.jsx(c,{variant:"outline",onClick:()=>t(-1),children:"Volver"})]});const{informe:o,assembled:d,documentTemplate:f}=r;return e.jsxs("div",{className:"flex h-screen flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex h-14 items-center justify-between border-b bg-background px-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>t(`/informes/${a}`),title:"Volver al formulario",children:e.jsx(v,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-semibold",children:o.sistema.nombre}),e.jsx(m,{className:"bg-blue-100 text-blue-800",children:f.nombre}),e.jsx(m,{className:L[o.estado]??"bg-gray-100 text-gray-700",children:S[o.estado]??o.estado})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>t(`/informes/${a}`),children:[e.jsx(_,{className:"h-4 w-4 mr-1"}),"Formulario"]})})]}),e.jsx("div",{className:"flex-1 overflow-auto bg-gray-100",children:e.jsx("div",{className:"py-8 px-4",children:e.jsx(C,{blocks:d.blocks,pageConfig:d.pageConfig,renderBlock:l})})})]})}function F({block:s}){const a=b(s.type);if(!a)return null;const t=P(s),r=N[s.config.align||"left"];if(B.has(s.type)){const l=a.EditorPreview;return e.jsx("div",{className:`${t} ${r} pointer-events-none`,children:e.jsx(l,{block:s,isSelected:!1})})}const i=a.FormField;if(i&&s._dataKey)return e.jsx("div",{className:`${t} ${r}`,children:e.jsx(i,{block:s,value:s._dataValue??null,onChange:()=>{},readOnly:!0})});const n=a.EditorPreview;return e.jsx("div",{className:`${t} ${r} pointer-events-none`,children:e.jsx(n,{block:s,isSelected:!1})})}function P(s){if(A.has(s.type))return"w-full";const a=s.config.width||"full";return w[a]||"w-full"}export{O as default};
