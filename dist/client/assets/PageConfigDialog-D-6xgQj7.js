import{f as X,j as h,ab as Hn,U as Wn,ac as Xn,ad as Yn,ae as Un,af as Vn,F as qn,ag as be,r as c,ah as L,ai as Le,$ as rn,B as xt,X as Kn,y as Gn,z as Jn,E as Zn,G as Qn,H as Je,W as Ht}from"./index-C75WWkRm.js";import{u as P,b as er,L as tr,S as nr,a as rr,P as or,A as sr,c as on,d as ir,D as sn,g as ut,B as ar,e as Wt,F as cr,f as lr}from"./index-ByKcjuSJ.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],dr=X("ArrowDown",ur);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],hr=X("ArrowUp",fr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],pr=X("BookOpen",gr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],an=X("Copy",vr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],br=X("GripVertical",mr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],yr=X("Hash",xr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=[["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M6 20V4",key:"1w1bmo"}],["path",{d:"M18 20V4",key:"o2hl4u"}]],Cr=X("Heading",wr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],Dr=X("ListChecks",Sr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=[["path",{d:"M5 12h14",key:"1ays0h"}]],Rr=X("Minus",kr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 15h18",key:"5xshup"}]],Nr=X("PanelBottom",Er);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}]],Ir=X("PanelTop",Mr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=[["line",{x1:"3",x2:"21",y1:"12",y2:"12",key:"10d38w"}],["polyline",{points:"8 8 12 4 16 8",key:"zo8t4w"}],["polyline",{points:"16 16 12 20 8 16",key:"1oyrid"}]],Ar=X("SeparatorHorizontal",jr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Or=X("Table",Tr);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],Lr=X("Type",Br),Pr={FileText:qn,Heading:Cr,Minus:Rr,Type:Lr,Hash:yr,Calendar:Vn,AlignLeft:sr,ChevronDown:Un,CheckCircle:Yn,ListChecks:Dr,Table:Or,Image:Xn,Pen:or,List:rr,BookOpen:pr,PanelTop:Ir,PanelBottom:Nr,Square:nr,SeparatorHorizontal:Ar,LayoutTemplate:tr,ClipboardList:Wn,Building2:Hn};function Hs(){const e=P(n=>n.addBlock),t=P(n=>n.isDocumentTemplate);return h.jsxs("div",{className:"flex w-56 flex-col border-r bg-background overflow-y-auto",children:[h.jsx("div",{className:"px-4 py-3 border-b",children:h.jsx("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Bloques"})}),h.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-4",children:er.map(n=>{if(n.id==="document"&&!t)return null;const r=n.types.filter(o=>o!=="section_separator");return r.length===0?null:h.jsxs("div",{children:[h.jsx("p",{className:"px-2 pb-1 text-xs font-medium text-muted-foreground uppercase tracking-wide",children:n.label}),h.jsx("div",{className:"space-y-0.5",children:r.map(o=>{const s=on[o],i=Pr[s.icon];return h.jsxs("button",{onClick:()=>e(o),className:be("flex w-full items-center gap-2 rounded-md px-2 py-2 text-sm","hover:bg-accent hover:text-accent-foreground transition-colors","cursor-pointer select-none"),title:`Anadir ${s.label}`,children:[i&&h.jsx(i,{className:"h-4 w-4 shrink-0 text-muted-foreground"}),h.jsx("span",{className:"truncate",children:s.label})]},o)})})]},n.id)})})]})}function _r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const dt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Re(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Et(e){return"nodeType"in e}function H(e){var t,n;return e?Re(e)?e:Et(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Nt(e){const{Document:t}=H(e);return e instanceof t}function He(e){return Re(e)?!1:e instanceof H(e).HTMLElement}function cn(e){return e instanceof H(e).SVGElement}function Ee(e){return e?Re(e)?e.document:Et(e)?Nt(e)?e:He(e)||cn(e)?e.ownerDocument:document:document:document}const Z=dt?c.useLayoutEffect:c.useEffect;function ft(e){const t=c.useRef(e);return Z(()=>{t.current=e}),c.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function zr(){const e=c.useRef(null),t=c.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=c.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function $e(e,t){t===void 0&&(t=[e]);const n=c.useRef(e);return Z(()=>{n.current!==e&&(n.current=e)},t),n}function We(e,t){const n=c.useRef();return c.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function nt(e){const t=ft(e),n=c.useRef(null),r=c.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,r]}function rt(e){const t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}let yt={};function Xe(e,t){return c.useMemo(()=>{if(t)return t;const n=yt[e]==null?0:yt[e]+1;return yt[e]=n,e+"-"+n},[e,t])}function ln(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,i)=>{const a=Object.entries(i);for(const[l,u]of a){const d=s[l];d!=null&&(s[l]=d+e*u)}return s},{...t})}}const ke=ln(1),ot=ln(-1);function $r(e){return"clientX"in e&&"clientY"in e}function ht(e){if(!e)return!1;const{KeyboardEvent:t}=H(e.target);return t&&e instanceof t}function Fr(e){if(!e)return!1;const{TouchEvent:t}=H(e.target);return t&&e instanceof t}function st(e){if(Fr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return $r(e)?{x:e.clientX,y:e.clientY}:null}const ve=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[ve.Translate.toString(e),ve.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Xt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Hr(e){return e.matches(Xt)?e:e.querySelector(Xt)}const Wr={display:"none"};function Xr(e){let{id:t,value:n}=e;return L.createElement("div",{id:t,style:Wr},n)}function Yr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return L.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function Ur(){const[e,t]=c.useState("");return{announce:c.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const un=c.createContext(null);function Vr(e){const t=c.useContext(un);c.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function qr(){const[e]=c.useState(()=>new Set),t=c.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[c.useCallback(r=>{let{type:o,event:s}=r;e.forEach(i=>{var a;return(a=i[o])==null?void 0:a.call(i,s)})},[e]),t]}const Kr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Gr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Jr(e){let{announcements:t=Gr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=Kr}=e;const{announce:s,announcement:i}=Ur(),a=Xe("DndLiveRegion"),[l,u]=c.useState(!1);if(c.useEffect(()=>{u(!0)},[]),Vr(c.useMemo(()=>({onDragStart(f){let{active:m}=f;s(t.onDragStart({active:m}))},onDragMove(f){let{active:m,over:p}=f;t.onDragMove&&s(t.onDragMove({active:m,over:p}))},onDragOver(f){let{active:m,over:p}=f;s(t.onDragOver({active:m,over:p}))},onDragEnd(f){let{active:m,over:p}=f;s(t.onDragEnd({active:m,over:p}))},onDragCancel(f){let{active:m,over:p}=f;s(t.onDragCancel({active:m,over:p}))}}),[s,t])),!l)return null;const d=L.createElement(L.Fragment,null,L.createElement(Xr,{id:r,value:o.draggable}),L.createElement(Yr,{id:a,announcement:i}));return n?Le.createPortal(d,n):d}var _;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(_||(_={}));function it(){}function Zr(e,t){return c.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Qr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Q=Object.freeze({x:0,y:0});function eo(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function to(e,t){const n=st(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function no(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function ro(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function oo(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Yt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const so=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Yt(t,t.left,t.top),s=[];for(const i of r){const{id:a}=i,l=n.get(a);if(l){const u=eo(Yt(l),o);s.push({id:a,data:{droppableContainer:i,value:u}})}}return s.sort(no)};function io(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),i=o-r,a=s-n;if(r<o&&n<s){const l=t.width*t.height,u=e.width*e.height,d=i*a,f=d/(l+u-d);return Number(f.toFixed(4))}return 0}const ao=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:i}=s,a=n.get(i);if(a){const l=io(a,t);l>0&&o.push({id:i,data:{droppableContainer:s,value:l}})}}return o.sort(ro)};function co(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function dn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Q}function lo(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((i,a)=>({...i,top:i.top+e*a.y,bottom:i.bottom+e*a.y,left:i.left+e*a.x,right:i.right+e*a.x}),{...n})}}const uo=lo(1);function fn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function fo(e,t,n){const r=fn(t);if(!r)return e;const{scaleX:o,scaleY:s,x:i,y:a}=r,l=e.left-i-(1-o)*parseFloat(n),u=e.top-a-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),d=o?e.width/o:e.width,f=s?e.height/s:e.height;return{width:d,height:f,top:u,right:l+d,bottom:u+f,left:l}}const ho={ignoreTransform:!1};function Ne(e,t){t===void 0&&(t=ho);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=H(e).getComputedStyle(e);u&&(n=fo(n,u,d))}const{top:r,left:o,width:s,height:i,bottom:a,right:l}=n;return{top:r,left:o,width:s,height:i,bottom:a,right:l}}function Ut(e){return Ne(e,{ignoreTransform:!0})}function go(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function po(e,t){return t===void 0&&(t=H(e).getComputedStyle(e)),t.position==="fixed"}function vo(e,t){t===void 0&&(t=H(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function Mt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(Nt(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!He(o)||cn(o)||n.includes(o))return n;const s=H(e).getComputedStyle(o);return o!==e&&vo(o,s)&&n.push(o),po(o,s)?n:r(o.parentNode)}return e?r(e):n}function hn(e){const[t]=Mt(e,1);return t??null}function wt(e){return!dt||!e?null:Re(e)?e:Et(e)?Nt(e)||e===Ee(e).scrollingElement?window:He(e)?e:null:null}function gn(e){return Re(e)?e.scrollX:e.scrollLeft}function pn(e){return Re(e)?e.scrollY:e.scrollTop}function Dt(e){return{x:gn(e),y:pn(e)}}var z;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(z||(z={}));function vn(e){return!dt||!e?!1:e===document.scrollingElement}function mn(e){const t={x:0,y:0},n=vn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,i=e.scrollTop>=r.y,a=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:i,isRight:a,maxScroll:r,minScroll:t}}const mo={x:.2,y:.2};function bo(e,t,n,r,o){let{top:s,left:i,right:a,bottom:l}=n;r===void 0&&(r=10),o===void 0&&(o=mo);const{isTop:u,isBottom:d,isLeft:f,isRight:m}=mn(e),p={x:0,y:0},E={x:0,y:0},b={height:t.height*o.y,width:t.width*o.x};return!u&&s<=t.top+b.height?(p.y=z.Backward,E.y=r*Math.abs((t.top+b.height-s)/b.height)):!d&&l>=t.bottom-b.height&&(p.y=z.Forward,E.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!m&&a>=t.right-b.width?(p.x=z.Forward,E.x=r*Math.abs((t.right-b.width-a)/b.width)):!f&&i<=t.left+b.width&&(p.x=z.Backward,E.x=r*Math.abs((t.left+b.width-i)/b.width)),{direction:p,speed:E}}function xo(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:i}=window;return{top:0,left:0,right:s,bottom:i,width:s,height:i}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function bn(e){return e.reduce((t,n)=>ke(t,Dt(n)),Q)}function yo(e){return e.reduce((t,n)=>t+gn(n),0)}function wo(e){return e.reduce((t,n)=>t+pn(n),0)}function xn(e,t){if(t===void 0&&(t=Ne),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);hn(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Co=[["x",["left","right"],yo],["y",["top","bottom"],wo]];class It{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Mt(n),o=bn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,i,a]of Co)for(const l of i)Object.defineProperty(this,l,{get:()=>{const u=a(r),d=o[s]-u;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Pe{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function So(e){const{EventTarget:t}=H(e);return e instanceof t?e:Ee(e)}function Ct(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var J;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(J||(J={}));function Vt(e){e.preventDefault()}function Do(e){e.stopPropagation()}var A;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(A||(A={}));const yn={start:[A.Space,A.Enter],cancel:[A.Esc],end:[A.Space,A.Enter,A.Tab]},ko=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case A.Right:return{...n,x:n.x+25};case A.Left:return{...n,x:n.x-25};case A.Down:return{...n,y:n.y+25};case A.Up:return{...n,y:n.y-25}}};class wn{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Pe(Ee(n)),this.windowListeners=new Pe(H(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(J.Resize,this.handleCancel),this.windowListeners.add(J.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(J.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&xn(r),n(Q)}handleKeyDown(t){if(ht(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=yn,coordinateGetter:i=ko,scrollBehavior:a="smooth"}=o,{code:l}=t;if(s.end.includes(l)){this.handleEnd(t);return}if(s.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:u}=r.current,d=u?{x:u.left,y:u.top}:Q;this.referenceCoordinates||(this.referenceCoordinates=d);const f=i(t,{active:n,context:r.current,currentCoordinates:d});if(f){const m=ot(f,d),p={x:0,y:0},{scrollableAncestors:E}=r.current;for(const b of E){const x=t.code,{isTop:D,isRight:R,isLeft:k,isBottom:N,maxScroll:M,minScroll:I}=mn(b),g=xo(b),y={x:Math.min(x===A.Right?g.right-g.width/2:g.right,Math.max(x===A.Right?g.left:g.left+g.width/2,f.x)),y:Math.min(x===A.Down?g.bottom-g.height/2:g.bottom,Math.max(x===A.Down?g.top:g.top+g.height/2,f.y))},S=x===A.Right&&!R||x===A.Left&&!k,v=x===A.Down&&!N||x===A.Up&&!D;if(S&&y.x!==f.x){const w=b.scrollLeft+m.x,j=x===A.Right&&w<=M.x||x===A.Left&&w>=I.x;if(j&&!m.y){b.scrollTo({left:w,behavior:a});return}j?p.x=b.scrollLeft-w:p.x=x===A.Right?b.scrollLeft-M.x:b.scrollLeft-I.x,p.x&&b.scrollBy({left:-p.x,behavior:a});break}else if(v&&y.y!==f.y){const w=b.scrollTop+m.y,j=x===A.Down&&w<=M.y||x===A.Up&&w>=I.y;if(j&&!m.x){b.scrollTo({top:w,behavior:a});return}j?p.y=b.scrollTop-w:p.y=x===A.Down?b.scrollTop-M.y:b.scrollTop-I.y,p.y&&b.scrollBy({top:-p.y,behavior:a});break}}this.handleMove(t,ke(ot(f,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}wn.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=yn,onActivation:o}=t,{active:s}=n;const{code:i}=e.nativeEvent;if(r.start.includes(i)){const a=s.activatorNode.current;return a&&e.target!==a?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function qt(e){return!!(e&&"distance"in e)}function Kt(e){return!!(e&&"delay"in e)}class jt{constructor(t,n,r){var o;r===void 0&&(r=So(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:i}=s;this.props=t,this.events=n,this.document=Ee(i),this.documentListeners=new Pe(this.document),this.listeners=new Pe(r),this.windowListeners=new Pe(H(i)),this.initialCoordinates=(o=st(s))!=null?o:Q,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(J.Resize,this.handleCancel),this.windowListeners.add(J.DragStart,Vt),this.windowListeners.add(J.VisibilityChange,this.handleCancel),this.windowListeners.add(J.ContextMenu,Vt),this.documentListeners.add(J.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Kt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(qt(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(J.Click,Do,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(J.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:i,options:{activationConstraint:a}}=s;if(!o)return;const l=(n=st(t))!=null?n:Q,u=ot(o,l);if(!r&&a){if(qt(a)){if(a.tolerance!=null&&Ct(u,a.tolerance))return this.handleCancel();if(Ct(u,a.distance))return this.handleStart()}if(Kt(a)&&Ct(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}t.cancelable&&t.preventDefault(),i(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===A.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Ro={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class At extends jt{constructor(t){const{event:n}=t,r=Ee(n.target);super(t,Ro,r)}}At.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Eo={move:{name:"mousemove"},end:{name:"mouseup"}};var kt;(function(e){e[e.RightClick=2]="RightClick"})(kt||(kt={}));class No extends jt{constructor(t){super(t,Eo,Ee(t.event.target))}}No.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===kt.RightClick?!1:(r==null||r({event:n}),!0)}}];const St={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Mo extends jt{constructor(t){super(t,St)}static setup(){return window.addEventListener(St.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(St.move.name,t)};function t(){}}}Mo.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var _e;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(_e||(_e={}));var at;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(at||(at={}));function Io(e){let{acceleration:t,activator:n=_e.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:i=5,order:a=at.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:m}=e;const p=Ao({delta:f,disabled:!s}),[E,b]=zr(),x=c.useRef({x:0,y:0}),D=c.useRef({x:0,y:0}),R=c.useMemo(()=>{switch(n){case _e.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case _e.DraggableRect:return o}},[n,o,l]),k=c.useRef(null),N=c.useCallback(()=>{const I=k.current;if(!I)return;const g=x.current.x*D.current.x,y=x.current.y*D.current.y;I.scrollBy(g,y)},[]),M=c.useMemo(()=>a===at.TreeOrder?[...u].reverse():u,[a,u]);c.useEffect(()=>{if(!s||!u.length||!R){b();return}for(const I of M){if((r==null?void 0:r(I))===!1)continue;const g=u.indexOf(I),y=d[g];if(!y)continue;const{direction:S,speed:v}=bo(I,y,R,t,m);for(const w of["x","y"])p[w][S[w]]||(v[w]=0,S[w]=0);if(v.x>0||v.y>0){b(),k.current=I,E(N,i),x.current=v,D.current=S;return}}x.current={x:0,y:0},D.current={x:0,y:0},b()},[t,N,r,b,s,i,JSON.stringify(R),JSON.stringify(p),E,u,M,d,JSON.stringify(m)])}const jo={x:{[z.Backward]:!1,[z.Forward]:!1},y:{[z.Backward]:!1,[z.Forward]:!1}};function Ao(e){let{delta:t,disabled:n}=e;const r=rt(t);return We(o=>{if(n||!r||!o)return jo;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[z.Backward]:o.x[z.Backward]||s.x===-1,[z.Forward]:o.x[z.Forward]||s.x===1},y:{[z.Backward]:o.y[z.Backward]||s.y===-1,[z.Forward]:o.y[z.Forward]||s.y===1}}},[n,t,r])}function To(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return We(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function Oo(e,t){return c.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,r)}));return[...n,...s]},[]),[e,t])}var Fe;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Fe||(Fe={}));var Rt;(function(e){e.Optimized="optimized"})(Rt||(Rt={}));const Gt=new Map;function Bo(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,i]=c.useState(null),{frequency:a,measure:l,strategy:u}=o,d=c.useRef(e),f=x(),m=$e(f),p=c.useCallback(function(D){D===void 0&&(D=[]),!m.current&&i(R=>R===null?D:R.concat(D.filter(k=>!R.includes(k))))},[m]),E=c.useRef(null),b=We(D=>{if(f&&!n)return Gt;if(!D||D===Gt||d.current!==e||s!=null){const R=new Map;for(let k of e){if(!k)continue;if(s&&s.length>0&&!s.includes(k.id)&&k.rect.current){R.set(k.id,k.rect.current);continue}const N=k.node.current,M=N?new It(l(N),N):null;k.rect.current=M,M&&R.set(k.id,M)}return R}return D},[e,s,n,f,l]);return c.useEffect(()=>{d.current=e},[e]),c.useEffect(()=>{f||p()},[n,f]),c.useEffect(()=>{s&&s.length>0&&i(null)},[JSON.stringify(s)]),c.useEffect(()=>{f||typeof a!="number"||E.current!==null||(E.current=setTimeout(()=>{p(),E.current=null},a))},[a,f,p,...r]),{droppableRects:b,measureDroppableContainers:p,measuringScheduled:s!=null};function x(){switch(u){case Fe.Always:return!1;case Fe.BeforeDragging:return n;default:return!n}}}function Tt(e,t){return We(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Lo(e,t){return Tt(e,t)}function Po(e){let{callback:t,disabled:n}=e;const r=ft(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return c.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function gt(e){let{callback:t,disabled:n}=e;const r=ft(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return c.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function _o(e){return new It(Ne(e),e)}function Jt(e,t,n){t===void 0&&(t=_o);const[r,o]=c.useState(null);function s(){o(l=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=l??n)!=null?u:null}const d=t(e);return JSON.stringify(l)===JSON.stringify(d)?l:d})}const i=Po({callback(l){if(e)for(const u of l){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),a=gt({callback:s});return Z(()=>{s(),e?(a==null||a.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),i==null||i.disconnect())},[e]),r}function zo(e){const t=Tt(e);return dn(e,t)}const Zt=[];function $o(e){const t=c.useRef(e),n=We(r=>e?r&&r!==Zt&&e&&t.current&&e.parentNode===t.current.parentNode?r:Mt(e):Zt,[e]);return c.useEffect(()=>{t.current=e},[e]),n}function Fo(e){const[t,n]=c.useState(null),r=c.useRef(e),o=c.useCallback(s=>{const i=wt(s.target);i&&n(a=>a?(a.set(i,Dt(i)),new Map(a)):null)},[]);return c.useEffect(()=>{const s=r.current;if(e!==s){i(s);const a=e.map(l=>{const u=wt(l);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,Dt(u)]):null}).filter(l=>l!=null);n(a.length?new Map(a):null),r.current=e}return()=>{i(e),i(s)};function i(a){a.forEach(l=>{const u=wt(l);u==null||u.removeEventListener("scroll",o)})}},[o,e]),c.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,i)=>ke(s,i),Q):bn(e):Q,[e,t])}function Qt(e,t){t===void 0&&(t=[]);const n=c.useRef(null);return c.useEffect(()=>{n.current=null},t),c.useEffect(()=>{const r=e!==Q;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?ot(e,n.current):Q}function Ho(e){c.useEffect(()=>{if(!dt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Wo(e,t){return c.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=i=>{s(i,t)},n},{}),[e,t])}function Cn(e){return c.useMemo(()=>e?go(e):null,[e])}const en=[];function Xo(e,t){t===void 0&&(t=Ne);const[n]=e,r=Cn(n?H(n):null),[o,s]=c.useState(en);function i(){s(()=>e.length?e.map(l=>vn(l)?r:new It(t(l),l)):en)}const a=gt({callback:i});return Z(()=>{a==null||a.disconnect(),i(),e.forEach(l=>a==null?void 0:a.observe(l))},[e]),o}function Sn(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return He(t)?t:e}function Yo(e){let{measure:t}=e;const[n,r]=c.useState(null),o=c.useCallback(u=>{for(const{target:d}of u)if(He(d)){r(f=>{const m=t(d);return f?{...f,width:m.width,height:m.height}:m});break}},[t]),s=gt({callback:o}),i=c.useCallback(u=>{const d=Sn(u);s==null||s.disconnect(),d&&(s==null||s.observe(d)),r(d?t(d):null)},[t,s]),[a,l]=nt(i);return c.useMemo(()=>({nodeRef:a,rect:n,setRef:l}),[n,a,l])}const Uo=[{sensor:At,options:{}},{sensor:wn,options:{}}],Vo={current:{}},tt={draggable:{measure:Ut},droppable:{measure:Ut,strategy:Fe.WhileDragging,frequency:Rt.Optimized},dragOverlay:{measure:Ne}};class ze extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const qo={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ze,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:it},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:tt,measureDroppableContainers:it,windowRect:null,measuringScheduled:!1},Dn={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:it,draggableNodes:new Map,over:null,measureDroppableContainers:it},Ye=c.createContext(Dn),kn=c.createContext(qo);function Ko(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ze}}}function Go(e,t){switch(t.type){case _.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case _.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case _.DragEnd:case _.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case _.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new ze(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case _.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new ze(e.droppable.containers);return i.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:i}}}case _.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new ze(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function Jo(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=c.useContext(Ye),s=rt(r),i=rt(n==null?void 0:n.id);return c.useEffect(()=>{if(!t&&!r&&s&&i!=null){if(!ht(s)||document.activeElement===s.target)return;const a=o.get(i);if(!a)return;const{activatorNode:l,node:u}=a;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[l.current,u.current]){if(!d)continue;const f=Hr(d);if(f){f.focus();break}}})}},[r,t,o,i,s]),null}function Rn(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function Zo(e){return c.useMemo(()=>({draggable:{...tt.draggable,...e==null?void 0:e.draggable},droppable:{...tt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...tt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Qo(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=c.useRef(!1),{x:i,y:a}=typeof o=="boolean"?{x:o,y:o}:o;Z(()=>{if(!i&&!a||!t){s.current=!1;return}if(s.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=n(u),f=dn(d,r);if(i||(f.x=0),a||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const m=hn(u);m&&m.scrollBy({top:f.y,left:f.x})}},[t,i,a,r,n])}const pt=c.createContext({...Q,scaleX:1,scaleY:1});var pe;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(pe||(pe={}));const es=c.memo(function(t){var n,r,o,s;let{id:i,accessibility:a,autoScroll:l=!0,children:u,sensors:d=Uo,collisionDetection:f=ao,measuring:m,modifiers:p,...E}=t;const b=c.useReducer(Go,void 0,Ko),[x,D]=b,[R,k]=qr(),[N,M]=c.useState(pe.Uninitialized),I=N===pe.Initialized,{draggable:{active:g,nodes:y,translate:S},droppable:{containers:v}}=x,w=g!=null?y.get(g):null,j=c.useRef({initial:null,translated:null}),O=c.useMemo(()=>{var F;return g!=null?{id:g,data:(F=w==null?void 0:w.data)!=null?F:Vo,rect:j}:null},[g,w]),C=c.useRef(null),[q,ce]=c.useState(null),[B,Ue]=c.useState(null),re=$e(E,Object.values(E)),Me=Xe("DndDescribedBy",i),Ve=c.useMemo(()=>v.getEnabled(),[v]),W=Zo(m),{droppableRects:oe,measureDroppableContainers:me,measuringScheduled:Ie}=Bo(Ve,{dragging:I,dependencies:[S.x,S.y],config:W.droppable}),K=To(y,g),qe=c.useMemo(()=>B?st(B):null,[B]),le=Fn(),se=Lo(K,W.draggable.measure);Qo({activeNode:g!=null?y.get(g):null,config:le.layoutShiftCompensation,initialRect:se,measure:W.draggable.measure});const T=Jt(K,W.draggable.measure,se),je=Jt(K?K.parentElement:null),ee=c.useRef({activatorEvent:null,active:null,activeNode:K,collisionRect:null,collisions:null,droppableRects:oe,draggableNodes:y,draggingNode:null,draggingNodeRect:null,droppableContainers:v,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),xe=v.getNodeFor((n=ee.current.over)==null?void 0:n.id),ie=Yo({measure:W.dragOverlay.measure}),ye=(r=ie.nodeRef.current)!=null?r:K,we=I?(o=ie.rect)!=null?o:T:null,Ot=!!(ie.nodeRef.current&&ie.rect),Bt=zo(Ot?null:T),vt=Cn(ye?H(ye):null),ue=$o(I?xe??K:null),Ke=Xo(ue),Ge=Rn(p,{transform:{x:S.x-Bt.x,y:S.y-Bt.y,scaleX:1,scaleY:1},activatorEvent:B,active:O,activeNodeRect:T,containerNodeRect:je,draggingNodeRect:we,over:ee.current.over,overlayNodeRect:ie.rect,scrollableAncestors:ue,scrollableAncestorRects:Ke,windowRect:vt}),Lt=qe?ke(qe,S):null,Pt=Fo(ue),On=Qt(Pt),Bn=Qt(Pt,[T]),Ce=ke(Ge,On),Se=we?uo(we,Ge):null,Ae=O&&Se?f({active:O,collisionRect:Se,droppableRects:oe,droppableContainers:Ve,pointerCoordinates:Lt}):null,_t=oo(Ae,"id"),[de,zt]=c.useState(null),Ln=Ot?Ge:ke(Ge,Bn),Pn=co(Ln,(s=de==null?void 0:de.rect)!=null?s:null,T),mt=c.useRef(null),$t=c.useCallback((F,Y)=>{let{sensor:U,options:fe}=Y;if(C.current==null)return;const G=y.get(C.current);if(!G)return;const V=F.nativeEvent,te=new U({active:C.current,activeNode:G,event:V,options:fe,context:ee,onAbort($){if(!y.get($))return;const{onDragAbort:ne}=re.current,ae={id:$};ne==null||ne(ae),R({type:"onDragAbort",event:ae})},onPending($,he,ne,ae){if(!y.get($))return;const{onDragPending:Oe}=re.current,ge={id:$,constraint:he,initialCoordinates:ne,offset:ae};Oe==null||Oe(ge),R({type:"onDragPending",event:ge})},onStart($){const he=C.current;if(he==null)return;const ne=y.get(he);if(!ne)return;const{onDragStart:ae}=re.current,Te={activatorEvent:V,active:{id:he,data:ne.data,rect:j}};Le.unstable_batchedUpdates(()=>{ae==null||ae(Te),M(pe.Initializing),D({type:_.DragStart,initialCoordinates:$,active:he}),R({type:"onDragStart",event:Te}),ce(mt.current),Ue(V)})},onMove($){D({type:_.DragMove,coordinates:$})},onEnd:De(_.DragEnd),onCancel:De(_.DragCancel)});mt.current=te;function De($){return async function(){const{active:ne,collisions:ae,over:Te,scrollAdjustedTranslate:Oe}=ee.current;let ge=null;if(ne&&Oe){const{cancelDrop:Be}=re.current;ge={activatorEvent:V,active:ne,collisions:ae,delta:Oe,over:Te},$===_.DragEnd&&typeof Be=="function"&&await Promise.resolve(Be(ge))&&($=_.DragCancel)}C.current=null,Le.unstable_batchedUpdates(()=>{D({type:$}),M(pe.Uninitialized),zt(null),ce(null),Ue(null),mt.current=null;const Be=$===_.DragEnd?"onDragEnd":"onDragCancel";if(ge){const bt=re.current[Be];bt==null||bt(ge),R({type:Be,event:ge})}})}}},[y]),_n=c.useCallback((F,Y)=>(U,fe)=>{const G=U.nativeEvent,V=y.get(fe);if(C.current!==null||!V||G.dndKit||G.defaultPrevented)return;const te={active:V};F(U,Y.options,te)===!0&&(G.dndKit={capturedBy:Y.sensor},C.current=fe,$t(U,Y))},[y,$t]),Ft=Oo(d,_n);Ho(d),Z(()=>{T&&N===pe.Initializing&&M(pe.Initialized)},[T,N]),c.useEffect(()=>{const{onDragMove:F}=re.current,{active:Y,activatorEvent:U,collisions:fe,over:G}=ee.current;if(!Y||!U)return;const V={active:Y,activatorEvent:U,collisions:fe,delta:{x:Ce.x,y:Ce.y},over:G};Le.unstable_batchedUpdates(()=>{F==null||F(V),R({type:"onDragMove",event:V})})},[Ce.x,Ce.y]),c.useEffect(()=>{const{active:F,activatorEvent:Y,collisions:U,droppableContainers:fe,scrollAdjustedTranslate:G}=ee.current;if(!F||C.current==null||!Y||!G)return;const{onDragOver:V}=re.current,te=fe.get(_t),De=te&&te.rect.current?{id:te.id,rect:te.rect.current,data:te.data,disabled:te.disabled}:null,$={active:F,activatorEvent:Y,collisions:U,delta:{x:G.x,y:G.y},over:De};Le.unstable_batchedUpdates(()=>{zt(De),V==null||V($),R({type:"onDragOver",event:$})})},[_t]),Z(()=>{ee.current={activatorEvent:B,active:O,activeNode:K,collisionRect:Se,collisions:Ae,droppableRects:oe,draggableNodes:y,draggingNode:ye,draggingNodeRect:we,droppableContainers:v,over:de,scrollableAncestors:ue,scrollAdjustedTranslate:Ce},j.current={initial:we,translated:Se}},[O,K,Ae,Se,y,ye,we,oe,v,de,ue,Ce]),Io({...le,delta:S,draggingRect:Se,pointerCoordinates:Lt,scrollableAncestors:ue,scrollableAncestorRects:Ke});const zn=c.useMemo(()=>({active:O,activeNode:K,activeNodeRect:T,activatorEvent:B,collisions:Ae,containerNodeRect:je,dragOverlay:ie,draggableNodes:y,droppableContainers:v,droppableRects:oe,over:de,measureDroppableContainers:me,scrollableAncestors:ue,scrollableAncestorRects:Ke,measuringConfiguration:W,measuringScheduled:Ie,windowRect:vt}),[O,K,T,B,Ae,je,ie,y,v,oe,de,me,ue,Ke,W,Ie,vt]),$n=c.useMemo(()=>({activatorEvent:B,activators:Ft,active:O,activeNodeRect:T,ariaDescribedById:{draggable:Me},dispatch:D,draggableNodes:y,over:de,measureDroppableContainers:me}),[B,Ft,O,T,D,Me,y,de,me]);return L.createElement(un.Provider,{value:k},L.createElement(Ye.Provider,{value:$n},L.createElement(kn.Provider,{value:zn},L.createElement(pt.Provider,{value:Pn},u)),L.createElement(Jo,{disabled:(a==null?void 0:a.restoreFocus)===!1})),L.createElement(Jr,{...a,hiddenTextDescribedById:Me}));function Fn(){const F=(q==null?void 0:q.autoScrollEnabled)===!1,Y=typeof l=="object"?l.enabled===!1:l===!1,U=I&&!F&&!Y;return typeof l=="object"?{...l,enabled:U}:{enabled:U}}}),ts=c.createContext(null),tn="button",ns="Draggable";function rs(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=Xe(ns),{activators:i,activatorEvent:a,active:l,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:m}=c.useContext(Ye),{role:p=tn,roleDescription:E="draggable",tabIndex:b=0}=o??{},x=(l==null?void 0:l.id)===t,D=c.useContext(x?pt:ts),[R,k]=nt(),[N,M]=nt(),I=Wo(i,t),g=$e(n);Z(()=>(f.set(t,{id:t,key:s,node:R,activatorNode:N,data:g}),()=>{const S=f.get(t);S&&S.key===s&&f.delete(t)}),[f,t]);const y=c.useMemo(()=>({role:p,tabIndex:b,"aria-disabled":r,"aria-pressed":x&&p===tn?!0:void 0,"aria-roledescription":E,"aria-describedby":d.draggable}),[r,p,b,x,E,d.draggable]);return{active:l,activatorEvent:a,activeNodeRect:u,attributes:y,isDragging:x,listeners:r?void 0:I,node:R,over:m,setNodeRef:k,setActivatorNodeRef:M,transform:D}}function En(){return c.useContext(kn)}const os="Droppable",ss={timeout:25};function is(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=Xe(os),{active:i,dispatch:a,over:l,measureDroppableContainers:u}=c.useContext(Ye),d=c.useRef({disabled:n}),f=c.useRef(!1),m=c.useRef(null),p=c.useRef(null),{disabled:E,updateMeasurementsFor:b,timeout:x}={...ss,...o},D=$e(b??r),R=c.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(D.current)?D.current:[D.current]),p.current=null},x)},[x]),k=gt({callback:R,disabled:E||!i}),N=c.useCallback((y,S)=>{k&&(S&&(k.unobserve(S),f.current=!1),y&&k.observe(y))},[k]),[M,I]=nt(N),g=$e(t);return c.useEffect(()=>{!k||!M.current||(k.disconnect(),f.current=!1,k.observe(M.current))},[M,k]),c.useEffect(()=>(a({type:_.RegisterDroppable,element:{id:r,key:s,disabled:n,node:M,rect:m,data:g}}),()=>a({type:_.UnregisterDroppable,key:s,id:r})),[r]),c.useEffect(()=>{n!==d.current.disabled&&(a({type:_.SetDroppableDisabled,id:r,key:s,disabled:n}),d.current.disabled=n)},[r,s,n,a]),{active:i,rect:m,isOver:(l==null?void 0:l.id)===r,node:M,over:l,setNodeRef:I}}function as(e){let{animation:t,children:n}=e;const[r,o]=c.useState(null),[s,i]=c.useState(null),a=rt(n);return!n&&!r&&a&&o(a),Z(()=>{if(!s)return;const l=r==null?void 0:r.key,u=r==null?void 0:r.props.id;if(l==null||u==null){o(null);return}Promise.resolve(t(u,s)).then(()=>{o(null)})},[t,r,s]),L.createElement(L.Fragment,null,n,r?c.cloneElement(r,{ref:i}):null)}const cs={x:0,y:0,scaleX:1,scaleY:1};function ls(e){let{children:t}=e;return L.createElement(Ye.Provider,{value:Dn},L.createElement(pt.Provider,{value:cs},t))}const us={position:"fixed",touchAction:"none"},ds=e=>ht(e)?"transform 250ms ease":void 0,fs=c.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:o,children:s,className:i,rect:a,style:l,transform:u,transition:d=ds}=e;if(!a)return null;const f=o?u:{...u,scaleX:1,scaleY:1},m={...us,width:a.width,height:a.height,top:a.top,left:a.left,transform:ve.Transform.toString(f),transformOrigin:o&&r?to(r,a):void 0,transition:typeof d=="function"?d(r):d,...l};return L.createElement(n,{className:i,style:m,ref:t},s)}),hs=e=>t=>{let{active:n,dragOverlay:r}=t;const o={},{styles:s,className:i}=e;if(s!=null&&s.active)for(const[a,l]of Object.entries(s.active))l!==void 0&&(o[a]=n.node.style.getPropertyValue(a),n.node.style.setProperty(a,l));if(s!=null&&s.dragOverlay)for(const[a,l]of Object.entries(s.dragOverlay))l!==void 0&&r.node.style.setProperty(a,l);return i!=null&&i.active&&n.node.classList.add(i.active),i!=null&&i.dragOverlay&&r.node.classList.add(i.dragOverlay),function(){for(const[l,u]of Object.entries(o))n.node.style.setProperty(l,u);i!=null&&i.active&&n.node.classList.remove(i.active)}},gs=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:ve.Transform.toString(t)},{transform:ve.Transform.toString(n)}]},ps={duration:250,easing:"ease",keyframes:gs,sideEffects:hs({styles:{active:{opacity:"0"}}})};function vs(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=e;return ft((s,i)=>{if(t===null)return;const a=n.get(s);if(!a)return;const l=a.node.current;if(!l)return;const u=Sn(i);if(!u)return;const{transform:d}=H(i).getComputedStyle(i),f=fn(d);if(!f)return;const m=typeof t=="function"?t:ms(t);return xn(l,o.draggable.measure),m({active:{id:s,data:a.data,node:l,rect:o.draggable.measure(l)},draggableNodes:n,dragOverlay:{node:i,rect:o.dragOverlay.measure(u)},droppableContainers:r,measuringConfiguration:o,transform:f})})}function ms(e){const{duration:t,easing:n,sideEffects:r,keyframes:o}={...ps,...e};return s=>{let{active:i,dragOverlay:a,transform:l,...u}=s;if(!t)return;const d={x:a.rect.left-i.rect.left,y:a.rect.top-i.rect.top},f={scaleX:l.scaleX!==1?i.rect.width*l.scaleX/a.rect.width:1,scaleY:l.scaleY!==1?i.rect.height*l.scaleY/a.rect.height:1},m={x:l.x-d.x,y:l.y-d.y,...f},p=o({...u,active:i,dragOverlay:a,transform:{initial:l,final:m}}),[E]=p,b=p[p.length-1];if(JSON.stringify(E)===JSON.stringify(b))return;const x=r==null?void 0:r({active:i,dragOverlay:a,...u}),D=a.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(R=>{D.onfinish=()=>{x==null||x(),R()}})}}let nn=0;function bs(e){return c.useMemo(()=>{if(e!=null)return nn++,nn},[e])}const xs=L.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:o,transition:s,modifiers:i,wrapperElement:a="div",className:l,zIndex:u=999}=e;const{activatorEvent:d,active:f,activeNodeRect:m,containerNodeRect:p,draggableNodes:E,droppableContainers:b,dragOverlay:x,over:D,measuringConfiguration:R,scrollableAncestors:k,scrollableAncestorRects:N,windowRect:M}=En(),I=c.useContext(pt),g=bs(f==null?void 0:f.id),y=Rn(i,{activatorEvent:d,active:f,activeNodeRect:m,containerNodeRect:p,draggingNodeRect:x.rect,over:D,overlayNodeRect:x.rect,scrollableAncestors:k,scrollableAncestorRects:N,transform:I,windowRect:M}),S=Tt(m),v=vs({config:r,draggableNodes:E,droppableContainers:b,measuringConfiguration:R}),w=S?x.setRef:void 0;return L.createElement(ls,null,L.createElement(as,{animation:v},f&&g?L.createElement(fs,{key:g,id:f.id,ref:w,as:a,activatorEvent:d,adjustScale:t,className:l,transition:s,rect:S,style:{zIndex:u,...o},transform:y},n):null))});function Nn(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function ys(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function Ze(e){return e!==null&&e>=0}function ws(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Cs(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Mn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=Nn(t,r,n),i=t[o],a=s[o];return!a||!i?null:{x:a.left-i.left,y:a.top-i.top,scaleX:a.width/i.width,scaleY:a.height/i.height}},Qe={scaleX:1,scaleY:1},Ss=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:s,overIndex:i}=e;const a=(t=s[n])!=null?t:r;if(!a)return null;if(o===n){const u=s[i];return u?{x:0,y:n<i?u.top+u.height-(a.top+a.height):u.top-a.top,...Qe}:null}const l=Ds(s,o,n);return o>n&&o<=i?{x:0,y:-a.height-l,...Qe}:o<n&&o>=i?{x:0,y:a.height+l,...Qe}:{x:0,y:0,...Qe}};function Ds(e,t,n){const r=e[t],o=e[t-1],s=e[t+1];return r?n<t?o?r.top-(o.top+o.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const In="Sortable",jn=L.createContext({activeIndex:-1,containerId:In,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Mn,disabled:{draggable:!1,droppable:!1}});function ks(e){let{children:t,id:n,items:r,strategy:o=Mn,disabled:s=!1}=e;const{active:i,dragOverlay:a,droppableRects:l,over:u,measureDroppableContainers:d}=En(),f=Xe(In,n),m=a.rect!==null,p=c.useMemo(()=>r.map(I=>typeof I=="object"&&"id"in I?I.id:I),[r]),E=i!=null,b=i?p.indexOf(i.id):-1,x=u?p.indexOf(u.id):-1,D=c.useRef(p),R=!ws(p,D.current),k=x!==-1&&b===-1||R,N=Cs(s);Z(()=>{R&&E&&d(p)},[R,p,E,d]),c.useEffect(()=>{D.current=p},[p]);const M=c.useMemo(()=>({activeIndex:b,containerId:f,disabled:N,disableTransforms:k,items:p,overIndex:x,useDragOverlay:m,sortedRects:ys(p,l),strategy:o}),[b,f,N.draggable,N.droppable,k,p,x,l,m,o]);return L.createElement(jn.Provider,{value:M},t)}const Rs=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return Nn(n,r,o).indexOf(t)},Es=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:i,previousItems:a,previousContainerId:l,transition:u}=e;return!u||!r||a!==s&&o===i?!1:n?!0:i!==o&&t===l},Ns={duration:200,easing:"ease"},An="transform",Ms=ve.Transition.toString({property:An,duration:0,easing:"linear"}),Is={roleDescription:"sortable"};function js(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,i]=c.useState(null),a=c.useRef(n);return Z(()=>{if(!t&&n!==a.current&&r.current){const l=o.current;if(l){const u=Ne(r.current,{ignoreTransform:!0}),d={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(d.x||d.y)&&i(d)}}n!==a.current&&(a.current=n)},[t,n,r,o]),c.useEffect(()=>{s&&i(null)},[s]),s}function As(e){let{animateLayoutChanges:t=Es,attributes:n,disabled:r,data:o,getNewIndex:s=Rs,id:i,strategy:a,resizeObserverConfig:l,transition:u=Ns}=e;const{items:d,containerId:f,activeIndex:m,disabled:p,disableTransforms:E,sortedRects:b,overIndex:x,useDragOverlay:D,strategy:R}=c.useContext(jn),k=Ts(r,p),N=d.indexOf(i),M=c.useMemo(()=>({sortable:{containerId:f,index:N,items:d},...o}),[f,o,N,d]),I=c.useMemo(()=>d.slice(d.indexOf(i)),[d,i]),{rect:g,node:y,isOver:S,setNodeRef:v}=is({id:i,data:M,disabled:k.droppable,resizeObserverConfig:{updateMeasurementsFor:I,...l}}),{active:w,activatorEvent:j,activeNodeRect:O,attributes:C,setNodeRef:q,listeners:ce,isDragging:B,over:Ue,setActivatorNodeRef:re,transform:Me}=rs({id:i,data:M,attributes:{...Is,...n},disabled:k.draggable}),Ve=_r(v,q),W=!!w,oe=W&&!E&&Ze(m)&&Ze(x),me=!D&&B,Ie=me&&oe?Me:null,qe=oe?Ie??(a??R)({rects:b,activeNodeRect:O,activeIndex:m,overIndex:x,index:N}):null,le=Ze(m)&&Ze(x)?s({id:i,items:d,activeIndex:m,overIndex:x}):N,se=w==null?void 0:w.id,T=c.useRef({activeId:se,items:d,newIndex:le,containerId:f}),je=d!==T.current.items,ee=t({active:w,containerId:f,isDragging:B,isSorting:W,id:i,index:N,items:d,newIndex:T.current.newIndex,previousItems:T.current.items,previousContainerId:T.current.containerId,transition:u,wasDragging:T.current.activeId!=null}),xe=js({disabled:!ee,index:N,node:y,rect:g});return c.useEffect(()=>{W&&T.current.newIndex!==le&&(T.current.newIndex=le),f!==T.current.containerId&&(T.current.containerId=f),d!==T.current.items&&(T.current.items=d)},[W,le,f,d]),c.useEffect(()=>{if(se===T.current.activeId)return;if(se!=null&&T.current.activeId==null){T.current.activeId=se;return}const ye=setTimeout(()=>{T.current.activeId=se},50);return()=>clearTimeout(ye)},[se]),{active:w,activeIndex:m,attributes:C,data:M,rect:g,index:N,newIndex:le,items:d,isOver:S,isSorting:W,isDragging:B,listeners:ce,node:y,overIndex:x,over:Ue,setNodeRef:Ve,setActivatorNodeRef:re,setDroppableNodeRef:v,setDraggableNodeRef:q,transform:xe??qe,transition:ie()};function ie(){if(xe||je&&T.current.newIndex===N)return Ms;if(!(me&&!ht(j)||!u)&&(W||ee))return ve.Transition.toString({...u,property:An})}}function Ts(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}A.Down,A.Right,A.Up,A.Left;function Os(e,t,n){const r=e.slice(),[o]=r.splice(t,1);return o!==void 0&&r.splice(n,0,o),r}const ct=794,lt=1123,et=3.78,Bs=new Set(["header","section_title","divider","tristate","checklist","table","section_separator","table_of_contents","cover_header","page_header","page_footer","back_cover","page_break","content_placeholder","intervention_data","client_data","equipment_exchange","component_section"]),Ls=new Set(["intervention_data","client_data"]);function Ps(e){if(Bs.has(e.type))return"w-full";const t=e.config.width||"full";return cr[t]||"w-full"}function Tn({block:e,index:t,totalBlocks:n,onHeightChange:r}){const o=P(C=>C.selectedBlockId),s=P(C=>C.selectBlock),i=P(C=>C.removeBlock),a=P(C=>C.duplicateBlock),l=P(C=>C.moveBlock),u=o===e.id,d=e.type==="section_separator",f=sn.has(e.type),m=e.type==="back_cover",p=ut(e.type),E=Ps(e),b=E==="w-full",x=e.config.align||"left",D=b?"":x==="right"?"ml-auto":x==="center"?"mx-auto":"",[R,k]=c.useState(!1),N=c.useRef(null),{attributes:M,listeners:I,setNodeRef:g,transform:y,transition:S,isDragging:v}=As({id:e.id,disabled:d||f}),w={transform:ve.Transform.toString(y),transition:S,opacity:v?.3:1},j=c.useCallback(C=>{N.current=C,g(C)},[g]);if(c.useEffect(()=>{if(!N.current)return;const C=new ResizeObserver(q=>{for(const ce of q)r(e.id,ce.contentRect.height)});return C.observe(N.current),()=>C.disconnect()},[e.id,r]),!p)return h.jsx("div",{ref:j,style:w,className:be(E,"p-0.5"),children:h.jsxs("div",{className:"rounded border border-dashed border-destructive bg-destructive/5 p-4 text-sm text-destructive",children:["Bloque desconocido: ",e.type]})});const O=p.EditorPreview;return d?h.jsx("div",{ref:j,style:w,className:be("w-full cursor-pointer rounded-sm transition-all",u&&"ring-2 ring-primary ring-offset-1"),onClick:C=>{C.stopPropagation(),s(e.id)},children:h.jsx(O,{block:e,isSelected:u})}):h.jsx("div",{ref:j,style:{...w,padding:m?void 0:"1px"},className:be(E,"relative group",m&&"flex-1 flex flex-col",D),onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),children:h.jsxs("div",{className:be("relative rounded-sm transition-all cursor-pointer",m&&"flex-1 flex flex-col",u&&"ring-2 ring-primary ring-offset-1",!u&&R&&"ring-1 ring-primary/30"),onClick:C=>{C.stopPropagation(),s(e.id)},children:[(R||u)&&h.jsxs("div",{className:be("absolute z-20 flex items-center gap-0.5 rounded-md border bg-background/95 shadow-sm backdrop-blur-sm px-1 py-0.5",b?"-top-7 right-2":"-top-7 left-1/2 -translate-x-1/2"),onClick:C=>C.stopPropagation(),children:[h.jsx("button",{className:"rounded p-1 hover:bg-accent text-muted-foreground disabled:opacity-30",onClick:()=>l(e.id,"up"),disabled:t===0,title:"Mover arriba",children:h.jsx(hr,{className:"h-3 w-3"})}),h.jsx("button",{className:"rounded p-1 text-muted-foreground cursor-grab active:cursor-grabbing",title:"Arrastrar",...M,...I,children:h.jsx(br,{className:"h-3 w-3"})}),h.jsx("button",{className:"rounded p-1 hover:bg-accent text-muted-foreground disabled:opacity-30",onClick:()=>l(e.id,"down"),disabled:t===n-1,title:"Mover abajo",children:h.jsx(dr,{className:"h-3 w-3"})}),h.jsx("div",{className:"w-px h-4 bg-border mx-0.5"}),h.jsx("button",{className:"rounded p-1 hover:bg-accent text-muted-foreground",onClick:()=>a(e.id),title:"Duplicar",children:h.jsx(an,{className:"h-3 w-3"})}),h.jsx("button",{className:"rounded p-1 hover:bg-destructive/10 text-destructive",onClick:()=>i(e.id),title:"Eliminar",children:h.jsx(rn,{className:"h-3 w-3"})})]}),h.jsx("div",{className:be(ar[e.config.align||"left"],m&&"flex-1 flex flex-col"),children:h.jsx(O,{block:e,isSelected:u})})]})})}function _s({block:e}){const t=ut(e.type);if(!t)return null;const n=t.EditorPreview;return h.jsx("div",{className:"bg-white rounded-md shadow-lg border-2 border-primary/30 p-1 max-w-[600px] pointer-events-none",style:{opacity:.85},children:h.jsx(n,{block:e,isSelected:!1})})}function zs({blockIds:e,sectionChromeIds:t,allBlocks:n,pageConfig:r,scale:o,onBlockHeightChange:s}){const i=P(v=>v.selectBlock),a=n.length,l=r.orientation==="portrait",u=l?ct:lt,d=l?lt:ct,f=r.margins.top*et,m=r.margins.right*et,p=r.margins.bottom*et,E=r.margins.left*et,b=c.useMemo(()=>new Map(n.map(v=>[v.id,v])),[n]),x=c.useMemo(()=>e.map(v=>b.get(v)).filter(Boolean),[e,b]),D=c.useMemo(()=>t.map(v=>b.get(v)).filter(Boolean),[t,b]),R=c.useMemo(()=>x.some(v=>v.type==="back_cover"),[x]),{topChrome:k,contentBlocks:N,bottomChrome:M}=c.useMemo(()=>{const v=[],w=[],j=[],O=new Set;for(const C of D){if(O.has(C.id))continue;O.add(C.id),(Wt[C.type]||"top")==="bottom"?j.push({block:C,isInjected:!0}):v.push({block:C,isInjected:!0})}for(const C of x)O.has(C.id)||(O.add(C.id),sn.has(C.type)?(Wt[C.type]||"top")==="bottom"?j.push({block:C,isInjected:!1}):v.push({block:C,isInjected:!1}):w.push(C));return{topChrome:v,contentBlocks:w,bottomChrome:j}},[x,D]),I=c.useMemo(()=>{const v=new Map;return n.forEach((w,j)=>v.set(w.id,j)),v},[n]),g=c.useMemo(()=>{const v=[];let w=[];for(const j of N)Ls.has(j.type)?(w.length>0&&(v.push({type:"group",blocks:[...w]}),w=[]),v.push({type:"alignable",block:j})):w.push(j);return w.length>0&&v.push({type:"group",blocks:w}),v},[N]),y=v=>{const w=I.get(v.id)??0;return h.jsx(Tn,{block:v,index:w,totalBlocks:a,onHeightChange:s},v.id)},S=v=>{if(!v.isInjected)return y(v.block);const w=ut(v.block.type);if(!w)return null;const j=w.EditorPreview;return h.jsx("div",{className:"w-full",children:h.jsx(j,{block:v.block,isSelected:!1})},`injected-${v.block.id}`)};return h.jsx("div",{className:"bg-white shadow-lg border relative shrink-0 overflow-hidden",style:{width:u,height:d,transform:`scale(${o})`,transformOrigin:"top center",fontSize:`${r.fontSize}px`,fontFamily:r.fontFamily?`"${r.fontFamily}", sans-serif`:void 0},onClick:v=>{v.stopPropagation(),i(null)},children:x.length===0&&D.length===0?h.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground/50",style:{padding:`${f}px ${m}px ${p}px ${E}px`},children:[h.jsx("p",{className:"text-lg font-medium",children:"Canvas vacio"}),h.jsx("p",{className:"text-sm mt-1",children:"Haz clic en un bloque de la paleta para empezar"})]}):h.jsxs("div",{className:"flex flex-col h-full",children:[k.length>0&&h.jsx("div",{className:R?"flex flex-col flex-1":"shrink-0",children:k.map(S)}),!R&&h.jsx("div",{style:{flex:"1 1 0%",display:"flex",flexDirection:"column",overflow:"hidden",padding:`${k.length>0?8:f}px ${m}px ${M.length>0?8:p}px ${E}px`},children:g.map((v,w)=>{if(v.type==="group")return h.jsx("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",flexShrink:0},children:v.blocks.map(y)},`grp-${w}`);const j=v.block.config.verticalAlign||"top",O={flexShrink:0,width:"100%"};return j==="center"?(O.marginTop="auto",O.marginBottom="auto"):j==="bottom"&&(O.marginTop="auto"),h.jsx("div",{style:O,children:y(v.block)},v.block.id)})}),M.length>0&&h.jsx("div",{className:"shrink-0 mt-auto",children:M.map(S)})]})})}function Ws(){const e=P(g=>g.blocks),t=P(g=>g.pageConfig),n=P(g=>g.selectBlock),r=P(g=>g.blockHeights),o=P(g=>g.setBlockHeight),s=P(g=>g.reorderBlocks),i=c.useRef(null),[a,l]=c.useState(1),[u,d]=c.useState(null),f=Qr(Zr(At,{activationConstraint:{distance:5}})),m=c.useCallback((g,y)=>{const S=a>0?Math.round(y/a):y;o(g,S)},[a,o]),p=c.useCallback(()=>{if(!i.current)return;const g=i.current.clientWidth,S=t.orientation==="portrait"?ct:lt,v=g-80,w=Math.min(v/S,1);l(w)},[t.orientation]);c.useEffect(()=>{p();const g=new ResizeObserver(p);return i.current&&g.observe(i.current),()=>g.disconnect()},[p]);const E=c.useCallback(g=>{let y=0;for(const S of e){if(S.id===g)return y;S.type==="section_separator"&&y++}return y},[e]),b=c.useCallback(g=>{d(g.active.id)},[]),x=c.useCallback(g=>{const{active:y,over:S}=g;if(d(null),!S||y.id===S.id)return;const v=e.find(B=>B.id===y.id);if(!v||v.type==="section_separator")return;const w=e.find(B=>B.id===S.id);if((w==null?void 0:w.type)==="section_separator")return;const j=E(y.id),O=E(S.id);if(j!==O)return;const C=e.findIndex(B=>B.id===y.id),q=e.findIndex(B=>B.id===S.id);if(C===-1||q===-1)return;const ce=Os(e,C,q);s(ce.map(B=>B.id))},[e,E,s]),D=c.useCallback(()=>{d(null)},[]),{pages:R}=ir({blocks:e,pageConfig:t,blockHeights:r}),N=t.orientation==="portrait"?lt:ct,M=u?e.find(g=>g.id===u):null,I=c.useMemo(()=>e.map(g=>g.id),[e]);return h.jsx("div",{ref:i,className:"flex-1 overflow-y-auto bg-muted/40 p-8",onClick:()=>n(null),children:h.jsxs(es,{sensors:f,collisionDetection:so,onDragStart:b,onDragEnd:x,onDragCancel:D,children:[h.jsx(ks,{items:I,strategy:Ss,children:h.jsx("div",{className:"flex flex-col items-center",style:{gap:`${Math.max(24*a,12)}px`},children:R.map(g=>{const y=g.sectionSeparatorId?e.find(S=>S.id===g.sectionSeparatorId):null;return h.jsxs("div",{className:"flex flex-col items-center w-full",style:{gap:`${Math.max(16*a,8)}px`},children:[y&&h.jsx(Tn,{block:y,index:e.findIndex(S=>S.id===y.id),totalBlocks:e.length,onHeightChange:m}),h.jsx("div",{style:{height:N*a,width:"100%",display:"flex",justifyContent:"center"},children:h.jsx(zs,{blockIds:g.blockIds,sectionChromeIds:g.sectionChromeIds,allBlocks:e,pageConfig:t,scale:a,onBlockHeightChange:m})})]},g.pageIndex)})})}),h.jsx(xs,{children:M?h.jsx(_s,{block:M}):null})]})})}function Xs(){const e=P(d=>d.selectedBlockId),t=P(d=>d.blocks),n=P(d=>d.selectBlock),r=P(d=>d.updateBlockConfig),o=P(d=>d.duplicateBlock),s=P(d=>d.removeBlock);if(!e)return h.jsx("div",{className:"flex w-80 flex-col border-l bg-background",children:h.jsx("div",{className:"flex flex-1 items-center justify-center p-4 text-sm text-muted-foreground",children:"Selecciona un bloque para configurarlo"})});const i=t.find(d=>d.id===e);if(!i)return null;const a=ut(i.type),l=on[i.type];if(!a||!l)return null;const u=a.ConfigPanel;return h.jsxs("div",{className:"flex w-80 flex-col border-l bg-background",children:[h.jsxs("div",{className:"flex items-center justify-between border-b px-4 py-3",children:[h.jsx("div",{className:"flex items-center gap-2",children:h.jsx("span",{className:"text-sm font-semibold",children:l.label})}),h.jsx(xt,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>n(null),children:h.jsx(Kn,{className:"h-4 w-4"})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:h.jsx(u,{block:i,onChange:(d,f)=>r(i.id,d,f)})}),i.type!=="section_separator"&&h.jsxs("div",{className:"flex items-center gap-2 border-t px-4 py-3",children:[h.jsxs(xt,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>o(i.id),children:[h.jsx(an,{className:"h-4 w-4 mr-1"}),"Duplicar"]}),h.jsxs(xt,{variant:"outline",size:"sm",className:"flex-1 text-destructive hover:bg-destructive/10",onClick:()=>{s(i.id)},children:[h.jsx(rn,{className:"h-4 w-4 mr-1"}),"Eliminar"]})]})]})}function Ys({open:e,onOpenChange:t}){const n=P(o=>o.pageConfig),r=P(o=>o.updatePageConfig);return h.jsx(Gn,{open:e,onOpenChange:t,children:h.jsxs(Jn,{className:"sm:max-w-md",children:[h.jsx(Zn,{children:h.jsx(Qn,{children:"Configuracion de pagina"})}),h.jsxs("div",{className:"space-y-4 py-2",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Je,{children:"Orientacion"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{className:`flex-1 rounded-md border px-3 py-2 text-sm ${n.orientation==="portrait"?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>r({orientation:"portrait"}),children:"Vertical"}),h.jsx("button",{className:`flex-1 rounded-md border px-3 py-2 text-sm ${n.orientation==="landscape"?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>r({orientation:"landscape"}),children:"Horizontal"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Je,{children:"Margenes (mm)"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:["top","right","bottom","left"].map(o=>h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-xs text-muted-foreground w-16 capitalize",children:o==="top"?"Arriba":o==="right"?"Derecha":o==="bottom"?"Abajo":"Izquierda"}),h.jsx(Ht,{type:"number",min:5,max:50,value:n.margins[o],onChange:s=>r({margins:{...n.margins,[o]:Math.max(5,Math.min(50,Number(s.target.value)||5))}}),className:"h-8 w-full"})]},o))})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Je,{children:"Fuente del documento"}),h.jsx("select",{className:"w-full rounded-md border border-border bg-background px-3 py-2 text-sm",value:n.fontFamily||"Inter",onChange:o=>r({fontFamily:o.target.value}),children:lr.map(o=>h.jsx("option",{value:o.value,style:{fontFamily:o.value},children:o.label},o.value))})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Je,{children:"Tamano de fuente base (px)"}),h.jsx(Ht,{type:"number",min:8,max:14,value:n.fontSize,onChange:o=>r({fontSize:Math.max(8,Math.min(14,Number(o.target.value)||10))}),className:"h-8"})]})]})]})})}export{Hs as B,Xs as C,Ws as E,Ys as P};
