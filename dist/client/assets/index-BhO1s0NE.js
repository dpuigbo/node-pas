import{c as q,j as e,K as O,h as o,I as h,M as z,C as W,T,B as P,P as M,r as _,X as K}from"./index-BbT_qP1u.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],G=q("Calendar",V);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]],Y=q("Eraser",X);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],B=q("Image",J);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Z=q("Pen",Q);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],se=q("Square",ee);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],te=q("Upload",ae),Ge={orientation:"portrait",margins:{top:20,right:15,bottom:20,left:15},fontSize:10},D={full:"Completo",half:"Mitad",third:"Tercio",two_thirds:"Dos tercios"},L={full:"w-full",half:"w-1/2",third:"w-1/3",two_thirds:"w-2/3"},U={general:"General",level1:"Nivel 1",level2:"Nivel 2",level3:"Nivel 3"},le={general:"bg-gray-100 text-gray-700",level1:"bg-green-100 text-green-700",level2:"bg-amber-100 text-amber-700",level3:"bg-red-100 text-red-700"},H=new Map;function w(l){H.set(l.definition.type,l)}function Xe(l){return H.get(l)}const C={header:{type:"header",label:"Cabecera",icon:"FileText",category:"structure",hasData:!1,defaultConfig:{title:"Informe de Mantenimiento",subtitle:"",showLogo:!0,showDate:!0,showReference:!0,logoPosition:"left",logoUrl:""}},section_title:{type:"section_title",label:"Titulo de seccion",icon:"Heading",category:"structure",hasData:!1,defaultConfig:{title:"Nueva seccion",description:"",level:1,color:"#2563eb"}},divider:{type:"divider",label:"Separador",icon:"Minus",category:"structure",hasData:!1,defaultConfig:{style:"solid",spacing:"medium",color:"#e5e7eb"}},text_field:{type:"text_field",label:"Campo de texto",icon:"Type",category:"data",hasData:!0,defaultConfig:{key:"",label:"Campo de texto",required:!1,width:"full",helpText:"",placeholder:""}},number_field:{type:"number_field",label:"Campo numerico",icon:"Hash",category:"data",hasData:!0,defaultConfig:{key:"",label:"Campo numerico",required:!1,width:"full",helpText:"",unit:"",min:null,max:null}},date_field:{type:"date_field",label:"Campo de fecha",icon:"Calendar",category:"data",hasData:!0,defaultConfig:{key:"",label:"Fecha",required:!1,width:"full",helpText:""}},text_area:{type:"text_area",label:"Area de texto",icon:"AlignLeft",category:"data",hasData:!0,defaultConfig:{key:"",label:"Area de texto",required:!1,width:"full",helpText:"",rows:3,placeholder:""}},select_field:{type:"select_field",label:"Selector",icon:"ChevronDown",category:"data",hasData:!0,defaultConfig:{key:"",label:"Selector",required:!1,width:"full",helpText:"",options:[]}},tristate:{type:"tristate",label:"Inspeccion OK/NOK/NA",icon:"CheckCircle",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Punto de inspeccion",withObservation:!0,required:!1,maintenanceLevel:"general"}},checklist:{type:"checklist",label:"Lista de verificacion",icon:"ListChecks",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Lista de verificacion",items:[]}},table:{type:"table",label:"Tabla de datos",icon:"Table",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Tabla",columns:[],fixedRows:[],allowAddRows:!0,minRows:0,maxRows:50}},image:{type:"image",label:"Imagen",icon:"Image",category:"media",hasData:!0,defaultConfig:{key:"",label:"Imagen",allowMultiple:!1,maxFiles:1,maxSizeMB:5,width:"full"}},signature:{type:"signature",label:"Firma",icon:"Pen",category:"media",hasData:!0,defaultConfig:{key:"",label:"Firma",role:"Tecnico",required:!1,width:"half"}}},Ye=[{id:"structure",label:"Estructura",types:["header","section_title","divider"]},{id:"data",label:"Campos de datos",types:["text_field","number_field","date_field","text_area","select_field"]},{id:"inspection",label:"Inspeccion",types:["tristate","checklist","table"]},{id:"media",label:"Media y firma",types:["image","signature"]}];function re({block:l}){const a=l.config,t=a.title||"Informe de Mantenimiento",s=a.subtitle||"",r=a.showLogo!==!1,c=a.showDate!==!1,i=a.showReference!==!1,n=a.logoPosition||"left";return e.jsx("div",{className:"border-b pb-3 mb-2",children:e.jsxs("div",{className:`flex items-start gap-4 ${n==="right"?"flex-row-reverse":n==="center"?"flex-col items-center":""}`,children:[r&&e.jsx("div",{className:"flex h-14 w-14 shrink-0 items-center justify-center rounded-lg bg-gray-100 border border-dashed border-gray-300",children:e.jsx(O,{className:"h-6 w-6 text-gray-400"})}),e.jsxs("div",{className:`flex-1 ${n==="center"?"text-center":""}`,children:[e.jsx("h1",{className:"text-lg font-bold leading-tight",children:t}),s&&e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:s}),e.jsxs("div",{className:"flex gap-4 mt-2 text-[10px] text-gray-400",children:[c&&e.jsx("span",{children:"Fecha: ____/____/________"}),i&&e.jsx("span",{children:"Ref: __________"})]})]})]})})}function ce({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Titulo"}),e.jsx(h,{value:t.title||"",onChange:s=>a("title",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Subtitulo"}),e.jsx(h,{value:t.subtitle||"",onChange:s=>a("subtitle",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showLogo",checked:t.showLogo!==!1,onChange:s=>a("showLogo",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:"showLogo",className:"text-xs cursor-pointer",children:"Mostrar logo"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Posicion del logo"}),e.jsx("div",{className:"flex gap-1",children:["left","center","right"].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.logoPosition||"left")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("logoPosition",s),children:s==="left"?"Izquierda":s==="center"?"Centro":"Derecha"},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"URL del logo"}),e.jsx(h,{value:t.logoUrl||"",onChange:s=>a("logoUrl",s.target.value),placeholder:"https://...",className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showDate",checked:t.showDate!==!1,onChange:s=>a("showDate",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:"showDate",className:"text-xs cursor-pointer",children:"Mostrar fecha"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showReference",checked:t.showReference!==!1,onChange:s=>a("showReference",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:"showReference",className:"text-xs cursor-pointer",children:"Mostrar referencia"})]})]})}w({definition:C.header,EditorPreview:re,ConfigPanel:ce});function ie({block:l}){const a=l.config,t=a.title||"Seccion",s=a.description||"",r=a.level||1,c=a.color||"#2563eb",i={1:"text-base font-bold",2:"text-sm font-semibold",3:"text-xs font-semibold"};return e.jsxs("div",{className:"flex items-start gap-2 py-2",children:[e.jsx("div",{className:"w-1 shrink-0 rounded-full self-stretch",style:{backgroundColor:c}}),e.jsxs("div",{children:[e.jsx("div",{className:i[r]||i[1],children:t}),s&&e.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5",children:s})]})]})}function ne({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Titulo"}),e.jsx(h,{value:t.title||"",onChange:s=>a("title",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Descripcion"}),e.jsx(h,{value:t.description||"",onChange:s=>a("description",s.target.value),placeholder:"Opcional",className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Nivel"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(s=>e.jsxs("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.level||1)===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("level",s),children:["Nivel ",s]},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.color||"#2563eb",onChange:s=>a("color",s.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(h,{value:t.color||"#2563eb",onChange:s=>a("color",s.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})]})}w({definition:C.section_title,EditorPreview:ie,ConfigPanel:ne});function oe({block:l}){const a=l.config,t=a.style||"solid",s=a.spacing||"medium",r=a.color||"#e5e7eb",c={small:"py-1",medium:"py-3",large:"py-5"};if(t==="space")return e.jsx("div",{className:c[s]||c.medium});const i=t==="dashed"?"dashed":t==="dotted"?"dotted":"solid";return e.jsx("div",{className:c[s]||c.medium,children:e.jsx("hr",{style:{borderTopStyle:i,borderTopColor:r,borderTopWidth:"1px"},className:"border-0"})})}function de({block:l,onChange:a}){const t=l.config,s=[{value:"solid",label:"Solido"},{value:"dashed",label:"Discontinuo"},{value:"dotted",label:"Punteado"},{value:"space",label:"Espacio"}],r=[{value:"small",label:"Pequeno"},{value:"medium",label:"Mediano"},{value:"large",label:"Grande"}];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Estilo"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:s.map(c=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.style||"solid")===c.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("style",c.value),children:c.label},c.value))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Espaciado"}),e.jsx("div",{className:"flex gap-1",children:r.map(c=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.spacing||"medium")===c.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("spacing",c.value),children:c.label},c.value))})]}),t.style!=="space"&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.color||"#e5e7eb",onChange:c=>a("color",c.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(h,{value:t.color||"#e5e7eb",onChange:c=>a("color",c.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})]})}w({definition:C.divider,EditorPreview:oe,ConfigPanel:de});function R({block:l,children:a}){const t=l.config,s=t.label||"Campo",r=!!t.required,c=t.helpText||"",i=t.width||"full";return e.jsx("div",{className:`${L[i]} py-1`,children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xs font-medium text-gray-700",children:[s,r&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),a,c&&e.jsx("div",{className:"text-[10px] text-gray-400",children:c})]})})}function xe({block:l}){const a=l.config.placeholder||"";return e.jsx(R,{block:l,children:e.jsx("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center",children:a&&e.jsx("span",{className:"text-[10px] text-gray-300",children:a})})})}function S({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(h,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(h,{value:t.label||"",onChange:s=>a("label",s.target.value),placeholder:"Etiqueta del campo",className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${l.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(o,{htmlFor:`required-${l.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(D).map(([s,r])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${t.width===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:r},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Texto de ayuda"}),e.jsx(h,{value:t.helpText||"",onChange:s=>a("helpText",s.target.value),placeholder:"Opcional",className:"h-8"})]})]})}function me({block:l,onChange:a}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:l,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Placeholder"}),e.jsx(h,{value:l.config.placeholder||"",onChange:t=>a("placeholder",t.target.value),placeholder:"Texto de ejemplo...",className:"h-8"})]})]})}function he({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Campo",i=r.placeholder||"",n=!!r.required,d=r.helpText||"";return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(h,{value:a??"",onChange:x=>t(x.target.value||null),placeholder:i,readOnly:s,disabled:s}),d&&e.jsx("p",{className:"text-xs text-muted-foreground",children:d})]})}w({definition:C.text_field,EditorPreview:xe,ConfigPanel:me,FormField:he});function ue({block:l}){const a=l.config,t=a.unit||"",s=a.min,r=a.max;return e.jsxs(R,{block:l,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-7 flex-1 rounded border border-gray-200 bg-gray-50 px-2 flex items-center",children:e.jsx("span",{className:"text-[10px] text-gray-300",children:"0"})}),t&&e.jsx("span",{className:"shrink-0 rounded bg-gray-100 px-1.5 py-1 text-[10px] font-medium text-gray-500",children:t})]}),(s!==null||r!==null)&&e.jsxs("div",{className:"text-[9px] text-gray-300 mt-0.5",children:[s!==null&&`Min: ${s}`,s!==null&&r!==null&&" · ",r!==null&&`Max: ${r}`]})]})}function pe({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:l,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Unidad"}),e.jsx(h,{value:t.unit||"",onChange:s=>a("unit",s.target.value),placeholder:"mm, V, A, bar...",className:"h-8"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Minimo"}),e.jsx(h,{type:"number",value:t.min!==null&&t.min!==void 0?String(t.min):"",onChange:s=>a("min",s.target.value?Number(s.target.value):null),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Maximo"}),e.jsx(h,{type:"number",value:t.max!==null&&t.max!==void 0?String(t.max):"",onChange:s=>a("max",s.target.value?Number(s.target.value):null),className:"h-8"})]})]})]})]})}function ge({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Campo numerico",i=r.unit||"",n=!!r.required,d=r.helpText||"",x=r.min,m=r.max;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{type:"number",value:a!=null?String(a):"",onChange:p=>{const y=p.target.value;t(y===""?null:Number(y))},readOnly:s,disabled:s,min:x??void 0,max:m??void 0}),i&&e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:i})]}),d&&e.jsx("p",{className:"text-xs text-muted-foreground",children:d})]})}w({definition:C.number_field,EditorPreview:ue,ConfigPanel:pe,FormField:ge});function fe({block:l}){return e.jsx(R,{block:l,children:e.jsxs("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-gray-300",children:"DD/MM/AAAA"}),e.jsx(G,{className:"h-3 w-3 text-gray-300"})]})})}function ve({block:l,onChange:a}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:l,onChange:a}),e.jsx("p",{className:"text-[10px] text-muted-foreground border-t pt-2",children:"Este campo no tiene configuracion adicional."})]})}function je({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Fecha",i=!!r.required,n=r.helpText||"";return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(h,{type:"date",value:a??"",onChange:d=>t(d.target.value||null),readOnly:s,disabled:s}),n&&e.jsx("p",{className:"text-xs text-muted-foreground",children:n})]})}w({definition:C.date_field,EditorPreview:fe,ConfigPanel:ve,FormField:je});function Ne({block:l}){const a=l.config,t=a.rows||3,s=a.placeholder||"";return e.jsx(R,{block:l,children:e.jsx("div",{className:"rounded border border-gray-200 bg-gray-50 px-2 py-1",style:{minHeight:`${t*18}px`},children:s&&e.jsx("span",{className:"text-[10px] text-gray-300",children:s})})})}function be({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:l,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Filas visibles"}),e.jsx(h,{type:"number",min:2,max:10,value:t.rows||3,onChange:s=>a("rows",Math.max(2,Math.min(10,Number(s.target.value)||3))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Placeholder"}),e.jsx(h,{value:t.placeholder||"",onChange:s=>a("placeholder",s.target.value),placeholder:"Texto de ejemplo...",className:"h-8"})]})]})]})}function ye({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Area de texto",i=r.placeholder||"",n=!!r.required,d=r.helpText||"",x=r.rows||3;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(z,{value:a??"",onChange:m=>t(m.target.value||null),placeholder:i,readOnly:s,disabled:s,rows:x}),d&&e.jsx("p",{className:"text-xs text-muted-foreground",children:d})]})}w({definition:C.text_area,EditorPreview:Ne,ConfigPanel:be,FormField:ye});function we({block:l}){const a=l.config.options||[];return e.jsx(R,{block:l,children:e.jsxs("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-gray-300",children:a.length>0?`${a.length} opciones`:"Sin opciones"}),e.jsx(W,{className:"h-3 w-3 text-gray-300"})]})})}function Ce({options:l,onChange:a}){const t=()=>{const c=l.length+1;a([...l,{value:`opcion_${c}`,label:`Opcion ${c}`}])},s=c=>{a(l.filter((i,n)=>n!==c))},r=(c,i,n)=>{const d=l.map((x,m)=>m===c?{...x,[i]:n}:x);a(d)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs",children:"Opciones"}),l.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin opciones definidas"}),l.map((c,i)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{value:c.value,onChange:n=>{const d=n.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();r(i,"value",d)},placeholder:"valor",className:"h-7 text-xs font-mono flex-1"}),e.jsx(h,{value:c.label,onChange:n=>r(i,"label",n.target.value),placeholder:"Etiqueta",className:"h-7 text-xs flex-1"}),e.jsx("button",{onClick:()=>s(i),className:"shrink-0 rounded p-1 text-muted-foreground hover:text-destructive hover:bg-destructive/10",children:e.jsx(T,{className:"h-3 w-3"})})]},i)),e.jsxs(P,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"Anadir opcion"]})]})}function ke({block:l,onChange:a}){const t=l.config.options||[];return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:l,onChange:a}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(Ce,{options:t,onChange:s=>a("options",s)})})]})}function _e({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Selector",i=!!r.required,n=r.helpText||"",d=r.options??[];return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("select",{value:a??"",onChange:x=>t(x.target.value||null),disabled:s,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Seleccionar..."}),d.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))]}),n&&e.jsx("p",{className:"text-xs text-muted-foreground",children:n})]})}w({definition:C.select_field,EditorPreview:we,ConfigPanel:ke,FormField:_e});function $e({block:l}){const a=l.config,t=a.label||"Punto de inspeccion",s=a.withObservation!==!1,r=a.maintenanceLevel||"general",c=!!a.required;return e.jsxs("div",{className:"py-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`shrink-0 rounded px-1.5 py-0.5 text-[9px] font-medium ${le[r]}`,children:U[r]}),e.jsxs("span",{className:"flex-1 text-xs font-medium",children:[t,c&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"rounded border border-green-200 bg-green-50 px-2 py-0.5 text-[9px] font-medium text-green-600",children:"OK"}),e.jsx("span",{className:"rounded border border-red-200 bg-red-50 px-2 py-0.5 text-[9px] font-medium text-red-600",children:"NOK"}),e.jsx("span",{className:"rounded border border-gray-200 bg-gray-50 px-2 py-0.5 text-[9px] font-medium text-gray-500",children:"N/A"})]})]}),s&&e.jsx("div",{className:"mt-1 ml-16",children:e.jsx("div",{className:"h-5 rounded border border-dashed border-gray-200 bg-gray-50/50 px-2 flex items-center",children:e.jsx("span",{className:"text-[9px] text-gray-300",children:"Observaciones..."})})})]})}function Pe({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(h,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(h,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Nivel de mantenimiento"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(U).map(([s,r])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.maintenanceLevel||"general")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("maintenanceLevel",s),children:r},s))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`withObs-${l.id}`,checked:t.withObservation!==!1,onChange:s=>a("withObservation",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`withObs-${l.id}`,className:"text-xs cursor-pointer",children:"Con campo de observaciones"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${l.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`required-${l.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]})]})}const Fe=[{key:"ok",label:"OK",activeClass:"bg-green-600 text-white border-green-600"},{key:"nok",label:"NOK",activeClass:"bg-red-600 text-white border-red-600"},{key:"na",label:"N/A",activeClass:"bg-gray-500 text-white border-gray-500"}];function Ee({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Punto de inspeccion",i=r.withObservation!==!1,n=!!r.required,d=a??{valor:null,observacion:""},x=p=>{s||t({...d,valor:d.valor===p?null:p})},m=p=>{s||t({...d,observacion:p})};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs(o,{className:"flex-1",children:[c,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx("div",{className:"flex gap-1",children:Fe.map(p=>e.jsx("button",{type:"button",onClick:()=>x(p.key),disabled:s,className:`px-3 py-1 text-xs font-semibold rounded border transition-colors ${d.valor===p.key?p.activeClass:"border-gray-300 text-gray-500 hover:border-gray-400"} disabled:opacity-50 disabled:cursor-not-allowed`,children:p.label},p.key))})]}),i&&e.jsx(z,{value:d.observacion,onChange:p=>m(p.target.value),placeholder:"Observaciones...",rows:2,readOnly:s,disabled:s,className:"text-sm"})]})}w({definition:C.tristate,EditorPreview:$e,ConfigPanel:Pe,FormField:Ee});function qe({block:l}){const a=l.config,t=a.label||"Lista de verificacion",s=a.items||[];return e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),s.length===0?e.jsx("div",{className:"text-[10px] text-gray-300 italic",children:"Sin items definidos"}):e.jsx("div",{className:"space-y-0.5",children:s.map((r,c)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(se,{className:"h-3 w-3 text-gray-300 shrink-0"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:r.label})]},c))})]})}function Te({items:l,onChange:a}){const t=()=>{const c=l.length+1;a([...l,{key:`item_${c}`,label:`Item ${c}`}])},s=c=>{a(l.filter((i,n)=>n!==c))},r=(c,i,n)=>{const d=l.map((x,m)=>m===c?{...x,[i]:n}:x);a(d)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs",children:"Items"}),l.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin items definidos"}),l.map((c,i)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(h,{value:c.key,onChange:n=>{const d=n.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();r(i,"key",d)},placeholder:"clave",className:"h-7 text-xs font-mono flex-1"}),e.jsx(h,{value:c.label,onChange:n=>r(i,"label",n.target.value),placeholder:"Etiqueta",className:"h-7 text-xs flex-1"}),e.jsx("button",{onClick:()=>s(i),className:"shrink-0 rounded p-1 text-muted-foreground hover:text-destructive hover:bg-destructive/10",children:e.jsx(T,{className:"h-3 w-3"})})]},i)),e.jsxs(P,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"Anadir item"]})]})}function Me({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(h,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(h,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(Te,{items:t.items||[],onChange:s=>a("items",s)})})]})}function Re({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Lista de verificacion",i=r.items||[],n=!!r.required,d=a??[],x=m=>{if(s)return;const p=d.includes(m)?d.filter(y=>y!==m):[...d,m];t(p)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{children:[c,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),i.length===0?e.jsx("p",{className:"text-xs text-muted-foreground italic",children:"Sin items definidos"}):e.jsx("div",{className:"space-y-1.5",children:i.map(m=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",checked:d.includes(m.key),onChange:()=>x(m.key),disabled:s,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:"text-sm text-gray-700",children:m.label})]},m.key))})]})}w({definition:C.checklist,EditorPreview:qe,ConfigPanel:Me,FormField:Re});function Se({block:l}){const a=l.config,t=a.label||"Tabla",s=a.columns||[],r=a.fixedRows||[],c=a.allowAddRows!==!1;if(s.length===0)return e.jsxs("div",{className:"py-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsx("div",{className:"rounded border border-dashed border-gray-200 p-4 text-center text-[10px] text-gray-300",children:"Sin columnas definidas"})]});const i=r.slice(0,3),n=r.length>3?r.length-3:0;return e.jsxs("div",{className:"py-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsxs("div",{className:"rounded border overflow-hidden",children:[e.jsxs("table",{className:"w-full text-[10px]",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-gray-800 text-white",children:s.map(d=>e.jsx("th",{className:"px-2 py-1 text-left font-medium",style:{width:d.width!=="auto"?d.width:void 0},children:d.label},d.key))})}),e.jsx("tbody",{children:i.length>0?i.map((d,x)=>e.jsx("tr",{className:x%2===1?"bg-gray-50":"",children:s.map(m=>e.jsx("td",{className:"px-2 py-1 text-gray-500",children:String(d[m.key]||"")},m.key))},x)):e.jsx("tr",{children:s.map(d=>e.jsx("td",{className:"px-2 py-1",children:e.jsx("div",{className:"h-3 bg-gray-100 rounded"})},d.key))})})]}),n>0&&e.jsxs("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[9px] text-gray-400 text-center",children:["y ",n," mas..."]}),c&&e.jsx("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[9px] text-gray-400 text-center italic",children:"+ filas dinamicas"})]})]})}const De=[{value:"text",label:"Texto"},{value:"number",label:"Numero"},{value:"date",label:"Fecha"},{value:"tristate",label:"Tristate"},{value:"select",label:"Selector"}];function Le({columns:l,onChange:a}){const t=()=>{const c=l.length+1;a([...l,{key:`col_${c}`,label:`Columna ${c}`,type:"text",width:"auto"}])},s=c=>{a(l.filter((i,n)=>n!==c))},r=(c,i,n)=>{const d=l.map((x,m)=>m===c?{...x,[i]:n}:x);a(d)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs",children:"Columnas"}),l.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin columnas definidas"}),l.map((c,i)=>e.jsxs("div",{className:"rounded border p-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-medium text-muted-foreground",children:["Columna ",i+1]}),e.jsx("button",{onClick:()=>s(i),className:"rounded p-0.5 text-muted-foreground hover:text-destructive",children:e.jsx(T,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx(h,{value:c.key,onChange:n=>{const d=n.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();r(i,"key",d)},placeholder:"clave",className:"h-6 text-[10px] font-mono"}),e.jsx(h,{value:c.label,onChange:n=>r(i,"label",n.target.value),placeholder:"Etiqueta",className:"h-6 text-[10px]"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("select",{value:c.type,onChange:n=>r(i,"type",n.target.value),className:"h-6 flex-1 rounded border text-[10px] px-1",children:De.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))}),e.jsx(h,{value:c.width,onChange:n=>r(i,"width",n.target.value),placeholder:"auto",className:"h-6 w-16 text-[10px]",title:"Ancho (auto, 100px, 20%, etc.)"})]})]},i)),e.jsxs(P,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"Anadir columna"]})]})}function Ae({columns:l,rows:a,onChange:t}){if(l.length===0)return e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Filas fijas"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Define columnas primero para poder anadir filas fijas."})]});const s=()=>{const i={};l.forEach(n=>{i[n.key]=""}),t([...a,i])},r=i=>{t(a.filter((n,d)=>d!==i))},c=(i,n,d)=>{const x=a.map((m,p)=>p===i?{...m,[n]:d}:m);t(x)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{className:"text-xs",children:["Filas fijas (",a.length,")"]}),a.length>0&&e.jsx("div",{className:"rounded border overflow-x-auto",children:e.jsxs("table",{className:"w-full text-[10px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/50",children:[l.map(i=>e.jsx("th",{className:"px-1.5 py-1 text-left font-medium",children:i.label},i.key)),e.jsx("th",{className:"w-6"})]})}),e.jsx("tbody",{children:a.map((i,n)=>e.jsxs("tr",{className:"border-t",children:[l.map(d=>e.jsx("td",{className:"px-0.5 py-0.5",children:e.jsx(h,{value:String(i[d.key]||""),onChange:x=>c(n,d.key,x.target.value),className:"h-5 text-[10px] border-0 bg-transparent px-1"})},d.key)),e.jsx("td",{className:"px-0.5",children:e.jsx("button",{onClick:()=>r(n),className:"rounded p-0.5 text-muted-foreground hover:text-destructive",children:e.jsx(T,{className:"h-2.5 w-2.5"})})})]},n))})]})}),e.jsxs(P,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:s,children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),"Anadir fila fija"]})]})}function Ie({block:l,onChange:a}){const t=l.config,s=t.columns||[];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(h,{value:t.key||"",onChange:r=>{const c=r.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",c)},placeholder:"nombre_tabla",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(h,{value:t.label||"",onChange:r=>a("label",r.target.value),className:"h-8"})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(Le,{columns:s,onChange:r=>a("columns",r)})}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(Ae,{columns:s,rows:t.fixedRows||[],onChange:r=>a("fixedRows",r)})}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`allowAdd-${l.id}`,checked:t.allowAddRows!==!1,onChange:r=>a("allowAddRows",r.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`allowAdd-${l.id}`,className:"text-xs cursor-pointer",children:"Permitir anadir filas"})]}),t.allowAddRows!==!1&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Min filas"}),e.jsx(h,{type:"number",min:0,value:t.minRows||0,onChange:r=>a("minRows",Math.max(0,Number(r.target.value)||0)),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Max filas"}),e.jsx(h,{type:"number",min:1,value:t.maxRows||50,onChange:r=>a("maxRows",Math.max(1,Number(r.target.value)||50)),className:"h-8"})]})]})]})]})}function ze({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Tabla",i=r.columns||[],n=r.allowAddRows!==!1,d=r.maxRows||50,x=!!r.required,m=a??[],p=(v,N,j)=>{if(s)return;const k=m.map((g,f)=>f===v?{...g,[N]:j||null}:g);t(k)},y=()=>{if(s||m.length>=d)return;const v={};for(const N of i)v[N.key]=null;t([...m,v])},u=v=>{s||t(m.filter((N,j)=>j!==v))};return i.length===0?e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(o,{children:c}),e.jsx("p",{className:"text-xs text-muted-foreground italic",children:"Sin columnas definidas"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{children:[c,x&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx("div",{className:"rounded border overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-800 text-white",children:[i.map(v=>e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium",style:{width:v.width!=="auto"?v.width:void 0},children:v.label},v.key)),!s&&n&&e.jsx("th",{className:"px-2 py-2 w-10"})]})}),e.jsx("tbody",{children:m.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:i.length+(!s&&n?1:0),className:"px-3 py-4 text-center text-xs text-gray-400 italic",children:["Sin datos. ",n&&!s&&"Pulsa + para anadir una fila."]})}):m.map((v,N)=>e.jsxs("tr",{className:N%2===1?"bg-gray-50":"bg-white",children:[i.map(j=>e.jsx("td",{className:"px-2 py-1",children:e.jsx(h,{type:j.type==="number"?"number":"text",value:String(v[j.key]??""),onChange:k=>p(N,j.key,k.target.value),readOnly:s,disabled:s,className:"h-8 text-sm border-0 bg-transparent focus-visible:ring-1 px-1"})},j.key)),!s&&n&&e.jsx("td",{className:"px-1 py-1 text-center",children:e.jsx(P,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7 text-gray-400 hover:text-red-500",onClick:()=>u(N),children:e.jsx(T,{className:"h-3.5 w-3.5"})})})]},N))})]})}),n&&!s&&m.length<d&&e.jsxs(P,{type:"button",variant:"outline",size:"sm",className:"gap-1",onClick:y,children:[e.jsx(M,{className:"h-3.5 w-3.5"}),"Anadir fila"]})]})}w({definition:C.table,EditorPreview:Se,ConfigPanel:Ie,FormField:ze});function Be({block:l}){const a=l.config,t=a.label||"Imagen",s=a.maxFiles||1,r=a.width||"full";return e.jsxs("div",{className:`${L[r]} py-1`,children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsxs("div",{className:"flex flex-col items-center justify-center rounded border-2 border-dashed border-gray-200 bg-gray-50/50 p-6 gap-1",children:[e.jsx(B,{className:"h-8 w-8 text-gray-300"}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Hasta ",s," archivo",s>1?"s":""]})]})]})}function Ue({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(h,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(h,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`multi-${l.id}`,checked:!!t.allowMultiple,onChange:s=>a("allowMultiple",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`multi-${l.id}`,className:"text-xs cursor-pointer",children:"Permitir multiples"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Maximo de archivos"}),e.jsx(h,{type:"number",min:1,max:20,value:t.maxFiles||1,onChange:s=>a("maxFiles",Math.max(1,Math.min(20,Number(s.target.value)||1))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Tamano maximo (MB)"}),e.jsx(h,{type:"number",min:1,max:50,value:t.maxSizeMB||5,onChange:s=>a("maxSizeMB",Math.max(1,Math.min(50,Number(s.target.value)||5))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(D).map(([s,r])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.width||"full")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:r},s))})]})]})}function He({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Imagen",i=r.maxFiles||1,n=r.maxSizeMB||5,d=!!r.required,x=a??[],m=_.useRef(null),p=u=>{if(!u||s)return;const v=i-x.length,N=Array.from(u).slice(0,v);for(const j of N){if(j.size>n*1024*1024){alert(`"${j.name}" supera el limite de ${n} MB.`);continue}if(!j.type.startsWith("image/")){alert(`"${j.name}" no es una imagen valida.`);continue}const k=new FileReader;k.onload=()=>{const g={name:j.name,data:k.result};t([...x,g])},k.readAsDataURL(j)}m.current&&(m.current.value="")},y=u=>{s||t(x.filter((v,N)=>N!==u))};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{children:[c,d&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map((u,v)=>e.jsxs("div",{className:"relative group rounded border overflow-hidden",style:{width:120,height:90},children:[e.jsx("img",{src:u.data,alt:u.name,className:"w-full h-full object-cover"}),!s&&e.jsx("button",{type:"button",onClick:()=>y(v),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(K,{className:"h-3 w-3"})}),e.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-black/50 text-white text-[9px] px-1 py-0.5 truncate",children:u.name})]},v))}),!s&&x.length<i&&e.jsxs("div",{onClick:()=>{var u;return(u=m.current)==null?void 0:u.click()},onDragOver:u=>{u.preventDefault(),u.stopPropagation()},onDrop:u=>{u.preventDefault(),u.stopPropagation(),p(u.dataTransfer.files)},className:"flex flex-col items-center justify-center gap-2 rounded border-2 border-dashed border-gray-300 bg-gray-50 p-6 cursor-pointer hover:border-blue-400 hover:bg-blue-50/30 transition-colors",children:[e.jsx(te,{className:"h-6 w-6 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Arrastra imagenes o haz clic para seleccionar"}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Max ",n," MB por archivo",i>1&&` · ${x.length}/${i} archivos`]})]}),e.jsx("input",{ref:m,type:"file",accept:"image/*",multiple:i>1,onChange:u=>p(u.target.files),className:"hidden"}),s&&x.length===0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 rounded border border-dashed border-gray-200 p-6",children:[e.jsx(B,{className:"h-6 w-6 text-gray-300"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Sin imagenes"})]})]})}w({definition:C.image,EditorPreview:Be,ConfigPanel:Ue,FormField:He});function Oe({block:l}){const a=l.config,t=a.label||"Firma",s=a.role||"",r=!!a.required,c=a.width||"half";return e.jsxs("div",{className:`${L[c]} py-1`,children:[e.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-1",children:[t,r&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center rounded border border-gray-200 bg-gray-50/50 p-4 gap-1",children:[e.jsx(Z,{className:"h-5 w-5 text-gray-300"}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"Firma"}),s&&e.jsx("span",{className:"text-[9px] text-gray-300",children:s})]})]})}function We({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(h,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(h,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Rol"}),e.jsx(h,{value:t.role||"",onChange:s=>a("role",s.target.value),placeholder:"Tecnico PAS, Responsable cliente...",className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${l.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`required-${l.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(D).map(([s,r])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.width||"half")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:r},s))})]})]})}const F=400,E=180;function Ke({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,c=r.label||"Firma",i=r.role||"",n=!!r.required,d=a??null,x=_.useRef(null),m=_.useRef(!1),[p,y]=_.useState(!1);_.useEffect(()=>{const g=x.current;if(!g)return;const f=g.getContext("2d");if(f)if(f.clearRect(0,0,F,E),d){const b=new window.Image;b.onload=()=>{f.drawImage(b,0,0,F,E),y(!0)},b.src=d}else y(!1)},[d]);const u=_.useCallback(g=>{const f=x.current;if(!f)return{x:0,y:0};const b=f.getBoundingClientRect(),$=F/b.width,A=E/b.height;if("touches"in g){const I=g.touches[0]||g.changedTouches[0];return{x:(I.clientX-b.left)*$,y:(I.clientY-b.top)*A}}return{x:(g.clientX-b.left)*$,y:(g.clientY-b.top)*A}},[]),v=_.useCallback(g=>{var $;if(s)return;g.preventDefault(),m.current=!0;const f=($=x.current)==null?void 0:$.getContext("2d");if(!f)return;const b=u(g);f.beginPath(),f.moveTo(b.x,b.y),f.lineWidth=2,f.lineCap="round",f.lineJoin="round",f.strokeStyle="#1a1a1a"},[s,u]),N=_.useCallback(g=>{var $;if(!m.current||s)return;g.preventDefault();const f=($=x.current)==null?void 0:$.getContext("2d");if(!f)return;const b=u(g);f.lineTo(b.x,b.y),f.stroke(),y(!0)},[s,u]),j=_.useCallback(()=>{if(!m.current)return;m.current=!1;const g=x.current;if(!g)return;const f=g.toDataURL("image/png");t(f)},[t]),k=()=>{var f;if(s)return;const g=(f=x.current)==null?void 0:f.getContext("2d");g&&g.clearRect(0,0,F,E),y(!1),t(null)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(o,{children:[c,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"}),i&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground font-normal",children:["(",i,")"]})]}),!s&&p&&e.jsxs(P,{type:"button",variant:"ghost",size:"sm",className:"gap-1 text-xs h-7",onClick:k,children:[e.jsx(Y,{className:"h-3.5 w-3.5"}),"Borrar"]})]}),e.jsx("div",{className:`rounded border ${s?"border-gray-200 bg-gray-50":"border-gray-300 bg-white"} overflow-hidden`,children:e.jsx("canvas",{ref:x,width:F,height:E,className:`w-full touch-none ${s?"cursor-not-allowed opacity-70":"cursor-crosshair"}`,style:{maxWidth:"100%",height:"auto",aspectRatio:`${F}/${E}`},onMouseDown:v,onMouseMove:N,onMouseUp:j,onMouseLeave:j,onTouchStart:v,onTouchMove:N,onTouchEnd:j})}),!s&&!p&&e.jsx("p",{className:"text-[10px] text-muted-foreground text-center",children:"Dibuja tu firma con el raton o el dedo"})]})}w({definition:C.signature,EditorPreview:Oe,ConfigPanel:We,FormField:Ke});export{G as C,Ge as D,B as I,Z as P,Ye as a,C as b,Xe as g};
