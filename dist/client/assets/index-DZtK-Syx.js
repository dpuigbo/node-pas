import{f as $,j as e,a5 as U,s as o,_ as m,T as z,a3 as K,$ as M,B as F,m as T,r as _,X as W}from"./index-BCa5M7_f.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],G=$("AlignCenter",V);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Y=$("AlignLeft",X);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Q=$("AlignRight",J);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ee=$("Calendar",Z);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]],ae=$("Eraser",se);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],B=$("Image",te);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],re=$("Pen",le);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ne=$("Square",ce);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],oe=$("Upload",ie),ts={orientation:"portrait",margins:{top:20,right:15,bottom:20,left:15},fontSize:10},L={full:"Completo",half:"Mitad",third:"Tercio",two_thirds:"Dos tercios"},ls={full:"w-full",half:"w-1/2",third:"w-1/3",two_thirds:"w-2/3"},rs={left:"text-left",center:"text-center",right:"text-right"},H={general:"General",level1:"Nivel 1",level2:"Nivel 2",level3:"Nivel 3"},de={general:"bg-gray-100 text-gray-700",level1:"bg-green-100 text-green-700",level2:"bg-amber-100 text-amber-700",level3:"bg-red-100 text-red-700"},O=new Map;function y(r){O.set(r.definition.type,r)}function cs(r){return O.get(r)}const w={header:{type:"header",label:"Cabecera",icon:"FileText",category:"structure",hasData:!1,defaultConfig:{title:"Informe de Mantenimiento",subtitle:"",showLogo:!0,showDate:!0,showReference:!0,logoPosition:"left",logoUrl:""}},section_title:{type:"section_title",label:"Titulo de seccion",icon:"Heading",category:"structure",hasData:!1,defaultConfig:{title:"Nueva seccion",description:"",level:1,color:"#2563eb"}},divider:{type:"divider",label:"Separador",icon:"Minus",category:"structure",hasData:!1,defaultConfig:{style:"solid",spacing:"medium",color:"#e5e7eb"}},text_field:{type:"text_field",label:"Campo de texto",icon:"Type",category:"data",hasData:!0,defaultConfig:{key:"",label:"Campo de texto",required:!1,width:"full",helpText:"",placeholder:""}},number_field:{type:"number_field",label:"Campo numerico",icon:"Hash",category:"data",hasData:!0,defaultConfig:{key:"",label:"Campo numerico",required:!1,width:"full",helpText:"",unit:"",min:null,max:null}},date_field:{type:"date_field",label:"Campo de fecha",icon:"Calendar",category:"data",hasData:!0,defaultConfig:{key:"",label:"Fecha",required:!1,width:"full",helpText:""}},text_area:{type:"text_area",label:"Area de texto",icon:"AlignLeft",category:"data",hasData:!0,defaultConfig:{key:"",label:"Area de texto",required:!1,width:"full",helpText:"",rows:3,placeholder:""}},select_field:{type:"select_field",label:"Selector",icon:"ChevronDown",category:"data",hasData:!0,defaultConfig:{key:"",label:"Selector",required:!1,width:"full",helpText:"",options:[]}},tristate:{type:"tristate",label:"Inspeccion OK/NOK/NA",icon:"CheckCircle",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Punto de inspeccion",withObservation:!0,required:!1,maintenanceLevel:"general"}},checklist:{type:"checklist",label:"Lista de verificacion",icon:"ListChecks",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Lista de verificacion",items:[]}},table:{type:"table",label:"Tabla de datos",icon:"Table",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Tabla",columns:[],fixedRows:[],allowAddRows:!0,minRows:0,maxRows:50}},image:{type:"image",label:"Imagen",icon:"Image",category:"media",hasData:!0,defaultConfig:{key:"",label:"Imagen",allowMultiple:!1,maxFiles:1,maxSizeMB:5,width:"full"}},signature:{type:"signature",label:"Firma",icon:"Pen",category:"media",hasData:!0,defaultConfig:{key:"",label:"Firma",role:"Tecnico",required:!1,width:"half"}}},ns=[{id:"structure",label:"Estructura",types:["header","section_title","divider"]},{id:"data",label:"Campos de datos",types:["text_field","number_field","date_field","text_area","select_field"]},{id:"inspection",label:"Inspeccion",types:["tristate","checklist","table"]},{id:"media",label:"Media y firma",types:["image","signature"]}];function xe({block:r}){const a=r.config,t=a.title||"Informe de Mantenimiento",s=a.subtitle||"",l=a.showLogo!==!1,c=a.showDate!==!1,n=a.showReference!==!1,i=a.logoPosition||"left";return e.jsx("div",{className:"border-b pb-3 mb-2",children:e.jsxs("div",{className:`flex items-start gap-4 ${i==="right"?"flex-row-reverse":i==="center"?"flex-col items-center":""}`,children:[l&&e.jsx("div",{className:"flex h-14 w-14 shrink-0 items-center justify-center rounded-lg bg-gray-100 border border-dashed border-gray-300",children:e.jsx(U,{className:"h-6 w-6 text-gray-400"})}),e.jsxs("div",{className:`flex-1 ${i==="center"?"text-center":""}`,children:[e.jsx("h1",{className:"text-lg font-bold leading-tight",children:t}),s&&e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:s}),e.jsxs("div",{className:"flex gap-4 mt-2 text-[10px] text-gray-400",children:[c&&e.jsx("span",{children:"Fecha: ____/____/________"}),n&&e.jsx("span",{children:"Ref: __________"})]})]})]})})}const me=[{value:"left",icon:Y,label:"Izquierda"},{value:"center",icon:G,label:"Centro"},{value:"right",icon:Q,label:"Derecha"}];function D({value:r,onChange:a}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Alineacion"}),e.jsx("div",{className:"flex gap-1",children:me.map(t=>{const s=t.icon;return e.jsx("button",{className:`flex-1 flex items-center justify-center gap-1 rounded border px-2 py-1 text-xs ${r===t.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a(t.value),title:t.label,children:e.jsx(s,{className:"h-3.5 w-3.5"})},t.value)})})]})}function he({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Titulo"}),e.jsx(m,{value:t.title||"",onChange:s=>a("title",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Subtitulo"}),e.jsx(m,{value:t.subtitle||"",onChange:s=>a("subtitle",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showLogo",checked:t.showLogo!==!1,onChange:s=>a("showLogo",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:"showLogo",className:"text-xs cursor-pointer",children:"Mostrar logo"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Posicion del logo"}),e.jsx("div",{className:"flex gap-1",children:["left","center","right"].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.logoPosition||"left")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("logoPosition",s),children:s==="left"?"Izquierda":s==="center"?"Centro":"Derecha"},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"URL del logo"}),e.jsx(m,{value:t.logoUrl||"",onChange:s=>a("logoUrl",s.target.value),placeholder:"https://...",className:"h-8"})]}),e.jsx(D,{value:t.align||"left",onChange:s=>a("align",s)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showDate",checked:t.showDate!==!1,onChange:s=>a("showDate",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:"showDate",className:"text-xs cursor-pointer",children:"Mostrar fecha"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showReference",checked:t.showReference!==!1,onChange:s=>a("showReference",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:"showReference",className:"text-xs cursor-pointer",children:"Mostrar referencia"})]})]})}y({definition:w.header,EditorPreview:xe,ConfigPanel:he});function ue({block:r}){const a=r.config,t=a.title||"Seccion",s=a.description||"",l=a.level||1,c=a.color||"#2563eb",n={1:"text-base font-bold",2:"text-sm font-semibold",3:"text-xs font-semibold"};return e.jsxs("div",{className:"flex items-start gap-2 py-2",children:[e.jsx("div",{className:"w-1 shrink-0 rounded-full self-stretch",style:{backgroundColor:c}}),e.jsxs("div",{children:[e.jsx("div",{className:n[l]||n[1],children:t}),s&&e.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5",children:s})]})]})}function pe({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Titulo"}),e.jsx(m,{value:t.title||"",onChange:s=>a("title",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Descripcion"}),e.jsx(m,{value:t.description||"",onChange:s=>a("description",s.target.value),placeholder:"Opcional",className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Nivel"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(s=>e.jsxs("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.level||1)===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("level",s),children:["Nivel ",s]},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.color||"#2563eb",onChange:s=>a("color",s.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(m,{value:t.color||"#2563eb",onChange:s=>a("color",s.target.value),className:"h-8 font-mono text-xs flex-1"})]})]}),e.jsx(D,{value:t.align||"left",onChange:s=>a("align",s)})]})}y({definition:w.section_title,EditorPreview:ue,ConfigPanel:pe});function ge({block:r}){const a=r.config,t=a.style||"solid",s=a.spacing||"medium",l=a.color||"#e5e7eb",c={small:"py-1",medium:"py-3",large:"py-5"};if(t==="space")return e.jsx("div",{className:c[s]||c.medium});const n=t==="dashed"?"dashed":t==="dotted"?"dotted":"solid";return e.jsx("div",{className:c[s]||c.medium,children:e.jsx("hr",{style:{borderTopStyle:n,borderTopColor:l,borderTopWidth:"1px"},className:"border-0"})})}function fe({block:r,onChange:a}){const t=r.config,s=[{value:"solid",label:"Solido"},{value:"dashed",label:"Discontinuo"},{value:"dotted",label:"Punteado"},{value:"space",label:"Espacio"}],l=[{value:"small",label:"Pequeno"},{value:"medium",label:"Mediano"},{value:"large",label:"Grande"}];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Estilo"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:s.map(c=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.style||"solid")===c.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("style",c.value),children:c.label},c.value))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Espaciado"}),e.jsx("div",{className:"flex gap-1",children:l.map(c=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.spacing||"medium")===c.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("spacing",c.value),children:c.label},c.value))})]}),e.jsx(D,{value:t.align||"left",onChange:c=>a("align",c)}),t.style!=="space"&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.color||"#e5e7eb",onChange:c=>a("color",c.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(m,{value:t.color||"#e5e7eb",onChange:c=>a("color",c.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})]})}y({definition:w.divider,EditorPreview:ge,ConfigPanel:fe});function A({block:r,children:a}){const t=r.config,s=t.label||"Campo",l=!!t.required,c=t.helpText||"";return e.jsx("div",{className:"py-1",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-xs font-medium text-gray-700",children:[s,l&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),a,c&&e.jsx("div",{className:"text-[10px] text-gray-400",children:c})]})})}function je({block:r}){const a=r.config.placeholder||"";return e.jsx(A,{block:r,children:e.jsx("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center",children:a&&e.jsx("span",{className:"text-[10px] text-gray-300",children:a})})})}function S({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(m,{value:t.key||"",onChange:s=>{const l=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",l)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(m,{value:t.label||"",onChange:s=>a("label",s.target.value),placeholder:"Etiqueta del campo",className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${r.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(o,{htmlFor:`required-${r.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(L).map(([s,l])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${t.width===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:l},s))})]}),e.jsx(D,{value:t.align||"left",onChange:s=>a("align",s)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Texto de ayuda"}),e.jsx(m,{value:t.helpText||"",onChange:s=>a("helpText",s.target.value),placeholder:"Opcional",className:"h-8"})]})]})}function ve({block:r,onChange:a}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:r,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Placeholder"}),e.jsx(m,{value:r.config.placeholder||"",onChange:t=>a("placeholder",t.target.value),placeholder:"Texto de ejemplo...",className:"h-8"})]})]})}function be({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Campo",n=l.placeholder||"",i=!!l.required,d=l.helpText||"";return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(m,{value:a??"",onChange:x=>t(x.target.value||null),placeholder:n,readOnly:s,disabled:s}),d&&e.jsx("p",{className:"text-xs text-muted-foreground",children:d})]})}y({definition:w.text_field,EditorPreview:je,ConfigPanel:ve,FormField:be});function Ne({block:r}){const a=r.config,t=a.unit||"",s=a.min,l=a.max;return e.jsxs(A,{block:r,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-7 flex-1 rounded border border-gray-200 bg-gray-50 px-2 flex items-center",children:e.jsx("span",{className:"text-[10px] text-gray-300",children:"0"})}),t&&e.jsx("span",{className:"shrink-0 rounded bg-gray-100 px-1.5 py-1 text-[10px] font-medium text-gray-500",children:t})]}),(s!==null||l!==null)&&e.jsxs("div",{className:"text-[9px] text-gray-300 mt-0.5",children:[s!==null&&`Min: ${s}`,s!==null&&l!==null&&" · ",l!==null&&`Max: ${l}`]})]})}function ye({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:r,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Unidad"}),e.jsx(m,{value:t.unit||"",onChange:s=>a("unit",s.target.value),placeholder:"mm, V, A, bar...",className:"h-8"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Minimo"}),e.jsx(m,{type:"number",value:t.min!==null&&t.min!==void 0?String(t.min):"",onChange:s=>a("min",s.target.value?Number(s.target.value):null),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Maximo"}),e.jsx(m,{type:"number",value:t.max!==null&&t.max!==void 0?String(t.max):"",onChange:s=>a("max",s.target.value?Number(s.target.value):null),className:"h-8"})]})]})]})]})}function we({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Campo numerico",n=l.unit||"",i=!!l.required,d=l.helpText||"",x=l.min,h=l.max;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{type:"number",value:a!=null?String(a):"",onChange:u=>{const j=u.target.value;t(j===""?null:Number(j))},readOnly:s,disabled:s,min:x??void 0,max:h??void 0}),n&&e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:n})]}),d&&e.jsx("p",{className:"text-xs text-muted-foreground",children:d})]})}y({definition:w.number_field,EditorPreview:Ne,ConfigPanel:ye,FormField:we});function Ce({block:r}){return e.jsx(A,{block:r,children:e.jsxs("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-gray-300",children:"DD/MM/AAAA"}),e.jsx(ee,{className:"h-3 w-3 text-gray-300"})]})})}function ke({block:r,onChange:a}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:r,onChange:a}),e.jsx("p",{className:"text-[10px] text-muted-foreground border-t pt-2",children:"Este campo no tiene configuracion adicional."})]})}function _e({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Fecha",n=!!l.required,i=l.helpText||"";return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(m,{type:"date",value:a??"",onChange:d=>t(d.target.value||null),readOnly:s,disabled:s}),i&&e.jsx("p",{className:"text-xs text-muted-foreground",children:i})]})}y({definition:w.date_field,EditorPreview:Ce,ConfigPanel:ke,FormField:_e});function $e({block:r}){const a=r.config,t=a.rows||3,s=a.placeholder||"";return e.jsx(A,{block:r,children:e.jsx("div",{className:"rounded border border-gray-200 bg-gray-50 px-2 py-1",style:{minHeight:`${t*18}px`},children:s&&e.jsx("span",{className:"text-[10px] text-gray-300",children:s})})})}function Pe({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:r,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Filas visibles"}),e.jsx(m,{type:"number",min:2,max:10,value:t.rows||3,onChange:s=>a("rows",Math.max(2,Math.min(10,Number(s.target.value)||3))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Placeholder"}),e.jsx(m,{value:t.placeholder||"",onChange:s=>a("placeholder",s.target.value),placeholder:"Texto de ejemplo...",className:"h-8"})]})]})]})}function Fe({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Area de texto",n=l.placeholder||"",i=!!l.required,d=l.helpText||"",x=l.rows||3;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(z,{value:a??"",onChange:h=>t(h.target.value||null),placeholder:n,readOnly:s,disabled:s,rows:x}),d&&e.jsx("p",{className:"text-xs text-muted-foreground",children:d})]})}y({definition:w.text_area,EditorPreview:$e,ConfigPanel:Pe,FormField:Fe});function Ee({block:r}){const a=r.config.options||[];return e.jsx(A,{block:r,children:e.jsxs("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-gray-300",children:a.length>0?`${a.length} opciones`:"Sin opciones"}),e.jsx(K,{className:"h-3 w-3 text-gray-300"})]})})}function qe({options:r,onChange:a}){const t=()=>{const c=r.length+1;a([...r,{value:`opcion_${c}`,label:`Opcion ${c}`}])},s=c=>{a(r.filter((n,i)=>i!==c))},l=(c,n,i)=>{const d=r.map((x,h)=>h===c?{...x,[n]:i}:x);a(d)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs",children:"Opciones"}),r.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin opciones definidas"}),r.map((c,n)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{value:c.value,onChange:i=>{const d=i.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();l(n,"value",d)},placeholder:"valor",className:"h-7 text-xs font-mono flex-1"}),e.jsx(m,{value:c.label,onChange:i=>l(n,"label",i.target.value),placeholder:"Etiqueta",className:"h-7 text-xs flex-1"}),e.jsx("button",{onClick:()=>s(n),className:"shrink-0 rounded p-1 text-muted-foreground hover:text-destructive hover:bg-destructive/10",children:e.jsx(M,{className:"h-3 w-3"})})]},n)),e.jsxs(F,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),"Anadir opcion"]})]})}function Me({block:r,onChange:a}){const t=r.config.options||[];return e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{block:r,onChange:a}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(qe,{options:t,onChange:s=>a("options",s)})})]})}function Te({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Selector",n=!!l.required,i=l.helpText||"",d=l.options??[];return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(o,{children:[c,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("select",{value:a??"",onChange:x=>t(x.target.value||null),disabled:s,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Seleccionar..."}),d.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))]}),i&&e.jsx("p",{className:"text-xs text-muted-foreground",children:i})]})}y({definition:w.select_field,EditorPreview:Ee,ConfigPanel:Me,FormField:Te});function Ae({block:r}){const a=r.config,t=a.label||"Punto de inspeccion",s=a.withObservation!==!1,l=a.maintenanceLevel||"general",c=!!a.required;return e.jsxs("div",{className:"py-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`shrink-0 rounded px-1.5 py-0.5 text-[9px] font-medium ${de[l]}`,children:H[l]}),e.jsxs("span",{className:"flex-1 text-xs font-medium",children:[t,c&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"rounded border border-green-200 bg-green-50 px-2 py-0.5 text-[9px] font-medium text-green-600",children:"OK"}),e.jsx("span",{className:"rounded border border-red-200 bg-red-50 px-2 py-0.5 text-[9px] font-medium text-red-600",children:"NOK"}),e.jsx("span",{className:"rounded border border-gray-200 bg-gray-50 px-2 py-0.5 text-[9px] font-medium text-gray-500",children:"N/A"})]})]}),s&&e.jsx("div",{className:"mt-1 ml-16",children:e.jsx("div",{className:"h-5 rounded border border-dashed border-gray-200 bg-gray-50/50 px-2 flex items-center",children:e.jsx("span",{className:"text-[9px] text-gray-300",children:"Observaciones..."})})})]})}function Se({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(m,{value:t.key||"",onChange:s=>{const l=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",l)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(m,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Nivel de mantenimiento"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(H).map(([s,l])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.maintenanceLevel||"general")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("maintenanceLevel",s),children:l},s))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`withObs-${r.id}`,checked:t.withObservation!==!1,onChange:s=>a("withObservation",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`withObs-${r.id}`,className:"text-xs cursor-pointer",children:"Con campo de observaciones"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${r.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`required-${r.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]})]})}const Re=[{key:"ok",label:"OK",activeClass:"bg-green-600 text-white border-green-600"},{key:"nok",label:"NOK",activeClass:"bg-red-600 text-white border-red-600"},{key:"na",label:"N/A",activeClass:"bg-gray-500 text-white border-gray-500"}];function De({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Punto de inspeccion",n=l.withObservation!==!1,i=!!l.required,d=a??{valor:null,observacion:""},x=u=>{s||t({...d,valor:d.valor===u?null:u})},h=u=>{s||t({...d,observacion:u})};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs(o,{className:"flex-1",children:[c,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx("div",{className:"flex gap-1",children:Re.map(u=>e.jsx("button",{type:"button",onClick:()=>x(u.key),disabled:s,className:`px-3 py-1 text-xs font-semibold rounded border transition-colors ${d.valor===u.key?u.activeClass:"border-gray-300 text-gray-500 hover:border-gray-400"} disabled:opacity-50 disabled:cursor-not-allowed`,children:u.label},u.key))})]}),n&&e.jsx(z,{value:d.observacion,onChange:u=>h(u.target.value),placeholder:"Observaciones...",rows:2,readOnly:s,disabled:s,className:"text-sm"})]})}y({definition:w.tristate,EditorPreview:Ae,ConfigPanel:Se,FormField:De});function Le({block:r}){const a=r.config,t=a.label||"Lista de verificacion",s=a.items||[];return e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),s.length===0?e.jsx("div",{className:"text-[10px] text-gray-300 italic",children:"Sin items definidos"}):e.jsx("div",{className:"space-y-0.5",children:s.map((l,c)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ne,{className:"h-3 w-3 text-gray-300 shrink-0"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:l.label})]},c))})]})}function Ie({items:r,onChange:a}){const t=()=>{const c=r.length+1;a([...r,{key:`item_${c}`,label:`Item ${c}`}])},s=c=>{a(r.filter((n,i)=>i!==c))},l=(c,n,i)=>{const d=r.map((x,h)=>h===c?{...x,[n]:i}:x);a(d)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs",children:"Items"}),r.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin items definidos"}),r.map((c,n)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{value:c.key,onChange:i=>{const d=i.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();l(n,"key",d)},placeholder:"clave",className:"h-7 text-xs font-mono flex-1"}),e.jsx(m,{value:c.label,onChange:i=>l(n,"label",i.target.value),placeholder:"Etiqueta",className:"h-7 text-xs flex-1"}),e.jsx("button",{onClick:()=>s(n),className:"shrink-0 rounded p-1 text-muted-foreground hover:text-destructive hover:bg-destructive/10",children:e.jsx(M,{className:"h-3 w-3"})})]},n)),e.jsxs(F,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),"Anadir item"]})]})}function ze({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(m,{value:t.key||"",onChange:s=>{const l=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",l)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(m,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(Ie,{items:t.items||[],onChange:s=>a("items",s)})})]})}function Be({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Lista de verificacion",n=l.items||[],i=!!l.required,d=a??[],x=h=>{if(s)return;const u=d.includes(h)?d.filter(j=>j!==h):[...d,h];t(u)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{children:[c,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),n.length===0?e.jsx("p",{className:"text-xs text-muted-foreground italic",children:"Sin items definidos"}):e.jsx("div",{className:"space-y-1.5",children:n.map(h=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",checked:d.includes(h.key),onChange:()=>x(h.key),disabled:s,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:"text-sm text-gray-700",children:h.label})]},h.key))})]})}y({definition:w.checklist,EditorPreview:Le,ConfigPanel:ze,FormField:Be});function He({col:r,value:a}){const t=String(a??"");switch(r.type){case"checkbox":return e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`h-3 w-3 rounded-sm border ${t==="true"?"bg-primary border-primary":"border-gray-300"}`})});case"tristate":{const s=t||null;return e.jsx("div",{className:"flex gap-0.5 justify-center",children:["OK","NOK","NA"].map(l=>e.jsx("span",{className:`px-1 rounded text-[8px] font-medium ${s===l?l==="OK"?"bg-green-100 text-green-700":l==="NOK"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-500":"text-gray-300"}`,children:l},l))})}case"select":return e.jsx("span",{className:"text-gray-400 italic",children:t||"Seleccionar..."});default:return e.jsx("span",{className:"text-gray-500",children:t})}}function Oe({block:r}){const a=r.config,t=a.label||"Tabla",s=a.columns||[],l=a.fixedRows||[],c=a.allowAddRows!==!1,n=a.headerBg||"#1f2937",i=!!a.compact;if(s.length===0)return e.jsxs("div",{className:"py-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsx("div",{className:"rounded border border-dashed border-gray-200 p-4 text-center text-[10px] text-gray-300",children:"Sin columnas definidas"})]});const d=l.slice(0,3),x=l.length>3?l.length-3:0,h=i?"px-1.5 py-0.5":"px-2 py-1";return e.jsxs("div",{className:"py-2",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsxs("div",{className:"rounded border overflow-hidden",children:[e.jsxs("table",{className:"w-full text-[10px]",children:[e.jsx("thead",{children:e.jsx("tr",{style:{backgroundColor:n},children:s.map(u=>e.jsx("th",{className:`${h} text-left font-medium text-white`,style:{width:u.width!=="auto"?u.width:void 0},children:u.label},u.key))})}),e.jsx("tbody",{children:d.length>0?d.map((u,j)=>e.jsx("tr",{className:j%2===1?"bg-gray-50":"",children:s.map(f=>e.jsx("td",{className:h,children:e.jsx(He,{col:f,value:u[f.key]})},f.key))},j)):e.jsx("tr",{children:s.map(u=>e.jsx("td",{className:h,children:e.jsx("div",{className:"h-3 bg-gray-100 rounded"})},u.key))})})]}),x>0&&e.jsxs("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[9px] text-gray-400 text-center",children:["y ",x," mas..."]}),c&&e.jsx("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[9px] text-gray-400 text-center italic",children:"+ filas dinamicas"})]})]})}const Ue=[{value:"text",label:"Texto"},{value:"number",label:"Numero"},{value:"date",label:"Fecha"},{value:"checkbox",label:"Checkbox"},{value:"tristate",label:"Tristate"},{value:"select",label:"Selector"}];function Ke({columns:r,onChange:a}){const t=()=>{const c=r.length+1;a([...r,{key:`col_${c}`,label:`Columna ${c}`,type:"text",width:"auto"}])},s=c=>{a(r.filter((n,i)=>i!==c))},l=(c,n,i)=>{const d=r.map((x,h)=>h===c?{...x,[n]:i}:x);a(d)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs",children:"Columnas"}),r.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin columnas definidas"}),r.map((c,n)=>e.jsxs("div",{className:"rounded border p-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-medium text-muted-foreground",children:["Columna ",n+1]}),e.jsx("button",{onClick:()=>s(n),className:"rounded p-0.5 text-muted-foreground hover:text-destructive",children:e.jsx(M,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx(m,{value:c.key,onChange:i=>{const d=i.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();l(n,"key",d)},placeholder:"clave",className:"h-6 text-[10px] font-mono"}),e.jsx(m,{value:c.label,onChange:i=>l(n,"label",i.target.value),placeholder:"Etiqueta",className:"h-6 text-[10px]"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("select",{value:c.type,onChange:i=>l(n,"type",i.target.value),className:"h-6 flex-1 rounded border text-[10px] px-1",children:Ue.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))}),e.jsx(m,{value:c.width,onChange:i=>l(n,"width",i.target.value),placeholder:"auto",className:"h-6 w-16 text-[10px]",title:"Ancho (auto, 100px, 20%, etc.)"})]}),c.type==="select"&&e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"Opciones (una por linea)"}),e.jsx("textarea",{value:(c.options||[]).join(`
`),onChange:i=>{const d=i.target.value.split(`
`).filter(x=>x.trim());l(n,"options",d)},placeholder:`Opcion 1
Opcion 2`,className:"w-full rounded border text-[10px] px-1 py-0.5 resize-none",rows:3})]})]},n)),e.jsxs(F,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),"Anadir columna"]})]})}function We({columns:r,rows:a,onChange:t}){if(r.length===0)return e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Filas fijas"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Define columnas primero para poder anadir filas fijas."})]});const s=()=>{const n={};r.forEach(i=>{n[i.key]=""}),t([...a,n])},l=n=>{t(a.filter((i,d)=>d!==n))},c=(n,i,d)=>{const x=a.map((h,u)=>u===n?{...h,[i]:d}:h);t(x)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{className:"text-xs",children:["Filas fijas (",a.length,")"]}),a.length>0&&e.jsx("div",{className:"rounded border overflow-x-auto",children:e.jsxs("table",{className:"w-full text-[10px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/50",children:[r.map(n=>e.jsx("th",{className:"px-1.5 py-1 text-left font-medium",children:n.label},n.key)),e.jsx("th",{className:"w-6"})]})}),e.jsx("tbody",{children:a.map((n,i)=>e.jsxs("tr",{className:"border-t",children:[r.map(d=>e.jsx("td",{className:"px-0.5 py-0.5",children:e.jsx(m,{value:String(n[d.key]||""),onChange:x=>c(i,d.key,x.target.value),className:"h-5 text-[10px] border-0 bg-transparent px-1"})},d.key)),e.jsx("td",{className:"px-0.5",children:e.jsx("button",{onClick:()=>l(i),className:"rounded p-0.5 text-muted-foreground hover:text-destructive",children:e.jsx(M,{className:"h-2.5 w-2.5"})})})]},i))})]})}),e.jsxs(F,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:s,children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),"Anadir fila fija"]})]})}function Ve({block:r,onChange:a}){const t=r.config,s=t.columns||[];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(m,{value:t.key||"",onChange:l=>{const c=l.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",c)},placeholder:"nombre_tabla",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(m,{value:t.label||"",onChange:l=>a("label",l.target.value),className:"h-8"})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(Ke,{columns:s,onChange:l=>a("columns",l)})}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(We,{columns:s,rows:t.fixedRows||[],onChange:l=>a("fixedRows",l)})}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsx(o,{className:"text-xs font-semibold",children:"Estilo de tabla"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Color cabecera"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.headerBg||"#1f2937",onChange:l=>a("headerBg",l.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(m,{value:t.headerBg||"#1f2937",onChange:l=>a("headerBg",l.target.value),className:"h-8 font-mono text-xs flex-1"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`compact-${r.id}`,checked:!!t.compact,onChange:l=>a("compact",l.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`compact-${r.id}`,className:"text-xs cursor-pointer",children:"Compacta (padding reducido)"})]})]}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`allowAdd-${r.id}`,checked:t.allowAddRows!==!1,onChange:l=>a("allowAddRows",l.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`allowAdd-${r.id}`,className:"text-xs cursor-pointer",children:"Permitir anadir filas"})]}),t.allowAddRows!==!1&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Min filas"}),e.jsx(m,{type:"number",min:0,value:t.minRows||0,onChange:l=>a("minRows",Math.max(0,Number(l.target.value)||0)),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Max filas"}),e.jsx(m,{type:"number",min:1,value:t.maxRows||50,onChange:l=>a("maxRows",Math.max(1,Number(l.target.value)||50)),className:"h-8"})]})]})]})]})}function Ge({col:r,value:a,onChange:t,readOnly:s}){switch(r.type){case"checkbox":return e.jsx("div",{className:"flex justify-center py-1",children:e.jsx("input",{type:"checkbox",checked:a===!0||a==="true",onChange:l=>t(l.target.checked),disabled:s,className:"h-4 w-4 rounded border-gray-300"})});case"tristate":{const l=a,c=[{label:"OK",color:"text-gray-400 border-gray-200",activeColor:"bg-green-100 text-green-700 border-green-300"},{label:"NOK",color:"text-gray-400 border-gray-200",activeColor:"bg-red-100 text-red-700 border-red-300"},{label:"NA",color:"text-gray-400 border-gray-200",activeColor:"bg-gray-100 text-gray-600 border-gray-300"}];return e.jsx("div",{className:"flex gap-0.5 justify-center py-0.5",children:c.map(n=>e.jsx("button",{type:"button",disabled:s,className:`px-1.5 py-0.5 rounded border text-[11px] font-medium transition-colors ${l===n.label?n.activeColor:n.color} ${s?"cursor-default":"cursor-pointer hover:opacity-80"}`,onClick:()=>{s||t(l===n.label?null:n.label)},children:n.label},n.label))})}case"select":{const l=r.options||[];return e.jsxs("select",{value:String(a??""),onChange:c=>t(c.target.value||null),disabled:s,className:"h-8 w-full rounded border-0 bg-transparent text-sm px-1 focus:ring-1 focus:ring-primary",children:[e.jsx("option",{value:"",children:"—"}),l.map(c=>e.jsx("option",{value:c,children:c},c))]})}case"date":return e.jsx(m,{type:"date",value:String(a??""),onChange:l=>t(l.target.value||null),readOnly:s,disabled:s,className:"h-8 text-sm border-0 bg-transparent focus-visible:ring-1 px-1"});default:return e.jsx(m,{type:r.type==="number"?"number":"text",value:String(a??""),onChange:l=>t(l.target.value||null),readOnly:s,disabled:s,className:"h-8 text-sm border-0 bg-transparent focus-visible:ring-1 px-1"})}}function Xe({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Tabla",n=l.columns||[],i=l.allowAddRows!==!1,d=l.maxRows||50,x=!!l.required,h=l.headerBg||"#1f2937",u=!!l.compact,j=a??[],f=(b,p,g)=>{if(s)return;const v=j.map((C,R)=>R===b?{...C,[p]:g}:C);t(v)},k=()=>{if(s||j.length>=d)return;const b={};for(const p of n)b[p.key]=null;t([...j,b])},P=b=>{s||t(j.filter((p,g)=>g!==b))};if(n.length===0)return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(o,{children:c}),e.jsx("p",{className:"text-xs text-muted-foreground italic",children:"Sin columnas definidas"})]});const N=u?"px-1 py-0.5":"px-2 py-1";return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{children:[c,x&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx("div",{className:"rounded border overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:h},children:[n.map(b=>e.jsx("th",{className:`${N} text-left text-xs font-medium text-white`,style:{width:b.width!=="auto"?b.width:void 0},children:b.label},b.key)),!s&&i&&e.jsx("th",{className:`${N} w-10`})]})}),e.jsx("tbody",{children:j.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:n.length+(!s&&i?1:0),className:"px-3 py-4 text-center text-xs text-gray-400 italic",children:["Sin datos. ",i&&!s&&"Pulsa + para anadir una fila."]})}):j.map((b,p)=>e.jsxs("tr",{className:p%2===1?"bg-gray-50":"bg-white",children:[n.map(g=>e.jsx("td",{className:N,children:e.jsx(Ge,{col:g,value:b[g.key],onChange:v=>f(p,g.key,v),readOnly:!!s})},g.key)),!s&&i&&e.jsx("td",{className:"px-1 py-1 text-center",children:e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7 text-gray-400 hover:text-red-500",onClick:()=>P(p),children:e.jsx(M,{className:"h-3.5 w-3.5"})})})]},p))})]})}),i&&!s&&j.length<d&&e.jsxs(F,{type:"button",variant:"outline",size:"sm",className:"gap-1",onClick:k,children:[e.jsx(T,{className:"h-3.5 w-3.5"}),"Anadir fila"]})]})}y({definition:w.table,EditorPreview:Oe,ConfigPanel:Ve,FormField:Xe});function Ye({block:r}){const a=r.config,t=a.label||"Imagen",s=a.maxFiles||1;return e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsxs("div",{className:"flex flex-col items-center justify-center rounded border-2 border-dashed border-gray-200 bg-gray-50/50 p-6 gap-1",children:[e.jsx(B,{className:"h-8 w-8 text-gray-300"}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Hasta ",s," archivo",s>1?"s":""]})]})]})}function Je({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(m,{value:t.key||"",onChange:s=>{const l=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",l)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(m,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`multi-${r.id}`,checked:!!t.allowMultiple,onChange:s=>a("allowMultiple",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`multi-${r.id}`,className:"text-xs cursor-pointer",children:"Permitir multiples"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Maximo de archivos"}),e.jsx(m,{type:"number",min:1,max:20,value:t.maxFiles||1,onChange:s=>a("maxFiles",Math.max(1,Math.min(20,Number(s.target.value)||1))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Tamano maximo (MB)"}),e.jsx(m,{type:"number",min:1,max:50,value:t.maxSizeMB||5,onChange:s=>a("maxSizeMB",Math.max(1,Math.min(50,Number(s.target.value)||5))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(L).map(([s,l])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.width||"full")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:l},s))})]})]})}function Qe({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Imagen",n=l.maxFiles||1,i=l.maxSizeMB||5,d=!!l.required,x=a??[],h=_.useRef(null),u=f=>{if(!f||s)return;const k=n-x.length,P=Array.from(f).slice(0,k);for(const N of P){if(N.size>i*1024*1024){alert(`"${N.name}" supera el limite de ${i} MB.`);continue}if(!N.type.startsWith("image/")){alert(`"${N.name}" no es una imagen valida.`);continue}const b=new FileReader;b.onload=()=>{const p={name:N.name,data:b.result};t([...x,p])},b.readAsDataURL(N)}h.current&&(h.current.value="")},j=f=>{s||t(x.filter((k,P)=>P!==f))};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{children:[c,d&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map((f,k)=>e.jsxs("div",{className:"relative group rounded border overflow-hidden",style:{width:120,height:90},children:[e.jsx("img",{src:f.data,alt:f.name,className:"w-full h-full object-cover"}),!s&&e.jsx("button",{type:"button",onClick:()=>j(k),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(W,{className:"h-3 w-3"})}),e.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-black/50 text-white text-[9px] px-1 py-0.5 truncate",children:f.name})]},k))}),!s&&x.length<n&&e.jsxs("div",{onClick:()=>{var f;return(f=h.current)==null?void 0:f.click()},onDragOver:f=>{f.preventDefault(),f.stopPropagation()},onDrop:f=>{f.preventDefault(),f.stopPropagation(),u(f.dataTransfer.files)},className:"flex flex-col items-center justify-center gap-2 rounded border-2 border-dashed border-gray-300 bg-gray-50 p-6 cursor-pointer hover:border-blue-400 hover:bg-blue-50/30 transition-colors",children:[e.jsx(oe,{className:"h-6 w-6 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Arrastra imagenes o haz clic para seleccionar"}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Max ",i," MB por archivo",n>1&&` · ${x.length}/${n} archivos`]})]}),e.jsx("input",{ref:h,type:"file",accept:"image/*",multiple:n>1,onChange:f=>u(f.target.files),className:"hidden"}),s&&x.length===0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 rounded border border-dashed border-gray-200 p-6",children:[e.jsx(B,{className:"h-6 w-6 text-gray-300"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Sin imagenes"})]})]})}y({definition:w.image,EditorPreview:Ye,ConfigPanel:Je,FormField:Qe});function Ze({block:r}){const a=r.config,t=a.label||"Firma",s=a.role||"",l=!!a.required;return e.jsxs("div",{className:"py-1",children:[e.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-1",children:[t,l&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center rounded border border-gray-200 bg-gray-50/50 p-4 gap-1",children:[e.jsx(re,{className:"h-5 w-5 text-gray-300"}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"Firma"}),s&&e.jsx("span",{className:"text-[9px] text-gray-300",children:s})]})]})}function es({block:r,onChange:a}){const t=r.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(m,{value:t.key||"",onChange:s=>{const l=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",l)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Etiqueta"}),e.jsx(m,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Rol"}),e.jsx(m,{value:t.role||"",onChange:s=>a("role",s.target.value),placeholder:"Tecnico PAS, Responsable cliente...",className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${r.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(o,{htmlFor:`required-${r.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(L).map(([s,l])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.width||"half")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:l},s))})]})]})}const E=400,q=180;function ss({block:r,value:a,onChange:t,readOnly:s}){const l=r.config,c=l.label||"Firma",n=l.role||"",i=!!l.required,d=a??null,x=_.useRef(null),h=_.useRef(!1),[u,j]=_.useState(!1);_.useEffect(()=>{const p=x.current;if(!p)return;const g=p.getContext("2d");if(g)if(g.clearRect(0,0,E,q),d){const v=new window.Image;v.onload=()=>{g.drawImage(v,0,0,E,q),j(!0)},v.src=d}else j(!1)},[d]);const f=_.useCallback(p=>{const g=x.current;if(!g)return{x:0,y:0};const v=g.getBoundingClientRect(),C=E/v.width,R=q/v.height;if("touches"in p){const I=p.touches[0]||p.changedTouches[0];return{x:(I.clientX-v.left)*C,y:(I.clientY-v.top)*R}}return{x:(p.clientX-v.left)*C,y:(p.clientY-v.top)*R}},[]),k=_.useCallback(p=>{var C;if(s)return;p.preventDefault(),h.current=!0;const g=(C=x.current)==null?void 0:C.getContext("2d");if(!g)return;const v=f(p);g.beginPath(),g.moveTo(v.x,v.y),g.lineWidth=2,g.lineCap="round",g.lineJoin="round",g.strokeStyle="#1a1a1a"},[s,f]),P=_.useCallback(p=>{var C;if(!h.current||s)return;p.preventDefault();const g=(C=x.current)==null?void 0:C.getContext("2d");if(!g)return;const v=f(p);g.lineTo(v.x,v.y),g.stroke(),j(!0)},[s,f]),N=_.useCallback(()=>{if(!h.current)return;h.current=!1;const p=x.current;if(!p)return;const g=p.toDataURL("image/png");t(g)},[t]),b=()=>{var g;if(s)return;const p=(g=x.current)==null?void 0:g.getContext("2d");p&&p.clearRect(0,0,E,q),j(!1),t(null)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(o,{children:[c,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"}),n&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground font-normal",children:["(",n,")"]})]}),!s&&u&&e.jsxs(F,{type:"button",variant:"ghost",size:"sm",className:"gap-1 text-xs h-7",onClick:b,children:[e.jsx(ae,{className:"h-3.5 w-3.5"}),"Borrar"]})]}),e.jsx("div",{className:`rounded border ${s?"border-gray-200 bg-gray-50":"border-gray-300 bg-white"} overflow-hidden`,children:e.jsx("canvas",{ref:x,width:E,height:q,className:`w-full touch-none ${s?"cursor-not-allowed opacity-70":"cursor-crosshair"}`,style:{maxWidth:"100%",height:"auto",aspectRatio:`${E}/${q}`},onMouseDown:k,onMouseMove:P,onMouseUp:N,onMouseLeave:N,onTouchStart:k,onTouchMove:P,onTouchEnd:N})}),!s&&!u&&e.jsx("p",{className:"text-[10px] text-muted-foreground text-center",children:"Dibuja tu firma con el raton o el dedo"})]})}y({definition:w.signature,EditorPreview:Ze,ConfigPanel:es,FormField:ss});export{Y as A,rs as B,ee as C,ts as D,ls as F,B as I,re as P,ns as a,w as b,cs as g};
