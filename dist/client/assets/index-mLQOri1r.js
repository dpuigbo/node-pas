import{f as P,a6 as L,r as $,j as e,a8 as D,s as x,_ as u,B as I,T as xe,a4 as Ce,$ as A,m as R,a3 as me,X as he,a9 as ue,aa as W,S as _e,y as Se,ab as Pe,Z as $e,a2 as Ie}from"./index-D_M8fxta.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Te=P("AlignCenter",Ee);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Ae=P("AlignLeft",Me);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],qe=P("AlignRight",Re);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1",key:"ezmyqa"}],["path",{d:"M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1",key:"e1hn23"}]],Z=P("Braces",De);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Be=P("Calendar",Fe);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]],ze=P("Eraser",Le);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ue=P("Eye",He);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M21 7h-3a2 2 0 0 1-2-2V2",key:"9rb54x"}],["path",{d:"M21 6v6.5c0 .8-.7 1.5-1.5 1.5h-7c-.8 0-1.5-.7-1.5-1.5v-9c0-.8.7-1.5 1.5-1.5H17Z",key:"1059l0"}],["path",{d:"M7 8v8.8c0 .3.2.6.4.8.2.2.5.4.8.4H15",key:"16874u"}],["path",{d:"M3 12v8.8c0 .3.2.6.4.8.2.2.5.4.8.4H11",key:"k2ox98"}]],Xe=P("FileStack",Oe);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],pe=P("LayoutTemplate",Ve);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Ke=P("List",Ge);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Ye=P("Pen",We);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],Ze=P("Scissors",Je);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],es=P("Server",Qe);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Q=P("Square",ss);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]],ts=P("Tablet",as),ee=l=>{let a;const t=new Set,s=(d,m)=>{const h=typeof d=="function"?d(a):d;if(!Object.is(h,a)){const g=a;a=m??(typeof h!="object"||h===null)?h:Object.assign({},a,h),t.forEach(p=>p(a,g))}},r=()=>a,i={setState:s,getState:r,getInitialState:()=>o,subscribe:d=>(t.add(d),()=>t.delete(d))},o=a=l(s,r,i);return i},ls=(l=>l?ee(l):ee),rs=l=>l;function ns(l,a=rs){const t=L.useSyncExternalStore(l.subscribe,L.useCallback(()=>a(l.getState()),[l,a]),L.useCallback(()=>a(l.getInitialState()),[l,a]));return L.useDebugValue(t),t}const se=l=>{const a=ls(l),t=s=>ns(a,s);return Object.assign(t,a),t},cs=(l=>l?se(l):se),O={orientation:"portrait",margins:{top:20,right:15,bottom:20,left:15},fontSize:10,fontFamily:"Inter"},Ha=[{value:"Inter",label:"Inter (sans-serif)"},{value:"Arial",label:"Arial"},{value:"Helvetica",label:"Helvetica"},{value:"Georgia",label:"Georgia (serif)"},{value:"Times New Roman",label:"Times New Roman"},{value:"Courier New",label:"Courier New (mono)"},{value:"Roboto",label:"Roboto"},{value:"Open Sans",label:"Open Sans"}],ge=new Set(["cover_header","page_header","page_footer","back_cover"]),Ua={cover_header:"top",page_header:"top",page_footer:"bottom",back_cover:"top"},Y={full:"Completo",half:"Mitad",third:"Tercio",two_thirds:"Dos tercios"},Oa={full:"w-full",half:"w-1/2",third:"w-1/3",two_thirds:"w-2/3"},Xa={left:"text-left",center:"text-center",right:"text-right"},os={full:1,half:.5,third:.333,two_thirds:.667},fe=[{id:"portada",label:"Portada",color:"#2563eb"},{id:"intermedia",label:"Pagina Intermedia (Cabecera + Pie)",color:"#059669"},{id:"contraportada",label:"Contraportada",color:"#7c3aed"}],be={general:"General",level1:"Nivel 1",level2:"Nivel 2",level3:"Nivel 3"},is={general:"bg-gray-100 text-gray-700",level1:"bg-green-100 text-green-700",level2:"bg-amber-100 text-amber-700",level3:"bg-red-100 text-red-700"},je=new Map;function C(l){je.set(l.definition.type,l)}function Va(l){return je.get(l)}const k={header:{type:"header",label:"Cabecera",icon:"FileText",category:"structure",hasData:!1,defaultConfig:{title:"Informe de Mantenimiento",subtitle:"",showLogo:!0,showDate:!0,showReference:!0,logoPosition:"left",logoUrl:""}},section_title:{type:"section_title",label:"Titulo de seccion",icon:"Heading",category:"structure",hasData:!1,defaultConfig:{title:"Nueva seccion",description:"",level:1,color:"#2563eb"}},divider:{type:"divider",label:"Separador",icon:"Minus",category:"structure",hasData:!1,defaultConfig:{style:"solid",spacing:"medium",color:"#e5e7eb"}},text_field:{type:"text_field",label:"Campo de texto",icon:"Type",category:"data",hasData:!0,defaultConfig:{key:"",label:"Campo de texto",required:!1,width:"full",helpText:"",placeholder:""}},number_field:{type:"number_field",label:"Campo numerico",icon:"Hash",category:"data",hasData:!0,defaultConfig:{key:"",label:"Campo numerico",required:!1,width:"full",helpText:"",unit:"",min:null,max:null}},date_field:{type:"date_field",label:"Campo de fecha",icon:"Calendar",category:"data",hasData:!0,defaultConfig:{key:"",label:"Fecha",required:!1,width:"full",helpText:""}},text_area:{type:"text_area",label:"Area de texto",icon:"AlignLeft",category:"data",hasData:!0,defaultConfig:{key:"",label:"Area de texto",required:!1,width:"full",helpText:"",rows:3,placeholder:""}},select_field:{type:"select_field",label:"Selector",icon:"ChevronDown",category:"data",hasData:!0,defaultConfig:{key:"",label:"Selector",required:!1,width:"full",helpText:"",options:[]}},tristate:{type:"tristate",label:"Inspeccion OK/NOK/NA",icon:"CheckCircle",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Punto de inspeccion",withObservation:!0,required:!1,maintenanceLevel:"general"}},checklist:{type:"checklist",label:"Lista de verificacion",icon:"ListChecks",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Lista de verificacion",layout:"vertical",items:[]}},table:{type:"table",label:"Tabla de datos",icon:"Table",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Tabla",title:"",titleBg:"#1f2937",titleColor:"#ffffff",headerPosition:"top",headerColor:"#ffffff",columns:[],fixedRows:[],allowAddRows:!0,minRows:0,maxRows:50}},image:{type:"image",label:"Imagen",icon:"Image",category:"media",hasData:!0,defaultConfig:{key:"",label:"Imagen",allowMultiple:!1,maxFiles:1,maxSizeMB:5,width:"full"}},signature:{type:"signature",label:"Firma",icon:"Pen",category:"media",hasData:!0,defaultConfig:{key:"",label:"Firma",role:"Tecnico",required:!1,width:"half"}},section_separator:{type:"section_separator",label:"Separador de seccion",icon:"FileStack",category:"structure",hasData:!1,defaultConfig:{section:"portada"}},table_of_contents:{type:"table_of_contents",label:"Tabla de contenidos",icon:"List",category:"structure",hasData:!1,defaultConfig:{title:"Tabla de contenidos"}},cover_header:{type:"cover_header",label:"Portada (banner)",icon:"BookOpen",category:"document",hasData:!1,defaultConfig:{title:"Reporte de mantenimiento",subtitle:"",companyName:"PAS Robotics",logoUrl:"",logoPosition:"right",logoVerticalAlign:"center",backgroundColor:"#000000",textColor:"#ffffff",titleSize:24,height:280}},page_header:{type:"page_header",label:"Cabecera de pagina",icon:"PanelTop",category:"document",hasData:!1,defaultConfig:{title:"Reporte de mantenimiento",subtitle:"",logoUrl:"",logoSize:24,backgroundColor:"#1f2937",textColor:"#ffffff",textSize:12,height:40}},page_footer:{type:"page_footer",label:"Pie de pagina",icon:"PanelBottom",category:"document",hasData:!1,defaultConfig:{companyName:"PAS Robotics",showPageNumbers:!0,backgroundColor:"#1f2937",textColor:"#ffffff",textSize:10,backgroundImage:"",height:36}},back_cover:{type:"back_cover",label:"Contraportada",icon:"Square",category:"document",hasData:!1,defaultConfig:{logoUrl:"",backgroundColor:"#111827"}},page_break:{type:"page_break",label:"Salto de pagina",icon:"SeparatorHorizontal",category:"structure",hasData:!1,defaultConfig:{}},content_placeholder:{type:"content_placeholder",label:"Contenido del sistema",icon:"LayoutTemplate",category:"document",hasData:!1,defaultConfig:{label:"Contenido del informe (se llena automaticamente)",contentType:"all"}},intervention_data:{type:"intervention_data",label:"Datos de intervencion",icon:"ClipboardList",category:"document",hasData:!1,defaultConfig:{title:"",accentColor:"#1e40af",verticalAlign:"top"}},client_data:{type:"client_data",label:"Datos del cliente",icon:"Building2",category:"document",hasData:!1,defaultConfig:{title:"",verticalAlign:"top"}},equipment_exchange:{type:"equipment_exchange",label:"Intercambio de equipos",icon:"ArrowLeftRight",category:"inspection",hasData:!0,defaultConfig:{key:"",label:"Intercambio de equipos",defaultRows:5,headerBg:"#1f2937",headerColor:"#ffffff",required:!1}}},Ga=[{id:"structure",label:"Estructura",types:["header","section_title","divider","table_of_contents","page_break"]},{id:"data",label:"Campos de datos",types:["text_field","number_field","date_field","text_area","select_field"]},{id:"inspection",label:"Inspeccion",types:["tristate","checklist","table","equipment_exchange"]},{id:"media",label:"Media y firma",types:["image","signature"]},{id:"document",label:"Documento",types:["cover_header","page_header","page_footer","back_cover","content_placeholder","intervention_data","client_data"]}];function ds(l,a,t){const s={...l},r=a.split(".");let n=s;for(let i=0;i<r.length-1;i++){const o=r[i],d=r[i+1],m=d!=null&&/^\d+$/.test(d);Array.isArray(n[o])?n[o]=[...n[o]]:typeof n[o]=="object"&&n[o]!==null?n[o]={...n[o]}:n[o]=m?[]:{},n=n[o]}const c=r[r.length-1];return c!=null&&(n[c]=t),s}function ae(l,a){const t=l.replace(/_/g,"_"),s=a.filter(n=>n.type===l).map(n=>{const i=(n.config.key||"").match(new RegExp(`^${t}_(\\d+)$`));return(i==null?void 0:i[1])!=null?parseInt(i[1],10):0}),r=s.length>0?Math.max(...s):0;return`${t}_${r+1}`}function te(){return crypto.randomUUID()}const le=["portada","intermedia","contraportada"];function xs(l){const t=l.filter(n=>n.type==="section_separator").map(n=>n.config.section);if(le.every(n=>t.includes(n)))return l;const s=l.filter(n=>n.type!=="section_separator"),r=[];for(const n of le)r.push({id:`section-${n}`,type:"section_separator",config:{section:n}});return s.length>0&&r.splice(1,0,...s),r}const X=cs((l,a)=>({blocks:[],pageConfig:{...O},selectedBlockId:null,isDirty:!1,versionId:null,modeloId:null,isDocumentTemplate:!1,blockHeights:new Map,loadSchema:(t,s,r,n=!1)=>{let c=t.blocks||[];n&&(c=xs(c)),l({blocks:c,pageConfig:t.pageConfig||{...O},selectedBlockId:null,isDirty:!1,versionId:r,modeloId:s,isDocumentTemplate:n,blockHeights:new Map})},addBlock:(t,s)=>{const r=k[t];if(!r)return;const{blocks:n,selectedBlockId:c,isDocumentTemplate:i}=a(),o={...r.defaultConfig};r.hasData&&(o.key=ae(t,n));const d={id:te(),type:t,config:o},m=[...n];if(s!==void 0&&s>=0&&s<=n.length)m.splice(s,0,d);else if(i)if(c){const h=n.findIndex(g=>g.id===c);if(h!==-1)if(n[h].type==="section_separator"){let p=h+1;for(;p<n.length&&n[p].type!=="section_separator";)p++;m.splice(p,0,d)}else m.splice(h+1,0,d);else{const g=n.findIndex((p,f)=>f>0&&p.type==="section_separator");m.splice(g!==-1?g:n.length,0,d)}}else{const h=n.findIndex((g,p)=>p>0&&g.type==="section_separator");m.splice(h!==-1?h:n.length,0,d)}else m.push(d);l({blocks:m,isDirty:!0,selectedBlockId:d.id})},removeBlock:t=>{const{blocks:s,selectedBlockId:r}=a(),n=s.find(i=>i.id===t);if((n==null?void 0:n.type)==="section_separator")return;const c=new Map(a().blockHeights);c.delete(t),l({blocks:s.filter(i=>i.id!==t),isDirty:!0,selectedBlockId:r===t?null:r,blockHeights:c})},duplicateBlock:t=>{const{blocks:s}=a(),r=s.findIndex(m=>m.id===t);if(r===-1)return;const n=s[r];if(n.type==="section_separator")return;const c=k[n.type],i=JSON.parse(JSON.stringify(n.config));c!=null&&c.hasData&&i.key&&(i.key=ae(n.type,s));const o={id:te(),type:n.type,config:i},d=[...s];d.splice(r+1,0,o),l({blocks:d,isDirty:!0,selectedBlockId:o.id})},moveBlock:(t,s)=>{const{blocks:r}=a(),n=r.findIndex(h=>h.id===t);if(n===-1||r[n].type==="section_separator")return;const i=s==="up"?n-1:n+1;if(i<0||i>=r.length||r[i].type==="section_separator")return;const o=[...r],d=o[n],m=o[i];o[n]=m,o[i]=d,l({blocks:o,isDirty:!0})},reorderBlocks:t=>{const{blocks:s}=a(),r=new Map(s.map(i=>[i.id,i])),n=t.map(i=>r.get(i)).filter(Boolean),c=s.filter(i=>!t.includes(i.id));l({blocks:[...n,...c],isDirty:!0})},updateBlockConfig:(t,s,r)=>{const{blocks:n}=a();l({blocks:n.map(c=>c.id===t?{...c,config:ds(c.config,s,r)}:c),isDirty:!0})},selectBlock:t=>{l({selectedBlockId:t})},updatePageConfig:t=>{const{pageConfig:s}=a();l({pageConfig:{...s,...t},isDirty:!0})},setBlockHeight:(t,s)=>{const{blockHeights:r}=a();if(r.get(t)===s)return;const n=new Map(r);n.set(t,s),l({blockHeights:n})},getSchema:()=>{const{blocks:t,pageConfig:s}=a();return{blocks:t,pageConfig:s}},markClean:()=>{l({isDirty:!1})},reset:()=>{l({blocks:[],pageConfig:{...O},selectedBlockId:null,isDirty:!1,versionId:null,modeloId:null,isDocumentTemplate:!1,blockHeights:new Map})}})),ms=794,hs=1123,us=3.78,ps=new Set(["header","section_title","divider","tristate","checklist","table","section_separator","table_of_contents","cover_header","page_header","page_footer","back_cover","page_break","content_placeholder","intervention_data","client_data","equipment_exchange"]);function gs(l){if(ps.has(l.type))return 1;const a=l.config.width||"full";return os[a]??1}function fs(l){const a=new Map;let t=0;for(const s of l){if(s.type==="section_separator"){t++;continue}if(ge.has(s.type)){const r=a.get(t)||[];r.push(s),a.set(t,r)}}return a}function bs({blocks:l,pageConfig:a,blockHeights:t}){return $.useMemo(()=>{if(l.length===0)return{pages:[{pageIndex:0,blockIds:[],sectionChromeIds:[]}],totalPages:1};const r=a.orientation==="portrait"?hs:ms,n=(a.margins.top+a.margins.bottom)*us,c=r-n,i=fs(l),o=[];let d={pageIndex:0,blockIds:[],sectionChromeIds:[]},m=0,h=0,g=0,p=0,f=[],N=0,b=!0;const S=()=>{const v=i.get(N);if(!v)return 0;let _=0;for(const E of v)E.type!=="back_cover"&&(_+=t.get(E.id)||40);return _},j=()=>{const v=i.get(N);return v?v.filter(_=>_.type!=="back_cover").map(_=>_.id):[]},y=()=>{const v=h+S();return v>0?r-v-16:c},w=()=>{if(f.length===0)return;const v=y();m+p>v&&d.blockIds.length>0&&(b||(d.sectionChromeIds=j()),o.push(d),d={pageIndex:o.length,blockIds:[],sectionChromeIds:[]},m=0,h=0,b=!1),d.blockIds.push(...f),m+=p,g=0,p=0,f=[]};for(const v of l){if(v.type==="section_separator"){w(),d.blockIds.length>0&&(b||(d.sectionChromeIds=j()),o.push(d)),N++,b=!0,d={pageIndex:o.length,blockIds:[],sectionChromeIds:[],sectionSeparatorId:v.id},m=0,h=0;continue}if(v.type==="page_break"){w(),d.blockIds.push(v.id),b||(d.sectionChromeIds=j()),o.push(d),d={pageIndex:o.length,blockIds:[],sectionChromeIds:[]},m=0,h=0,b=!1;continue}if(v.type==="back_cover"){w(),d.blockIds.length>0&&(o.push(d),d={pageIndex:o.length,blockIds:[],sectionChromeIds:[]},m=0,h=0,b=!1),d.blockIds.push(v.id),h=r;continue}if(ge.has(v.type)){w();const q=t.get(v.id)||40;d.blockIds.push(v.id),h+=q;continue}const _=gs(v),E=t.get(v.id)||30;g+_>1.01&&f.length>0&&w(),f.push(v.id),g+=_,p=Math.max(p,E),_>=1&&w()}return w(),(d.blockIds.length>0||d.sectionSeparatorId||o.length===0)&&(b||(d.sectionChromeIds=j()),o.push(d)),{pages:o,totalPages:o.length}},[l,a,t])}function js({block:l}){const a=l.config,t=a.title||"Informe de Mantenimiento",s=a.subtitle||"",r=a.showLogo!==!1,n=a.showDate!==!1,c=a.showReference!==!1,i=a.logoPosition||"left";return e.jsx("div",{className:"border-b pb-3 mb-2",children:e.jsxs("div",{className:`flex items-start gap-4 ${i==="right"?"flex-row-reverse":i==="center"?"flex-col items-center":""}`,children:[r&&e.jsx("div",{className:"flex h-14 w-14 shrink-0 items-center justify-center rounded-lg bg-gray-100 border border-dashed border-gray-300",children:e.jsx(D,{className:"h-6 w-6 text-gray-400"})}),e.jsxs("div",{className:`flex-1 ${i==="center"?"text-center":""}`,children:[e.jsx("h1",{className:"text-lg font-bold leading-tight",children:t}),s&&e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:s}),e.jsxs("div",{className:"flex gap-4 mt-2 text-[10px] text-gray-400",children:[n&&e.jsx("span",{children:"Fecha: ____/____/________"}),c&&e.jsx("span",{children:"Ref: __________"})]})]})]})})}const vs=[{value:"left",icon:Ae,label:"Izquierda"},{value:"center",icon:Te,label:"Centro"},{value:"right",icon:qe,label:"Derecha"}];function U({value:l,onChange:a}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Alineacion"}),e.jsx("div",{className:"flex gap-1",children:vs.map(t=>{const s=t.icon;return e.jsx("button",{className:`flex-1 flex items-center justify-center gap-1 rounded border px-2 py-1 text-xs ${l===t.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a(t.value),title:t.label,children:e.jsx(s,{className:"h-3.5 w-3.5"})},t.value)})})]})}function Ns({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Titulo"}),e.jsx(u,{value:t.title||"",onChange:s=>a("title",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Subtitulo"}),e.jsx(u,{value:t.subtitle||"",onChange:s=>a("subtitle",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showLogo",checked:t.showLogo!==!1,onChange:s=>a("showLogo",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:"showLogo",className:"text-xs cursor-pointer",children:"Mostrar logo"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Posicion del logo"}),e.jsx("div",{className:"flex gap-1",children:["left","center","right"].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.logoPosition||"left")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("logoPosition",s),children:s==="left"?"Izquierda":s==="center"?"Centro":"Derecha"},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"URL del logo"}),e.jsx(u,{value:t.logoUrl||"",onChange:s=>a("logoUrl",s.target.value),placeholder:"https://...",className:"h-8"})]}),e.jsx(U,{value:t.align||"left",onChange:s=>a("align",s)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showDate",checked:t.showDate!==!1,onChange:s=>a("showDate",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:"showDate",className:"text-xs cursor-pointer",children:"Mostrar fecha"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showReference",checked:t.showReference!==!1,onChange:s=>a("showReference",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:"showReference",className:"text-xs cursor-pointer",children:"Mostrar referencia"})]})]})}C({definition:k.header,EditorPreview:js,ConfigPanel:Ns});const G=[{key:"componente.etiqueta",label:"Nombre del componente",example:"Robot 1",category:"componente"},{key:"componente.tipo",label:"Tipo de componente",example:"mechanical_unit",category:"componente"},{key:"componente.numero_serie",label:"Numero de serie",example:"SN-2024-001",category:"componente"},{key:"componente.num_ejes",label:"Numero de ejes",example:"6",category:"componente"},{key:"componente.modelo",label:"Modelo del componente",example:"IRB 6700",category:"componente"},{key:"sistema.nombre",label:"Nombre del sistema",example:"Celula soldadura L1",category:"sistema"},{key:"sistema.descripcion",label:"Descripcion del sistema",example:"Celula de soldadura linea 1",category:"sistema"},{key:"sistema.fabricante",label:"Fabricante del sistema",example:"ABB",category:"sistema"},{key:"cliente.nombre",label:"Nombre del cliente",example:"Empresa S.A.",category:"cliente"},{key:"cliente.planta",label:"Planta",example:"Planta Barcelona",category:"cliente"},{key:"cliente.maquina",label:"Maquina",example:"Maquina 3",category:"cliente"},{key:"intervencion.actividad",label:"Actividad",example:"Mantenimiento preventivo",category:"intervencion"},{key:"intervencion.fecha",label:"Fecha de intervencion",example:"22/02/2026",category:"intervencion"},{key:"intervencion.referencia",label:"Referencia / OT",example:"OT-2026-0042",category:"intervencion"}],ys=[{id:"componente",label:"Componente"},{id:"sistema",label:"Sistema"},{id:"cliente",label:"Cliente"},{id:"intervencion",label:"Intervencion"}],ve=/\{\{([a-z_]+\.[a-z_]+)\}\}/g;function ws(l,a){return l.replace(ve,(t,s)=>a[s]??`[${s}]`)}function z(l){const a={};for(const t of G)a[t.key]=t.example;return ws(l,a)}function ks(l){const a=[];let t;const s=new RegExp(ve.source,"g");for(;(t=s.exec(l))!==null;)t[1]&&!a.includes(t[1])&&a.push(t[1]);return a}function Cs({block:l}){const a=l.config,t=z(a.title||""),s=z(a.description||""),r=a.level||1,n=a.color||"#2563eb",c={1:"text-base font-bold",2:"text-sm font-semibold",3:"text-xs font-semibold"};return e.jsxs("div",{className:"flex items-start gap-2 py-2",children:[e.jsx("div",{className:"w-1 shrink-0 rounded-full self-stretch",style:{backgroundColor:n}}),e.jsxs("div",{children:[e.jsx("div",{className:c[r]||c[1],children:t}),s&&e.jsx("p",{className:"text-[10px] text-gray-400 mt-0.5",children:s})]})]})}function K({value:l,onChange:a,placeholder:t,className:s}){const[r,n]=$.useState(!1),[c,i]=$.useState(!1),o=$.useRef(null),d=ks(l),m=d.length>0,h=g=>{const p=`{{${g}}}`,f=o.current;if(f){const N=f.selectionStart??l.length,b=f.selectionEnd??l.length,S=l.slice(0,N)+p+l.slice(b);a(S),setTimeout(()=>{const j=N+p.length;f.setSelectionRange(j,j),f.focus()},0)}else a(l+p);n(!1)};return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{ref:o,value:l,onChange:g=>a(g.target.value),placeholder:t,className:`h-8 flex-1 ${s??""}`}),m&&e.jsx(I,{type:"button",variant:c?"default":"outline",size:"icon",className:"h-8 w-8 shrink-0",title:"Ver variables usadas",onClick:()=>i(!c),children:e.jsx(Ue,{className:"h-3.5 w-3.5"})}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{type:"button",variant:"outline",size:"icon",className:"h-8 w-8 shrink-0",title:"Insertar variable dinamica",onClick:()=>n(!r),children:e.jsx(Z,{className:"h-3.5 w-3.5"})}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>n(!1)}),e.jsx("div",{className:"absolute right-0 top-full mt-1 z-50 w-72 max-h-64 overflow-y-auto rounded-md border bg-white shadow-lg",children:ys.map(g=>{const p=G.filter(f=>f.category===g.id);return p.length===0?null:e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-1.5 text-[10px] font-semibold text-gray-400 uppercase tracking-wider bg-gray-50 border-b",children:g.label}),p.map(f=>{const N=d.includes(f.key);return e.jsxs("button",{type:"button",className:`w-full text-left px-3 py-1.5 transition-colors flex items-center justify-between gap-2 ${N?"bg-blue-50 hover:bg-blue-100":"hover:bg-gray-50"}`,onClick:()=>h(f.key),children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-medium flex items-center gap-1.5",children:[f.label,N&&e.jsx("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-blue-500"})]}),e.jsx("div",{className:"text-[10px] text-gray-400 font-mono",children:`{{${f.key}}}`})]}),e.jsx("span",{className:"text-[10px] text-gray-300 italic shrink-0",children:f.example})]},f.key)})]},g.id)})})]})]})]}),m&&c&&e.jsxs("div",{className:"rounded-md border border-blue-200 bg-blue-50/50 p-2 space-y-1.5",children:[e.jsxs("div",{className:"text-[11px] text-blue-700 font-medium",children:[e.jsx("span",{className:"text-blue-400 text-[10px] mr-1",children:"Vista previa:"}),z(l)]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:d.map(g=>{const p=G.find(f=>f.key===g);return e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-blue-100 text-[10px] text-blue-700",title:p?`${p.label} → ${p.example}`:g,children:[e.jsx(Z,{className:"h-2.5 w-2.5"}),e.jsx("span",{className:"font-medium",children:(p==null?void 0:p.label)??g}),e.jsxs("span",{className:"text-blue-400",children:["= ",(p==null?void 0:p.example)??"?"]})]},g)})})]})]})}function _s({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Titulo"}),e.jsx(K,{value:t.title||"",onChange:s=>a("title",s),placeholder:"Ej: Control de {{componente.etiqueta}}"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Descripcion"}),e.jsx(K,{value:t.description||"",onChange:s=>a("description",s),placeholder:"Opcional"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Nivel"}),e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(s=>e.jsxs("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.level||1)===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("level",s),children:["Nivel ",s]},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.color||"#2563eb",onChange:s=>a("color",s.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:t.color||"#2563eb",onChange:s=>a("color",s.target.value),className:"h-8 font-mono text-xs flex-1"})]})]}),e.jsx(U,{value:t.align||"left",onChange:s=>a("align",s)})]})}C({definition:k.section_title,EditorPreview:Cs,ConfigPanel:_s});function Ss({block:l}){const a=l.config,t=a.style||"solid",s=a.spacing||"medium",r=a.color||"#e5e7eb",n={small:"py-1",medium:"py-3",large:"py-5"};if(t==="space")return e.jsx("div",{className:n[s]||n.medium});const c=t==="dashed"?"dashed":t==="dotted"?"dotted":"solid";return e.jsx("div",{className:n[s]||n.medium,children:e.jsx("hr",{style:{borderTopStyle:c,borderTopColor:r,borderTopWidth:"1px"},className:"border-0"})})}function Ps({block:l,onChange:a}){const t=l.config,s=[{value:"solid",label:"Solido"},{value:"dashed",label:"Discontinuo"},{value:"dotted",label:"Punteado"},{value:"space",label:"Espacio"}],r=[{value:"small",label:"Pequeno"},{value:"medium",label:"Mediano"},{value:"large",label:"Grande"}];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Estilo"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:s.map(n=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.style||"solid")===n.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("style",n.value),children:n.label},n.value))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Espaciado"}),e.jsx("div",{className:"flex gap-1",children:r.map(n=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.spacing||"medium")===n.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("spacing",n.value),children:n.label},n.value))})]}),e.jsx(U,{value:t.align||"left",onChange:n=>a("align",n)}),t.style!=="space"&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.color||"#e5e7eb",onChange:n=>a("color",n.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:t.color||"#e5e7eb",onChange:n=>a("color",n.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})]})}C({definition:k.divider,EditorPreview:Ss,ConfigPanel:Ps});function $s({block:l}){const a=l.config.title||"Tabla de contenidos",t=X(o=>o.blocks),s=X(o=>o.pageConfig),r=X(o=>o.blockHeights),{pages:n}=bs({blocks:t,pageConfig:s,blockHeights:r}),c=new Map;for(const o of n)for(const d of o.blockIds)c.set(d,o.pageIndex+1);const i=t.filter(o=>o.type==="section_title").map((o,d)=>({number:d+1,title:o.config.title||"",level:o.config.level||1,pageNumber:c.get(o.id)??"—"}));return e.jsxs("div",{className:"py-4 px-2",children:[e.jsx("h3",{className:"text-base font-bold mb-4",children:a}),i.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("p",{className:"text-xs italic",children:"No hay titulos de seccion en la plantilla"})]}):e.jsx("div",{className:"space-y-2 pl-4 pr-2",children:i.map(o=>e.jsxs("div",{className:"flex items-baseline gap-2",style:{paddingLeft:o.level>1?`${(o.level-1)*16}px`:0},children:[e.jsx("span",{className:"font-semibold text-sm shrink-0 w-5 text-right",children:o.number}),e.jsx("span",{className:"font-medium text-sm truncate",children:o.title}),e.jsx("span",{className:"flex-1 border-b border-dotted border-gray-300 min-w-[20px] self-end mb-0.5"}),e.jsx("span",{className:"text-sm text-muted-foreground shrink-0 font-medium",children:o.pageNumber})]},o.number))})]})}function Is({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Titulo"}),e.jsx(u,{value:t.title||"",onChange:s=>a("title",s.target.value),className:"h-8"})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Este bloque genera automaticamente un indice con todos los titulos de seccion de la plantilla y sus numeros de pagina."})]})}C({definition:k.table_of_contents,EditorPreview:$s,ConfigPanel:Is});function F({block:l,children:a}){const t=l.config,s=t.label||"",r=!!t.required,n=t.helpText||"";return e.jsx("div",{className:"py-1",children:e.jsxs("div",{className:"space-y-1",children:[(s||r)&&e.jsxs("div",{className:"text-xs font-medium text-gray-700",children:[s,r&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),a,n&&e.jsx("div",{className:"text-[10px] text-gray-400",children:n})]})})}function Es({block:l}){const a=l.config.placeholder||"";return e.jsx(F,{block:l,children:e.jsx("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center",children:a&&e.jsx("span",{className:"text-[10px] text-gray-300",children:a})})})}function B({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(u,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Etiqueta"}),e.jsx(u,{value:t.label||"",onChange:s=>a("label",s.target.value),placeholder:"Etiqueta del campo",className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${l.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded border-gray-300"}),e.jsx(x,{htmlFor:`required-${l.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(Y).map(([s,r])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${t.width===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:r},s))})]}),e.jsx(U,{value:t.align||"left",onChange:s=>a("align",s)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Texto de ayuda"}),e.jsx(u,{value:t.helpText||"",onChange:s=>a("helpText",s.target.value),placeholder:"Opcional",className:"h-8"})]})]})}function Ts({block:l,onChange:a}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{block:l,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Placeholder"}),e.jsx(u,{value:l.config.placeholder||"",onChange:t=>a("placeholder",t.target.value),placeholder:"Texto de ejemplo...",className:"h-8"})]})]})}function Ms({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Campo",c=r.placeholder||"",i=!!r.required,o=r.helpText||"";return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(x,{children:[n,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(u,{value:a??"",onChange:d=>t(d.target.value||null),placeholder:c,readOnly:s,disabled:s}),o&&e.jsx("p",{className:"text-xs text-muted-foreground",children:o})]})}C({definition:k.text_field,EditorPreview:Es,ConfigPanel:Ts,FormField:Ms});function As({block:l}){const a=l.config,t=a.unit||"",s=a.min,r=a.max;return e.jsxs(F,{block:l,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-7 flex-1 rounded border border-gray-200 bg-gray-50 px-2 flex items-center",children:e.jsx("span",{className:"text-[10px] text-gray-300",children:"0"})}),t&&e.jsx("span",{className:"shrink-0 rounded bg-gray-100 px-1.5 py-1 text-[10px] font-medium text-gray-500",children:t})]}),(s!==null||r!==null)&&e.jsxs("div",{className:"text-[9px] text-gray-300 mt-0.5",children:[s!==null&&`Min: ${s}`,s!==null&&r!==null&&" · ",r!==null&&`Max: ${r}`]})]})}function Rs({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{block:l,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Unidad"}),e.jsx(u,{value:t.unit||"",onChange:s=>a("unit",s.target.value),placeholder:"mm, V, A, bar...",className:"h-8"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Minimo"}),e.jsx(u,{type:"number",value:t.min!==null&&t.min!==void 0?String(t.min):"",onChange:s=>a("min",s.target.value?Number(s.target.value):null),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Maximo"}),e.jsx(u,{type:"number",value:t.max!==null&&t.max!==void 0?String(t.max):"",onChange:s=>a("max",s.target.value?Number(s.target.value):null),className:"h-8"})]})]})]})]})}function qs({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Campo numerico",c=r.unit||"",i=!!r.required,o=r.helpText||"",d=r.min,m=r.max;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(x,{children:[n,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{type:"number",value:a!=null?String(a):"",onChange:h=>{const g=h.target.value;t(g===""?null:Number(g))},readOnly:s,disabled:s,min:d??void 0,max:m??void 0}),c&&e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:c})]}),o&&e.jsx("p",{className:"text-xs text-muted-foreground",children:o})]})}C({definition:k.number_field,EditorPreview:As,ConfigPanel:Rs,FormField:qs});function Ds({block:l}){return e.jsx(F,{block:l,children:e.jsxs("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-gray-300",children:"DD/MM/AAAA"}),e.jsx(Be,{className:"h-3 w-3 text-gray-300"})]})})}function Fs({block:l,onChange:a}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{block:l,onChange:a}),e.jsx("p",{className:"text-[10px] text-muted-foreground border-t pt-2",children:"Este campo no tiene configuracion adicional."})]})}function Bs({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Fecha",c=!!r.required,i=r.helpText||"";return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(x,{children:[n,c&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(u,{type:"date",value:a??"",onChange:o=>t(o.target.value||null),readOnly:s,disabled:s}),i&&e.jsx("p",{className:"text-xs text-muted-foreground",children:i})]})}C({definition:k.date_field,EditorPreview:Ds,ConfigPanel:Fs,FormField:Bs});function Ls({block:l}){const a=l.config,t=a.rows||3,s=a.placeholder||"";return e.jsx(F,{block:l,children:e.jsx("div",{className:"rounded border border-gray-200 bg-gray-50 px-2 py-1",style:{minHeight:`${t*18}px`},children:s&&e.jsx("span",{className:"text-[10px] text-gray-300",children:s})})})}function zs({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{block:l,onChange:a}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Filas visibles"}),e.jsx(u,{type:"number",min:2,max:10,value:t.rows||3,onChange:s=>a("rows",Math.max(2,Math.min(10,Number(s.target.value)||3))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Placeholder"}),e.jsx(u,{value:t.placeholder||"",onChange:s=>a("placeholder",s.target.value),placeholder:"Texto de ejemplo...",className:"h-8"})]})]})]})}function Hs({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Area de texto",c=r.placeholder||"",i=!!r.required,o=r.helpText||"",d=r.rows||3;return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(x,{children:[n,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx(xe,{value:a??"",onChange:m=>t(m.target.value||null),placeholder:c,readOnly:s,disabled:s,rows:d}),o&&e.jsx("p",{className:"text-xs text-muted-foreground",children:o})]})}C({definition:k.text_area,EditorPreview:Ls,ConfigPanel:zs,FormField:Hs});function Us({block:l}){const a=l.config.options||[];return e.jsx(F,{block:l,children:e.jsxs("div",{className:"h-7 rounded border border-gray-200 bg-gray-50 px-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-[10px] text-gray-300",children:a.length>0?`${a.length} opciones`:"Sin opciones"}),e.jsx(Ce,{className:"h-3 w-3 text-gray-300"})]})})}function Os({options:l,onChange:a}){const t=()=>{const n=l.length+1;a([...l,{value:`opcion_${n}`,label:`Opcion ${n}`}])},s=n=>{a(l.filter((c,i)=>i!==n))},r=(n,c,i)=>{const o=l.map((d,m)=>m===n?{...d,[c]:i}:d);a(o)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-xs",children:"Opciones"}),l.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin opciones definidas"}),l.map((n,c)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{value:n.value,onChange:i=>{const o=i.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();r(c,"value",o)},placeholder:"valor",className:"h-7 text-xs font-mono flex-1"}),e.jsx(u,{value:n.label,onChange:i=>r(c,"label",i.target.value),placeholder:"Etiqueta",className:"h-7 text-xs flex-1"}),e.jsx("button",{onClick:()=>s(c),className:"shrink-0 rounded p-1 text-muted-foreground hover:text-destructive hover:bg-destructive/10",children:e.jsx(A,{className:"h-3 w-3"})})]},c)),e.jsxs(I,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Anadir opcion"]})]})}function Xs({block:l,onChange:a}){const t=l.config.options||[];return e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{block:l,onChange:a}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(Os,{options:t,onChange:s=>a("options",s)})})]})}function Vs({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Selector",c=!!r.required,i=r.helpText||"",o=r.options??[];return e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs(x,{children:[n,c&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("select",{value:a??"",onChange:d=>t(d.target.value||null),disabled:s,className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Seleccionar..."}),o.map(d=>e.jsx("option",{value:d.value,children:d.label},d.value))]}),i&&e.jsx("p",{className:"text-xs text-muted-foreground",children:i})]})}C({definition:k.select_field,EditorPreview:Us,ConfigPanel:Xs,FormField:Vs});function Gs({block:l}){const a=l.config,t=a.label||"",s=a.withObservation!==!1,r=a.maintenanceLevel||"general",n=!!a.required;return e.jsxs("div",{className:"py-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`shrink-0 rounded px-1.5 py-0.5 text-[9px] font-medium ${is[r]}`,children:be[r]}),e.jsxs("span",{className:"flex-1 text-xs font-medium",children:[t,n&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"rounded border border-green-200 bg-green-50 px-2 py-0.5 text-[9px] font-medium text-green-600",children:"OK"}),e.jsx("span",{className:"rounded border border-red-200 bg-red-50 px-2 py-0.5 text-[9px] font-medium text-red-600",children:"NOK"}),e.jsx("span",{className:"rounded border border-gray-200 bg-gray-50 px-2 py-0.5 text-[9px] font-medium text-gray-500",children:"N/A"})]})]}),s&&e.jsx("div",{className:"mt-1 ml-16",children:e.jsx("div",{className:"h-5 rounded border border-dashed border-gray-200 bg-gray-50/50 px-2 flex items-center",children:e.jsx("span",{className:"text-[9px] text-gray-300",children:"Observaciones..."})})})]})}function Ks({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(u,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Etiqueta"}),e.jsx(u,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Nivel de mantenimiento"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(be).map(([s,r])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.maintenanceLevel||"general")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("maintenanceLevel",s),children:r},s))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`withObs-${l.id}`,checked:t.withObservation!==!1,onChange:s=>a("withObservation",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:`withObs-${l.id}`,className:"text-xs cursor-pointer",children:"Con campo de observaciones"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${l.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:`required-${l.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]})]})}const Ws=[{key:"ok",label:"OK",activeClass:"bg-green-600 text-white border-green-600"},{key:"nok",label:"NOK",activeClass:"bg-red-600 text-white border-red-600"},{key:"na",label:"N/A",activeClass:"bg-gray-500 text-white border-gray-500"}];function Ys({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Punto de inspeccion",c=r.withObservation!==!1,i=!!r.required,o=a??{valor:null,observacion:""},d=h=>{s||t({...o,valor:o.valor===h?null:h})},m=h=>{s||t({...o,observacion:h})};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs(x,{className:"flex-1",children:[n,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx("div",{className:"flex gap-1",children:Ws.map(h=>e.jsx("button",{type:"button",onClick:()=>d(h.key),disabled:s,className:`px-3 py-1 text-xs font-semibold rounded border transition-colors ${o.valor===h.key?h.activeClass:"border-gray-300 text-gray-500 hover:border-gray-400"} disabled:opacity-50 disabled:cursor-not-allowed`,children:h.label},h.key))})]}),c&&e.jsx(xe,{value:o.observacion,onChange:h=>m(h.target.value),placeholder:"Observaciones...",rows:2,readOnly:s,disabled:s,className:"text-sm"})]})}C({definition:k.tristate,EditorPreview:Gs,ConfigPanel:Ks,FormField:Ys});function Js({block:l}){const a=l.config,t=a.label||"",s=a.items||[],r=a.layout||"vertical";return e.jsxs("div",{className:"py-1",children:[t&&e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),s.length===0?e.jsx("div",{className:"text-[10px] text-gray-300 italic",children:"Sin items definidos"}):r==="horizontal"?e.jsx("div",{className:"flex flex-wrap gap-x-4 gap-y-0.5",children:s.map((n,c)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Q,{className:"h-3 w-3 text-gray-300 shrink-0"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:n.label})]},c))}):e.jsx("div",{className:"space-y-0.5",children:s.map((n,c)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Q,{className:"h-3 w-3 text-gray-300 shrink-0"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:n.label})]},c))})]})}function Zs({items:l,onChange:a}){const t=()=>{const n=l.length+1;a([...l,{key:`item_${n}`,label:`Item ${n}`}])},s=n=>{a(l.filter((c,i)=>i!==n))},r=(n,c,i)=>{const o=l.map((d,m)=>m===n?{...d,[c]:i}:d);a(o)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-xs",children:"Items"}),l.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin items definidos"}),l.map((n,c)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{value:n.key,onChange:i=>{const o=i.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();r(c,"key",o)},placeholder:"clave",className:"h-7 text-xs font-mono flex-1"}),e.jsx(u,{value:n.label,onChange:i=>r(c,"label",i.target.value),placeholder:"Etiqueta",className:"h-7 text-xs flex-1"}),e.jsx("button",{onClick:()=>s(c),className:"shrink-0 rounded p-1 text-muted-foreground hover:text-destructive hover:bg-destructive/10",children:e.jsx(A,{className:"h-3 w-3"})})]},c)),e.jsxs(I,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Anadir item"]})]})}function Qs({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(u,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Etiqueta"}),e.jsx(u,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Disposicion de items"}),e.jsx("div",{className:"flex gap-1",children:[{value:"vertical",label:"Vertical"},{value:"horizontal",label:"Horizontal"}].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.layout||"vertical")===s.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("layout",s.value),children:s.label},s.value))})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(Zs,{items:t.items||[],onChange:s=>a("items",s)})})]})}function ea({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Lista de verificacion",c=r.items||[],i=!!r.required,o=a??[],d=m=>{if(s)return;const h=o.includes(m)?o.filter(g=>g!==m):[...o,m];t(h)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{children:[n,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),c.length===0?e.jsx("p",{className:"text-xs text-muted-foreground italic",children:"Sin items definidos"}):e.jsx("div",{className:"space-y-1.5",children:c.map(m=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",checked:o.includes(m.key),onChange:()=>d(m.key),disabled:s,className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("span",{className:"text-sm text-gray-700",children:m.label})]},m.key))})]})}C({definition:k.checklist,EditorPreview:Js,ConfigPanel:Qs,FormField:ea});function Ne({col:l,value:a}){const t=String(a??"");switch(l.type){case"checkbox":return e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`h-3 w-3 rounded-sm border ${t==="true"?"bg-primary border-primary":"border-gray-300"}`})});case"tristate":{const s=t||null;return e.jsx("div",{className:"flex gap-0.5 justify-center",children:["OK","NOK","NA"].map(r=>e.jsx("span",{className:`px-1 rounded text-[8px] font-medium ${s===r?r==="OK"?"bg-green-100 text-green-700":r==="NOK"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-500":"text-gray-300"}`,children:r},r))})}case"select":return e.jsx("span",{className:"text-gray-400 italic",children:t||"Seleccionar..."});default:return e.jsx("span",{className:"text-gray-500",children:t})}}function sa({columns:l,fixedRows:a,headerBg:t,headerColor:s,cellPad:r,allowAddRows:n}){const c=a.slice(0,3),i=a.length>3?a.length-3:0;return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"w-full text-[10px]",children:[e.jsx("thead",{children:e.jsx("tr",{style:{backgroundColor:t},children:l.map(o=>e.jsx("th",{className:`${r} text-left font-medium`,style:{width:o.width!=="auto"?o.width:void 0,color:s},children:o.label},o.key))})}),e.jsx("tbody",{children:c.length>0?c.map((o,d)=>e.jsx("tr",{className:d%2===1?"bg-gray-50":"",children:l.map(m=>e.jsx("td",{className:r,children:e.jsx(Ne,{col:m,value:o[m.key]})},m.key))},d)):e.jsx("tr",{children:l.map(o=>e.jsx("td",{className:r,children:e.jsx("div",{className:"h-3 bg-gray-100 rounded"})},o.key))})})]}),i>0&&e.jsxs("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[9px] text-gray-400 text-center",children:["y ",i," mas..."]}),n&&e.jsx("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[9px] text-gray-400 text-center italic",children:"+ filas dinamicas"})]})}function aa({columns:l,fixedRows:a,headerBg:t,headerColor:s,cellPad:r}){const n=a.length>0?a.length:1,c=Math.min(n,3);return e.jsx("table",{className:"w-full text-[10px]",children:e.jsx("tbody",{children:l.map((i,o)=>e.jsxs("tr",{className:o%2===1?"bg-gray-50":"",children:[e.jsx("th",{className:`${r} text-left font-medium whitespace-nowrap`,style:{backgroundColor:t,color:s,width:"35%"},children:i.label}),Array.from({length:c}).map((d,m)=>{const h=a[m];return e.jsx("td",{className:r,children:h?e.jsx(Ne,{col:i,value:h[i.key]}):e.jsx("div",{className:"h-3 bg-gray-100 rounded"})},m)})]},i.key))})})}function ta({block:l}){const a=l.config,t=a.label||"",s=z(a.title||""),r=a.titleBg||"#1f2937",n=a.titleColor||"#ffffff",c=a.columns||[],i=a.fixedRows||[],o=a.allowAddRows!==!1,d=a.headerBg||"#1f2937",m=a.headerColor||"#ffffff",h=!!a.compact,g=a.headerPosition||"top";if(c.length===0)return e.jsxs("div",{className:"py-2",children:[t&&e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsx("div",{className:"rounded border border-dashed border-gray-200 p-4 text-center text-[10px] text-gray-300",children:"Sin columnas definidas"})]});const p=h?"px-1.5 py-0.5":"px-2 py-1";return e.jsxs("div",{className:"py-2",children:[t&&e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsxs("div",{className:"rounded border overflow-hidden",children:[s&&e.jsx("div",{className:"px-3 py-1.5 text-[11px] font-semibold",style:{backgroundColor:r,color:n},children:s}),g==="left"?e.jsx(aa,{columns:c,fixedRows:i,headerBg:d,headerColor:m,cellPad:p}):e.jsx(sa,{columns:c,fixedRows:i,headerBg:d,headerColor:m,cellPad:p,allowAddRows:o})]})]})}const la=[{value:"text",label:"Texto"},{value:"number",label:"Numero"},{value:"date",label:"Fecha"},{value:"checkbox",label:"Checkbox"},{value:"tristate",label:"Tristate"},{value:"select",label:"Selector"}];function ra({columns:l,onChange:a}){const t=()=>{const n=l.length+1;a([...l,{key:`col_${n}`,label:`Columna ${n}`,type:"text",width:"auto"}])},s=n=>{a(l.filter((c,i)=>i!==n))},r=(n,c,i)=>{const o=l.map((d,m)=>m===n?{...d,[c]:i}:d);a(o)};return e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-xs",children:"Columnas"}),l.length===0&&e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Sin columnas definidas"}),l.map((n,c)=>e.jsxs("div",{className:"rounded border p-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] font-medium text-muted-foreground",children:["Columna ",c+1]}),e.jsx("button",{onClick:()=>s(c),className:"rounded p-0.5 text-muted-foreground hover:text-destructive",children:e.jsx(A,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsx(u,{value:n.key,onChange:i=>{const o=i.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();r(c,"key",o)},placeholder:"clave",className:"h-6 text-[10px] font-mono"}),e.jsx(u,{value:n.label,onChange:i=>r(c,"label",i.target.value),placeholder:"Etiqueta",className:"h-6 text-[10px]"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("select",{value:n.type,onChange:i=>r(c,"type",i.target.value),className:"h-6 flex-1 rounded border text-[10px] px-1",children:la.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))}),e.jsx(u,{value:n.width,onChange:i=>r(c,"width",i.target.value),placeholder:"auto",className:"h-6 w-16 text-[10px]",title:"Ancho (auto, 100px, 20%, etc.)"})]}),n.type==="select"&&e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"Opciones (una por linea)"}),e.jsx("textarea",{value:(n.options||[]).join(`
`),onChange:i=>{const o=i.target.value.split(`
`).filter(d=>d.trim());r(c,"options",o)},placeholder:`Opcion 1
Opcion 2`,className:"w-full rounded border text-[10px] px-1 py-0.5 resize-none",rows:3})]})]},c)),e.jsxs(I,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:t,children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Anadir columna"]})]})}function na({columns:l,rows:a,onChange:t}){if(l.length===0)return e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Filas fijas"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Define columnas primero para poder anadir filas fijas."})]});const s=()=>{const c={};l.forEach(i=>{c[i.key]=""}),t([...a,c])},r=c=>{t(a.filter((i,o)=>o!==c))},n=(c,i,o)=>{const d=a.map((m,h)=>h===c?{...m,[i]:o}:m);t(d)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-xs",children:["Filas fijas (",a.length,")"]}),a.length>0&&e.jsx("div",{className:"rounded border overflow-x-auto",children:e.jsxs("table",{className:"w-full text-[10px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted/50",children:[l.map(c=>e.jsx("th",{className:"px-1.5 py-1 text-left font-medium",children:c.label},c.key)),e.jsx("th",{className:"w-6"})]})}),e.jsx("tbody",{children:a.map((c,i)=>e.jsxs("tr",{className:"border-t",children:[l.map(o=>e.jsx("td",{className:"px-0.5 py-0.5",children:e.jsx(u,{value:String(c[o.key]||""),onChange:d=>n(i,o.key,d.target.value),className:"h-5 text-[10px] border-0 bg-transparent px-1"})},o.key)),e.jsx("td",{className:"px-0.5",children:e.jsx("button",{onClick:()=>r(i),className:"rounded p-0.5 text-muted-foreground hover:text-destructive",children:e.jsx(A,{className:"h-2.5 w-2.5"})})})]},i))})]})}),e.jsxs(I,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:s,children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Anadir fila fija"]})]})}function ca({block:l,onChange:a}){const t=l.config,s=t.columns||[],r=t.headerPosition||"top";return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(u,{value:t.key||"",onChange:n=>{const c=n.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",c)},placeholder:"nombre_tabla",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Etiqueta"}),e.jsx(u,{value:t.label||"",onChange:n=>a("label",n.target.value),className:"h-8"})]}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsx(x,{className:"text-xs font-semibold",children:"Titulo de tabla"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Texto del titulo"}),e.jsx(K,{value:t.title||"",onChange:n=>a("title",n),placeholder:"Ej: Control general de {{componente.etiqueta}}"})]}),t.title&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Fondo titulo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.titleBg||"#1f2937",onChange:n=>a("titleBg",n.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:t.titleBg||"#1f2937",onChange:n=>a("titleBg",n.target.value),className:"h-8 font-mono text-xs flex-1"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Color texto titulo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.titleColor||"#ffffff",onChange:n=>a("titleColor",n.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:t.titleColor||"#ffffff",onChange:n=>a("titleColor",n.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})]})]}),e.jsxs("div",{className:"border-t pt-3 space-y-2",children:[e.jsx(x,{className:"text-xs font-semibold",children:"Posicion de cabecera"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:`flex-1 flex items-center gap-2 p-2 rounded-md border cursor-pointer transition-colors ${r==="top"?"border-blue-400 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:`headerPos-${l.id}`,value:"top",checked:r==="top",onChange:()=>a("headerPosition","top"),className:"h-3.5 w-3.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium",children:"Superior"}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"Cabecera horizontal"})]})]}),e.jsxs("label",{className:`flex-1 flex items-center gap-2 p-2 rounded-md border cursor-pointer transition-colors ${r==="left"?"border-blue-400 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:`headerPos-${l.id}`,value:"left",checked:r==="left",onChange:()=>a("headerPosition","left"),className:"h-3.5 w-3.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium",children:"Lateral"}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:"Cabecera a la izquierda"})]})]})]})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(ra,{columns:s,onChange:n=>a("columns",n)})}),e.jsx("div",{className:"border-t pt-3",children:e.jsx(na,{columns:s,rows:t.fixedRows||[],onChange:n=>a("fixedRows",n)})}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsx(x,{className:"text-xs font-semibold",children:"Estilo de tabla"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Fondo cabecera"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.headerBg||"#1f2937",onChange:n=>a("headerBg",n.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:t.headerBg||"#1f2937",onChange:n=>a("headerBg",n.target.value),className:"h-8 font-mono text-xs flex-1"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Texto cabecera"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.headerColor||"#ffffff",onChange:n=>a("headerColor",n.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:t.headerColor||"#ffffff",onChange:n=>a("headerColor",n.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`compact-${l.id}`,checked:!!t.compact,onChange:n=>a("compact",n.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:`compact-${l.id}`,className:"text-xs cursor-pointer",children:"Compacta (padding reducido)"})]})]}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`allowAdd-${l.id}`,checked:t.allowAddRows!==!1,onChange:n=>a("allowAddRows",n.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:`allowAdd-${l.id}`,className:"text-xs cursor-pointer",children:"Permitir anadir filas"})]}),t.allowAddRows!==!1&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Min filas"}),e.jsx(u,{type:"number",min:0,value:t.minRows||0,onChange:n=>a("minRows",Math.max(0,Number(n.target.value)||0)),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Max filas"}),e.jsx(u,{type:"number",min:1,value:t.maxRows||50,onChange:n=>a("maxRows",Math.max(1,Number(n.target.value)||50)),className:"h-8"})]})]})]})]})}function ye({col:l,value:a,onChange:t,readOnly:s}){switch(l.type){case"checkbox":return e.jsx("div",{className:"flex justify-center py-1",children:e.jsx("input",{type:"checkbox",checked:a===!0||a==="true",onChange:r=>t(r.target.checked),disabled:s,className:"h-4 w-4 rounded border-gray-300"})});case"tristate":{const r=a,n=[{label:"OK",color:"text-gray-400 border-gray-200",activeColor:"bg-green-100 text-green-700 border-green-300"},{label:"NOK",color:"text-gray-400 border-gray-200",activeColor:"bg-red-100 text-red-700 border-red-300"},{label:"NA",color:"text-gray-400 border-gray-200",activeColor:"bg-gray-100 text-gray-600 border-gray-300"}];return e.jsx("div",{className:"flex gap-0.5 justify-center py-0.5",children:n.map(c=>e.jsx("button",{type:"button",disabled:s,className:`px-1.5 py-0.5 rounded border text-[11px] font-medium transition-colors ${r===c.label?c.activeColor:c.color} ${s?"cursor-default":"cursor-pointer hover:opacity-80"}`,onClick:()=>{s||t(r===c.label?null:c.label)},children:c.label},c.label))})}case"select":{const r=l.options||[];return e.jsxs("select",{value:String(a??""),onChange:n=>t(n.target.value||null),disabled:s,className:"h-8 w-full rounded border-0 bg-transparent text-sm px-1 focus:ring-1 focus:ring-primary",children:[e.jsx("option",{value:"",children:"—"}),r.map(n=>e.jsx("option",{value:n,children:n},n))]})}case"date":return e.jsx(u,{type:"date",value:String(a??""),onChange:r=>t(r.target.value||null),readOnly:s,disabled:s,className:"h-8 text-sm border-0 bg-transparent focus-visible:ring-1 px-1"});default:return e.jsx(u,{type:l.type==="number"?"number":"text",value:String(a??""),onChange:r=>t(r.target.value||null),readOnly:s,disabled:s,className:"h-8 text-sm border-0 bg-transparent focus-visible:ring-1 px-1"})}}function oa({columns:l,rows:a,headerBg:t,headerColor:s,cellPad:r,allowAddRows:n,readOnly:c,updateCell:i,removeRow:o}){return e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:t},children:[l.map(d=>e.jsx("th",{className:`${r} text-left text-xs font-medium`,style:{width:d.width!=="auto"?d.width:void 0,color:s},children:d.label},d.key)),!c&&n&&e.jsx("th",{className:`${r} w-10`})]})}),e.jsx("tbody",{children:a.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:l.length+(!c&&n?1:0),className:"px-3 py-4 text-center text-xs text-gray-400 italic",children:["Sin datos. ",n&&!c&&"Pulsa + para anadir una fila."]})}):a.map((d,m)=>e.jsxs("tr",{className:m%2===1?"bg-gray-50":"bg-white",children:[l.map(h=>e.jsx("td",{className:r,children:e.jsx(ye,{col:h,value:d[h.key],onChange:g=>i(m,h.key,g),readOnly:!!c})},h.key)),!c&&n&&e.jsx("td",{className:"px-1 py-1 text-center",children:e.jsx(I,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7 text-gray-400 hover:text-red-500",onClick:()=>o(m),children:e.jsx(A,{className:"h-3.5 w-3.5"})})})]},m))})]})}function ia({columns:l,rows:a,headerBg:t,headerColor:s,cellPad:r,readOnly:n,updateCell:c}){const i=Math.max(a.length,1);return e.jsx("table",{className:"w-full text-sm",children:e.jsx("tbody",{children:l.map((o,d)=>e.jsxs("tr",{className:d%2===1?"bg-gray-50":"bg-white",children:[e.jsx("th",{className:`${r} text-left text-xs font-medium whitespace-nowrap`,style:{backgroundColor:t,color:s,width:"35%"},children:o.label}),a.length===0?e.jsx("td",{className:r,children:e.jsx("span",{className:"text-xs text-gray-400 italic",children:"Sin datos"})}):a.map((m,h)=>e.jsx("td",{className:r,style:{width:`${65/i}%`},children:e.jsx(ye,{col:o,value:m[o.key],onChange:g=>c(h,o.key,g),readOnly:!!n})},h))]},o.key))})})}function da({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Tabla",c=r.title||"",i=r.titleBg||"#1f2937",o=r.titleColor||"#ffffff",d=r.columns||[],m=r.allowAddRows!==!1,h=r.maxRows||50,g=!!r.required,p=r.headerBg||"#1f2937",f=r.headerColor||"#ffffff",N=!!r.compact,b=r.headerPosition||"top",S=a??[],j=(_,E,q)=>{if(s)return;const we=S.map((J,ke)=>ke===_?{...J,[E]:q}:J);t(we)},y=()=>{if(s||S.length>=h)return;const _={};for(const E of d)_[E.key]=null;t([...S,_])},w=_=>{s||t(S.filter((E,q)=>q!==_))};if(d.length===0)return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(x,{children:n}),e.jsx("p",{className:"text-xs text-muted-foreground italic",children:"Sin columnas definidas"})]});const v=N?"px-1 py-0.5":"px-2 py-1";return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{children:[n,g&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"rounded border overflow-x-auto",children:[c&&e.jsx("div",{className:"px-3 py-1.5 text-sm font-semibold",style:{backgroundColor:i,color:o},children:c}),b==="left"?e.jsx(ia,{columns:d,rows:S,headerBg:p,headerColor:f,cellPad:v,readOnly:!!s,updateCell:j}):e.jsx(oa,{columns:d,rows:S,headerBg:p,headerColor:f,cellPad:v,allowAddRows:m,readOnly:!!s,updateCell:j,removeRow:w})]}),b==="top"&&m&&!s&&S.length<h&&e.jsxs(I,{type:"button",variant:"outline",size:"sm",className:"gap-1",onClick:y,children:[e.jsx(R,{className:"h-3.5 w-3.5"}),"Anadir fila"]})]})}C({definition:k.table,EditorPreview:ta,ConfigPanel:ca,FormField:da});function xa({block:l}){const a=l.config,t=a.label||"",s=a.headerBg||"#1f2937",r=a.headerColor||"#ffffff",n=a.defaultRows||5,c=Math.min(n,3);return e.jsxs("div",{className:"w-full py-1",children:[t&&e.jsx("div",{className:"text-xs font-bold mb-1.5 px-1",children:t}),e.jsxs("div",{className:"border rounded overflow-hidden",children:[e.jsxs("table",{className:"w-full text-[8px] border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:s},children:[e.jsxs("th",{className:"font-medium px-1 py-1 text-center border-r border-white/20",style:{color:r,width:"7%"},rowSpan:2,children:["Uds.",e.jsx("br",{}),"Salida"]}),e.jsx("th",{className:"font-medium px-1 py-1 text-center border-r border-white/20",style:{color:r},colSpan:2,children:"Designacion"}),e.jsx("th",{className:"font-medium px-1 py-1 text-center border-r border-white/20",style:{color:r},colSpan:2,children:"Numero de serie"}),e.jsxs("th",{className:"font-medium px-1 py-1 text-center border-r border-white/20",style:{color:r,width:"12%"},rowSpan:2,children:["Inter-",e.jsx("br",{}),"cambio"]}),e.jsx("th",{className:"font-medium px-1 py-1 text-center border-r border-white/20",style:{color:r,width:"8%"},rowSpan:2,children:"Usado"}),e.jsxs("th",{className:"font-medium px-1 py-1 text-center",style:{color:r,width:"7%"},rowSpan:2,children:["Uds.",e.jsx("br",{}),"Usadas"]})]})}),e.jsx("tbody",{children:Array.from({length:c}).map((i,o)=>{const d=o<2;return e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-200 text-center text-gray-400 align-middle py-2",rowSpan:1,children:d?"1":"-"}),e.jsxs("td",{className:"border border-gray-200 p-0",colSpan:2,children:[e.jsxs("div",{className:"flex border-b border-gray-100",children:[e.jsx("span",{className:"bg-gray-50 px-1.5 py-0.5 font-medium text-gray-500 border-r border-gray-100 shrink-0 w-[38px]",children:"Entrada"}),e.jsx("span",{className:"px-1.5 py-0.5 text-gray-400 flex-1 truncate",children:d?"3HAC044075-001":"-"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"bg-gray-50 px-1.5 py-0.5 font-medium text-gray-500 border-r border-gray-100 shrink-0 w-[38px]",children:"Salida"}),e.jsx("span",{className:"px-1.5 py-0.5 text-gray-400 flex-1 truncate",children:d?"3HAC044075-001":"-"})]})]}),e.jsxs("td",{className:"border border-gray-200 p-0",colSpan:2,children:[e.jsxs("div",{className:"flex border-b border-gray-100",children:[e.jsx("span",{className:"bg-gray-50 px-1.5 py-0.5 font-medium text-gray-500 border-r border-gray-100 shrink-0 w-[38px]",children:"Entrada"}),e.jsx("span",{className:"px-1.5 py-0.5 text-gray-400 flex-1 truncate",children:"-"})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"bg-gray-50 px-1.5 py-0.5 font-medium text-gray-500 border-r border-gray-100 shrink-0 w-[38px]",children:"Salida"}),e.jsx("span",{className:"px-1.5 py-0.5 text-gray-400 flex-1 truncate",children:"-"})]})]}),e.jsx("td",{className:"border border-gray-200 text-center align-middle",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"h-2.5 w-2.5 rounded-sm border border-gray-300"})})}),e.jsx("td",{className:"border border-gray-200 text-center align-middle",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`h-2.5 w-2.5 rounded-sm border ${d?"bg-gray-700 border-gray-700":"border-gray-300"}`})})}),e.jsx("td",{className:"border border-gray-200 text-center text-gray-400 align-middle",children:d?"1":"-"})]},o)})})]}),e.jsx("div",{className:"bg-gray-50 border-t px-2 py-0.5 text-[8px] text-gray-400 text-center italic",children:"+ filas dinamicas"})]})]})}function ma({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(u,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"intercambio_equipos",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Etiqueta"}),e.jsx(u,{value:t.label||"",onChange:s=>a("label",s.target.value),placeholder:"Intercambio de equipos",className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Filas por defecto"}),e.jsx(u,{type:"number",min:1,max:20,value:t.defaultRows||5,onChange:s=>a("defaultRows",parseInt(s.target.value)||5),className:"h-8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-xs font-semibold",children:"Estilo cabecera"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Fondo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.headerBg||"#1f2937",onChange:s=>a("headerBg",s.target.value),className:"h-8 w-8 rounded border cursor-pointer"}),e.jsx(u,{value:t.headerBg||"#1f2937",onChange:s=>a("headerBg",s.target.value),className:"h-8 flex-1 font-mono text-xs"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Texto"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.headerColor||"#ffffff",onChange:s=>a("headerColor",s.target.value),className:"h-8 w-8 rounded border cursor-pointer"}),e.jsx(u,{value:t.headerColor||"#ffffff",onChange:s=>a("headerColor",s.target.value),className:"h-8 flex-1 font-mono text-xs"})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${l.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:`required-${l.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Tabla de intercambio de equipos con entrada/salida de designaciones, numeros de serie, y control de unidades usadas."})]})}function re(){return{unidadesSalida:"",designacionEntrada:"",designacionSalida:"",serieEntrada:"",serieSalida:"",intercambio:!1,usado:!1,unidadesUsadas:""}}function ha({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"",c=!!r.required,i=r.headerBg||"#1f2937",o=r.headerColor||"#ffffff",d=r.defaultRows||5,m=a??Array.from({length:d},re),h=(f,N,b)=>{if(s)return;const S=m.map((j,y)=>y===f?{...j,[N]:b}:j);t(S)},g=()=>{s||t([...m,re()])},p=f=>{s||t(m.filter((N,b)=>b!==f))};return e.jsxs("div",{className:"space-y-2",children:[(n||c)&&e.jsxs(x,{children:[n,c&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsx("div",{className:"rounded border overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:i},children:[e.jsxs("th",{className:"font-medium text-xs px-2 py-1.5 text-center border-r border-white/20",style:{color:o,width:"7%"},children:["Uds.",e.jsx("br",{}),"Salida"]}),e.jsx("th",{className:"font-medium text-xs px-2 py-1.5 text-center border-r border-white/20",style:{color:o},colSpan:2,children:"Designacion"}),e.jsx("th",{className:"font-medium text-xs px-2 py-1.5 text-center border-r border-white/20",style:{color:o},colSpan:2,children:"Numero de serie"}),e.jsxs("th",{className:"font-medium text-xs px-2 py-1.5 text-center border-r border-white/20",style:{color:o,width:"10%"},children:["Inter-",e.jsx("br",{}),"cambio"]}),e.jsx("th",{className:"font-medium text-xs px-2 py-1.5 text-center border-r border-white/20",style:{color:o,width:"8%"},children:"Usado"}),e.jsxs("th",{className:"font-medium text-xs px-2 py-1.5 text-center border-r border-white/20",style:{color:o,width:"7%"},children:["Uds.",e.jsx("br",{}),"Usadas"]}),!s&&e.jsx("th",{className:"w-10"})]})}),e.jsx("tbody",{children:m.map((f,N)=>e.jsxs("tr",{className:N%2===1?"bg-gray-50":"bg-white",children:[e.jsx("td",{className:"border border-gray-200 px-1 text-center align-middle",children:e.jsx(u,{type:"number",min:0,value:f.unidadesSalida,onChange:b=>h(N,"unidadesSalida",b.target.value),readOnly:s,disabled:s,className:"h-auto text-sm text-center border-0 bg-transparent p-0 focus-visible:ring-0"})}),e.jsxs("td",{className:"border border-gray-200 p-0",colSpan:2,children:[e.jsxs("div",{className:"flex items-center border-b border-gray-100",children:[e.jsx("span",{className:"bg-gray-100 px-2 py-1 text-xs font-medium text-gray-500 border-r border-gray-200 shrink-0 w-[60px]",children:"Entrada"}),e.jsx(u,{value:f.designacionEntrada,onChange:b=>h(N,"designacionEntrada",b.target.value),readOnly:s,disabled:s,className:"h-auto text-sm border-0 bg-transparent rounded-none focus-visible:ring-0 px-2 py-1"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"bg-gray-100 px-2 py-1 text-xs font-medium text-gray-500 border-r border-gray-200 shrink-0 w-[60px]",children:"Salida"}),e.jsx(u,{value:f.designacionSalida,onChange:b=>h(N,"designacionSalida",b.target.value),readOnly:s,disabled:s,className:"h-auto text-sm border-0 bg-transparent rounded-none focus-visible:ring-0 px-2 py-1"})]})]}),e.jsxs("td",{className:"border border-gray-200 p-0",colSpan:2,children:[e.jsxs("div",{className:"flex items-center border-b border-gray-100",children:[e.jsx("span",{className:"bg-gray-100 px-2 py-1 text-xs font-medium text-gray-500 border-r border-gray-200 shrink-0 w-[60px]",children:"Entrada"}),e.jsx(u,{value:f.serieEntrada,onChange:b=>h(N,"serieEntrada",b.target.value),readOnly:s,disabled:s,className:"h-auto text-sm border-0 bg-transparent rounded-none focus-visible:ring-0 px-2 py-1"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"bg-gray-100 px-2 py-1 text-xs font-medium text-gray-500 border-r border-gray-200 shrink-0 w-[60px]",children:"Salida"}),e.jsx(u,{value:f.serieSalida,onChange:b=>h(N,"serieSalida",b.target.value),readOnly:s,disabled:s,className:"h-auto text-sm border-0 bg-transparent rounded-none focus-visible:ring-0 px-2 py-1"})]})]}),e.jsx("td",{className:"border border-gray-200 text-center align-middle",children:e.jsx("input",{type:"checkbox",checked:!!f.intercambio,onChange:b=>h(N,"intercambio",b.target.checked),disabled:s,className:"h-4 w-4 rounded border-gray-300"})}),e.jsx("td",{className:"border border-gray-200 text-center align-middle",children:e.jsx("input",{type:"checkbox",checked:!!f.usado,onChange:b=>h(N,"usado",b.target.checked),disabled:s,className:"h-4 w-4 rounded border-gray-300"})}),e.jsx("td",{className:"border border-gray-200 px-1 text-center align-middle",children:e.jsx(u,{type:"number",min:0,value:f.unidadesUsadas,onChange:b=>h(N,"unidadesUsadas",b.target.value),readOnly:s,disabled:s,className:"h-auto text-sm text-center border-0 bg-transparent p-0 focus-visible:ring-0"})}),!s&&e.jsx("td",{className:"px-1 py-1 text-center",children:e.jsx(I,{type:"button",variant:"ghost",size:"icon",className:"h-7 w-7 text-gray-400 hover:text-red-500",onClick:()=>p(N),children:e.jsx(A,{className:"h-3.5 w-3.5"})})})]},N))})]})}),!s&&e.jsxs(I,{type:"button",variant:"outline",size:"sm",className:"gap-1",onClick:g,children:[e.jsx(R,{className:"h-3.5 w-3.5"}),"Anadir equipo"]})]})}C({definition:k.equipment_exchange,EditorPreview:xa,ConfigPanel:ma,FormField:ha});function ua({block:l}){const a=l.config,t=a.label||"",s=a.maxFiles||1;return e.jsxs("div",{className:"py-1",children:[t&&e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:t}),e.jsxs("div",{className:"flex flex-col items-center justify-center rounded border-2 border-dashed border-gray-200 bg-gray-50/50 p-6 gap-1",children:[e.jsx(me,{className:"h-8 w-8 text-gray-300"}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Hasta ",s," archivo",s>1?"s":""]})]})]})}function pa({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(u,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Etiqueta"}),e.jsx(u,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`multi-${l.id}`,checked:!!t.allowMultiple,onChange:s=>a("allowMultiple",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:`multi-${l.id}`,className:"text-xs cursor-pointer",children:"Permitir multiples"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Maximo de archivos"}),e.jsx(u,{type:"number",min:1,max:20,value:t.maxFiles||1,onChange:s=>a("maxFiles",Math.max(1,Math.min(20,Number(s.target.value)||1))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Tamano maximo (MB)"}),e.jsx(u,{type:"number",min:1,max:50,value:t.maxSizeMB||5,onChange:s=>a("maxSizeMB",Math.max(1,Math.min(50,Number(s.target.value)||5))),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(Y).map(([s,r])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.width||"full")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:r},s))})]})]})}function ga({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Imagen",c=r.maxFiles||1,i=r.maxSizeMB||5,o=!!r.required,d=a??[],m=$.useRef(null),h=p=>{if(!p||s)return;const f=c-d.length,N=Array.from(p).slice(0,f);for(const b of N){if(b.size>i*1024*1024){alert(`"${b.name}" supera el limite de ${i} MB.`);continue}if(!b.type.startsWith("image/")){alert(`"${b.name}" no es una imagen valida.`);continue}const S=new FileReader;S.onload=()=>{const j={name:b.name,data:S.result};t([...d,j])},S.readAsDataURL(b)}m.current&&(m.current.value="")},g=p=>{s||t(d.filter((f,N)=>N!==p))};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{children:[n,o&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),d.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map((p,f)=>e.jsxs("div",{className:"relative group rounded border overflow-hidden",style:{width:120,height:90},children:[e.jsx("img",{src:p.data,alt:p.name,className:"w-full h-full object-cover"}),!s&&e.jsx("button",{type:"button",onClick:()=>g(f),className:"absolute top-1 right-1 bg-black/60 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(he,{className:"h-3 w-3"})}),e.jsx("div",{className:"absolute bottom-0 inset-x-0 bg-black/50 text-white text-[9px] px-1 py-0.5 truncate",children:p.name})]},f))}),!s&&d.length<c&&e.jsxs("div",{onClick:()=>{var p;return(p=m.current)==null?void 0:p.click()},onDragOver:p=>{p.preventDefault(),p.stopPropagation()},onDrop:p=>{p.preventDefault(),p.stopPropagation(),h(p.dataTransfer.files)},className:"flex flex-col items-center justify-center gap-2 rounded border-2 border-dashed border-gray-300 bg-gray-50 p-6 cursor-pointer hover:border-blue-400 hover:bg-blue-50/30 transition-colors",children:[e.jsx(ue,{className:"h-6 w-6 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Arrastra imagenes o haz clic para seleccionar"}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:["Max ",i," MB por archivo",c>1&&` · ${d.length}/${c} archivos`]})]}),e.jsx("input",{ref:m,type:"file",accept:"image/*",multiple:c>1,onChange:p=>h(p.target.files),className:"hidden"}),s&&d.length===0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 rounded border border-dashed border-gray-200 p-6",children:[e.jsx(me,{className:"h-6 w-6 text-gray-300"}),e.jsx("span",{className:"text-xs text-gray-400",children:"Sin imagenes"})]})]})}C({definition:k.image,EditorPreview:ua,ConfigPanel:pa,FormField:ga});function fa({block:l}){const a=l.config,t=a.label||"",s=a.role||"",r=!!a.required;return e.jsxs("div",{className:"py-1",children:[(t||r)&&e.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-1",children:[t,r&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center rounded border border-gray-200 bg-gray-50/50 p-4 gap-1",children:[e.jsx(Ye,{className:"h-5 w-5 text-gray-300"}),e.jsx("span",{className:"text-[10px] text-gray-400",children:"Firma"}),s&&e.jsx("span",{className:"text-[9px] text-gray-300",children:s})]})]})}function ba({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Clave (snake_case)"}),e.jsx(u,{value:t.key||"",onChange:s=>{const r=s.target.value.replace(/[^a-z0-9_]/g,"").toLowerCase();a("key",r)},placeholder:"nombre_campo",className:"h-8 font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Etiqueta"}),e.jsx(u,{value:t.label||"",onChange:s=>a("label",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Rol"}),e.jsx(u,{value:t.role||"",onChange:s=>a("role",s.target.value),placeholder:"Tecnico PAS, Responsable cliente...",className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`required-${l.id}`,checked:!!t.required,onChange:s=>a("required",s.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:`required-${l.id}`,className:"text-xs cursor-pointer",children:"Obligatorio"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Ancho"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:Object.entries(Y).map(([s,r])=>e.jsx("button",{className:`rounded border px-2 py-1 text-xs ${(t.width||"half")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("width",s),children:r},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Alineacion horizontal"}),e.jsx("div",{className:"flex gap-1",children:[{value:"left",label:"Izquierda"},{value:"center",label:"Centro"},{value:"right",label:"Derecha"}].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.align||"left")===s.value?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("align",s.value),children:s.label},s.value))})]})]})}const T=400,M=180;function ja({block:l,value:a,onChange:t,readOnly:s}){const r=l.config,n=r.label||"Firma",c=r.role||"",i=!!r.required,o=a??null,d=$.useRef(null),m=$.useRef(!1),[h,g]=$.useState(!1);$.useEffect(()=>{const j=d.current;if(!j)return;const y=j.getContext("2d");if(y)if(y.clearRect(0,0,T,M),o){const w=new window.Image;w.onload=()=>{y.drawImage(w,0,0,T,M),g(!0)},w.src=o}else g(!1)},[o]);const p=$.useCallback(j=>{const y=d.current;if(!y)return{x:0,y:0};const w=y.getBoundingClientRect(),v=T/w.width,_=M/w.height;if("touches"in j){const E=j.touches[0]||j.changedTouches[0];return{x:(E.clientX-w.left)*v,y:(E.clientY-w.top)*_}}return{x:(j.clientX-w.left)*v,y:(j.clientY-w.top)*_}},[]),f=$.useCallback(j=>{var v;if(s)return;j.preventDefault(),m.current=!0;const y=(v=d.current)==null?void 0:v.getContext("2d");if(!y)return;const w=p(j);y.beginPath(),y.moveTo(w.x,w.y),y.lineWidth=2,y.lineCap="round",y.lineJoin="round",y.strokeStyle="#1a1a1a"},[s,p]),N=$.useCallback(j=>{var v;if(!m.current||s)return;j.preventDefault();const y=(v=d.current)==null?void 0:v.getContext("2d");if(!y)return;const w=p(j);y.lineTo(w.x,w.y),y.stroke(),g(!0)},[s,p]),b=$.useCallback(()=>{if(!m.current)return;m.current=!1;const j=d.current;if(!j)return;const y=j.toDataURL("image/png");t(y)},[t]),S=()=>{var y;if(s)return;const j=(y=d.current)==null?void 0:y.getContext("2d");j&&j.clearRect(0,0,T,M),g(!1),t(null)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{children:[n,i&&e.jsx("span",{className:"text-red-500 ml-0.5",children:"*"}),c&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground font-normal",children:["(",c,")"]})]}),!s&&h&&e.jsxs(I,{type:"button",variant:"ghost",size:"sm",className:"gap-1 text-xs h-7",onClick:S,children:[e.jsx(ze,{className:"h-3.5 w-3.5"}),"Borrar"]})]}),e.jsx("div",{className:`rounded border ${s?"border-gray-200 bg-gray-50":"border-gray-300 bg-white"} overflow-hidden`,children:e.jsx("canvas",{ref:d,width:T,height:M,className:`w-full touch-none ${s?"cursor-not-allowed opacity-70":"cursor-crosshair"}`,style:{maxWidth:"100%",height:"auto",aspectRatio:`${T}/${M}`},onMouseDown:f,onMouseMove:N,onMouseUp:b,onMouseLeave:b,onTouchStart:f,onTouchMove:N,onTouchEnd:b})}),!s&&!h&&e.jsx("p",{className:"text-[10px] text-muted-foreground text-center",children:"Dibuja tu firma con el raton o el dedo"})]})}C({definition:k.signature,EditorPreview:fa,ConfigPanel:ba,FormField:ja});function va({block:l}){const a=l.config.section||"portada",t=fe.find(n=>n.id===a),s=(t==null?void 0:t.label)||a,r=(t==null?void 0:t.color)||"#6b7280";return e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-sm select-none",style:{backgroundColor:`${r}15`,borderLeft:`4px solid ${r}`},children:[e.jsx(Xe,{className:"h-4 w-4 shrink-0",style:{color:r}}),e.jsx("span",{className:"text-sm font-semibold tracking-wide",style:{color:r},children:s}),e.jsx("div",{className:"flex-1 border-t border-dashed ml-2",style:{borderColor:`${r}40`}})]})}function Na({block:l}){const a=l.config.section||"portada",t=fe.find(n=>n.id===a),s=(t==null?void 0:t.label)||a,r=(t==null?void 0:t.color)||"#6b7280";return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Seccion"}),e.jsxs("div",{className:"flex items-center gap-2 rounded border px-3 py-2",style:{borderColor:r,backgroundColor:`${r}10`},children:[e.jsx("div",{className:"h-3 w-3 rounded-full",style:{backgroundColor:r}}),e.jsx("span",{className:"text-sm font-medium",style:{color:r},children:s})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground leading-relaxed",children:["Este separador marca el inicio de la seccion ",e.jsx("strong",{children:s}),". No se puede mover, duplicar ni eliminar. Todos los bloques debajo pertenecen a esta seccion hasta el siguiente separador."]}),a==="intermedia"&&e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed border-l-2 border-green-500 pl-2",children:"La pagina intermedia define la cabecera y pie que se repiten en todas las paginas de contenido del documento."})]})}C({definition:k.section_separator,EditorPreview:va,ConfigPanel:Na});const ya={top:"flex-start",center:"center",bottom:"flex-end"};function wa({block:l}){const a=l.config,t=a.title||"Reporte de mantenimiento",s=a.subtitle||"",r=a.companyName||"PAS Robotics",n=a.logoPosition||"right",c=a.logoVerticalAlign||"center",i=a.backgroundColor||"#000000",o=a.textColor||"#ffffff",d=a.titleSize||24,m=a.logoUrl||"",h=a.height||280,g=W(),p=m||g;return e.jsxs("div",{className:"w-full px-8 flex gap-6",style:{backgroundColor:i,height:`${h}px`,flexDirection:n==="right"?"row":"row-reverse",alignItems:ya[c]||"center"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium tracking-widest uppercase mb-2",style:{color:o,opacity:.6},children:r}),e.jsx("h1",{className:"font-extrabold leading-tight",style:{color:o,fontSize:`${d}px`},children:t}),s&&e.jsx("p",{className:"text-sm mt-2",style:{color:o,opacity:.7},children:s})]}),e.jsx("div",{className:"shrink-0",children:p?e.jsx("img",{src:p,alt:"Logo",className:"h-20 w-auto object-contain"}):e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-lg",style:{border:"2px dashed rgba(255,255,255,0.3)"},children:e.jsx(D,{className:"h-10 w-10",style:{color:"rgba(255,255,255,0.4)"}})})})]})}function ne({value:l,onChange:a,min:t,max:s,fallback:r}){return e.jsx(u,{type:"number",min:t,max:s,value:l,onChange:n=>{const c=n.target.value;c!==""&&a(Number(c))},onBlur:n=>{const c=Number(n.target.value);!c||isNaN(c)?a(r):a(Math.max(t,Math.min(s,c)))},className:"h-8"})}function ce({label:l,value:a,fallback:t,onChange:s}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:l}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:a||t,onChange:r=>s(r.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:a||t,onChange:r=>s(r.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})}function ka({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Titulo del reporte"}),e.jsx(u,{value:t.title||"",onChange:s=>a("title",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Subtitulo"}),e.jsx(u,{value:t.subtitle||"",onChange:s=>a("subtitle",s.target.value),className:"h-8",placeholder:"Ej: IRB1200-5/0.9 - IRC5 Compact"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Nombre de empresa"}),e.jsx(u,{value:t.companyName||"",onChange:s=>a("companyName",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Posicion horizontal del logo"}),e.jsx("div",{className:"flex gap-1",children:["left","right"].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.logoPosition||"right")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("logoPosition",s),children:s==="left"?"Izquierda":"Derecha"},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Alineacion vertical del logo"}),e.jsx("div",{className:"flex gap-1",children:["top","center","bottom"].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.logoVerticalAlign||"center")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("logoVerticalAlign",s),children:s==="top"?"Arriba":s==="center"?"Centro":"Abajo"},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"URL del logo (opcional)"}),e.jsx(u,{value:t.logoUrl||"",onChange:s=>a("logoUrl",s.target.value),placeholder:"Vacio = usa logo de Configuracion General",className:"h-8"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Si no se indica, usa el logo de Configuracion > General."})]}),e.jsx(ce,{label:"Color de fondo",value:t.backgroundColor||"",fallback:"#000000",onChange:s=>a("backgroundColor",s)}),e.jsx(ce,{label:"Color del texto",value:t.textColor||"",fallback:"#ffffff",onChange:s=>a("textColor",s)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Tamano del titulo (px)"}),e.jsx(ne,{value:t.titleSize||24,onChange:s=>a("titleSize",s),min:12,max:60,fallback:24})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Altura del banner (px)"}),e.jsx(ne,{value:t.height||280,onChange:s=>a("height",s),min:100,max:600,fallback:280})]})]})}C({definition:k.cover_header,EditorPreview:wa,ConfigPanel:ka});function Ca({block:l}){const a=l.config,t=a.title||"Reporte de mantenimiento",s=a.subtitle||"",r=a.backgroundColor||"#1f2937",n=a.textColor||"#ffffff",c=a.textSize||12,i=a.logoSize||24,o=a.logoUrl||"",d=a.height||40,m=W(),h=o||m;return e.jsxs("div",{className:"w-full px-4 flex items-center justify-between",style:{backgroundColor:r,height:`${d}px`},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold",style:{color:n,fontSize:`${c}px`},children:t}),s&&e.jsx("span",{style:{color:n,opacity:.6,fontSize:`${Math.max(c-2,8)}px`},children:s})]}),e.jsx("div",{className:"shrink-0",children:h?e.jsx("img",{src:h,alt:"Logo",className:"w-auto object-contain",style:{height:`${i}px`}}):e.jsx("div",{className:"flex items-center justify-center",style:{height:`${i}px`,width:`${i}px`},children:e.jsx(D,{className:"h-4 w-4",style:{color:"rgba(255,255,255,0.5)"}})})})]})}function V({value:l,onChange:a,min:t,max:s,fallback:r}){return e.jsx(u,{type:"number",min:t,max:s,value:l,onChange:n=>{const c=n.target.value;c!==""&&a(Number(c))},onBlur:n=>{const c=Number(n.target.value);!c||isNaN(c)?a(r):a(Math.max(t,Math.min(s,c)))},className:"h-8"})}function oe({label:l,value:a,fallback:t,onChange:s}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:l}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:a||t,onChange:r=>s(r.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:a||t,onChange:r=>s(r.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})}function _a({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Titulo"}),e.jsx(u,{value:t.title||"",onChange:s=>a("title",s.target.value),className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Subtitulo"}),e.jsx(u,{value:t.subtitle||"",onChange:s=>a("subtitle",s.target.value),className:"h-8",placeholder:"Ej: IRB1200-5/0.9 - IRC5 Compact"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"URL del logo (opcional)"}),e.jsx(u,{value:t.logoUrl||"",onChange:s=>a("logoUrl",s.target.value),placeholder:"Vacio = usa logo de Configuracion General",className:"h-8"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Si no se indica, usa el logo de Configuracion > General."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Tamano del logo (px)"}),e.jsx(V,{value:t.logoSize||24,onChange:s=>a("logoSize",s),min:12,max:80,fallback:24})]}),e.jsx(oe,{label:"Color de fondo",value:t.backgroundColor||"",fallback:"#1f2937",onChange:s=>a("backgroundColor",s)}),e.jsx(oe,{label:"Color del texto",value:t.textColor||"",fallback:"#ffffff",onChange:s=>a("textColor",s)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Tamano del texto (px)"}),e.jsx(V,{value:t.textSize||12,onChange:s=>a("textSize",s),min:8,max:24,fallback:12})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Altura (px)"}),e.jsx(V,{value:t.height||40,onChange:s=>a("height",s),min:24,max:120,fallback:40})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Esta cabecera aparece en la parte superior de todas las paginas intermedias del documento."})]})}C({definition:k.page_header,EditorPreview:Ca,ConfigPanel:_a});function Sa({block:l}){const a=l.config,t=a.companyName||"PAS Robotics",s=a.showPageNumbers!==!1,r=a.backgroundColor||"#1f2937",n=a.textColor||"#ffffff",c=a.textSize||10,i=a.backgroundImage||"",o=a.height||36;return e.jsxs("div",{className:"w-full relative overflow-hidden flex items-center justify-between px-4",style:{height:`${o}px`,backgroundColor:r},children:[i&&e.jsx("img",{src:i,alt:"",className:"absolute inset-0 w-full h-full object-cover"}),e.jsx("span",{className:"font-bold relative z-[1]",style:{color:n,fontSize:`${c}px`},children:t}),s&&e.jsx("span",{className:"relative z-[1]",style:{color:n,opacity:.8,fontSize:`${Math.max(c-1,7)}px`},children:"Pagina X de N"})]})}function ie({value:l,onChange:a,min:t,max:s,fallback:r}){return e.jsx(u,{type:"number",min:t,max:s,value:l,onChange:n=>{const c=n.target.value;c!==""&&a(Number(c))},onBlur:n=>{const c=Number(n.target.value);!c||isNaN(c)?a(r):a(Math.max(t,Math.min(s,c)))},className:"h-8"})}function de({label:l,value:a,fallback:t,onChange:s}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:l}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:a||t,onChange:r=>s(r.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:a||t,onChange:r=>s(r.target.value),className:"h-8 font-mono text-xs flex-1"})]})]})}function Pa({block:l,onChange:a}){const t=l.config,s=$.useRef(null),r=t.backgroundImage||"",n=c=>{var d;const i=(d=c.target.files)==null?void 0:d[0];if(!i||!i.type.startsWith("image/"))return;if(i.size>500*1024){alert("La imagen no puede superar los 500KB");return}const o=new FileReader;o.onload=()=>a("backgroundImage",o.result),o.readAsDataURL(i),c.target.value=""};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Nombre de empresa"}),e.jsx(u,{value:t.companyName||"",onChange:c=>a("companyName",c.target.value),className:"h-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"showPageNumbers",checked:t.showPageNumbers!==!1,onChange:c=>a("showPageNumbers",c.target.checked),className:"h-4 w-4 rounded"}),e.jsx(x,{htmlFor:"showPageNumbers",className:"text-xs cursor-pointer",children:"Mostrar numeros de pagina"})]}),e.jsx(de,{label:"Color de fondo",value:t.backgroundColor||"",fallback:"#1f2937",onChange:c=>a("backgroundColor",c)}),e.jsx(de,{label:"Color del texto",value:t.textColor||"",fallback:"#ffffff",onChange:c=>a("textColor",c)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Tamano del texto (px)"}),e.jsx(ie,{value:t.textSize||10,onChange:c=>a("textSize",c),min:6,max:18,fallback:10})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Imagen de fondo (opcional)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:s,type:"file",accept:"image/*",onChange:n,className:"hidden"}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{var c;return(c=s.current)==null?void 0:c.click()},children:[e.jsx(ue,{className:"h-3 w-3 mr-1"}),r?"Cambiar":"Subir"]}),r&&e.jsxs(I,{variant:"ghost",size:"sm",onClick:()=>a("backgroundImage",""),className:"text-destructive hover:text-destructive",children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),"Quitar"]})]}),r&&e.jsx("div",{className:"mt-1 h-10 w-full rounded border overflow-hidden",children:e.jsx("img",{src:r,alt:"Fondo",className:"w-full h-full object-cover"})}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"PNG o JPG. Max 500KB."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Altura (px)"}),e.jsx(ie,{value:t.height||36,onChange:c=>a("height",c),min:20,max:80,fallback:36})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Este pie aparece en la parte inferior de todas las paginas de la seccion donde se coloque."})]})}C({definition:k.page_footer,EditorPreview:Sa,ConfigPanel:Pa});function $a({block:l}){const a=l.config,t=a.logoUrl||"",s=a.backgroundColor||"#111827",r=W(),n=t||r;return e.jsx("div",{className:"w-full flex-1 flex items-center justify-center",style:{backgroundColor:s},children:n?e.jsx("img",{src:n,alt:"Logo",className:"max-h-24 max-w-[240px] object-contain"}):e.jsxs("div",{className:"flex flex-col items-center gap-2 opacity-60",children:[e.jsx(D,{className:"h-14 w-14 text-white"}),e.jsx("span",{className:"text-white/50 text-[10px]",children:"Logo de empresa"})]})})}function Ia({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"URL del logo (opcional)"}),e.jsx(u,{value:t.logoUrl||"",onChange:s=>a("logoUrl",s.target.value),placeholder:"Vacio = usa logo de Configuracion General",className:"h-8"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Si no se indica, usa el logo de Configuracion > General."})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Color de fondo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.backgroundColor||"#111827",onChange:s=>a("backgroundColor",s.target.value),className:"h-8 w-8 cursor-pointer rounded border"}),e.jsx(u,{value:t.backgroundColor||"#111827",onChange:s=>a("backgroundColor",s.target.value),className:"h-8 font-mono text-xs flex-1"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Pagina final del documento con fondo oscuro y logo centrado."})]})}C({definition:k.back_cover,EditorPreview:$a,ConfigPanel:Ia});function Ea({}){return e.jsxs("div",{className:"w-full flex items-center gap-3 py-2 px-4",children:[e.jsx("div",{className:"flex-1 border-t-2 border-dashed border-muted-foreground/30"}),e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground/50 shrink-0",children:[e.jsx(Ze,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"text-[10px] uppercase tracking-wider font-medium",children:"Salto de pagina"})]}),e.jsx("div",{className:"flex-1 border-t-2 border-dashed border-muted-foreground/30"})]})}function Ta({}){return e.jsx("div",{className:"space-y-3",children:e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Este bloque fuerza un salto de pagina. Todo el contenido posterior aparecera en la siguiente pagina."})})}C({definition:k.page_break,EditorPreview:Ea,ConfigPanel:Ta});const H=[{value:"all",label:"Todo el contenido",description:"Inserta todas las secciones del sistema",icon:"LayoutTemplate"},{value:"controller_info",label:"Informacion de controladora / Drive Unit",description:"Datos tecnicos y estado de la controladora",icon:"Cpu"},{value:"manipulator_info",label:"Informacion de manipuladores",description:"Datos tecnicos de los manipuladores del sistema",icon:"Bot"},{value:"manipulator_installation",label:"Instalacion de manipuladores",description:"Informacion sobre la instalacion fisica de los manipuladores",icon:"Wrench"},{value:"mechanical_unit_control",label:"Control de la unidad mecanica",description:"Revision y estado de la unidad mecanica",icon:"Cog"},{value:"cabinet_control",label:"Control del armario",description:"Revision y estado del armario electrico",icon:"Server"},{value:"programming_unit_control",label:"Control de la unidad de programacion",description:"Revision del teach pendant / unidad de programacion",icon:"Tablet"},{value:"system_control",label:"Control del sistema",description:"Control general del sistema completo",icon:"Settings"}];Object.fromEntries(H.map(l=>[l.value,l.label]));const Ma={LayoutTemplate:pe,Cpu:$e,Bot:D,Wrench:Pe,Cog:Se,Server:es,Tablet:ts,Settings:_e};function Aa({block:l}){const a=l.config.contentType||"all",t=H[0],s=H.find(n=>n.value===a)??t,r=Ma[s.icon]||pe;return e.jsxs("div",{className:"w-full border-2 border-dashed border-blue-300 bg-blue-50/50 rounded-md p-4 flex flex-col items-center justify-center gap-1.5",children:[e.jsx(r,{className:"h-7 w-7 text-blue-400"}),e.jsx("span",{className:"text-xs font-medium text-blue-600",children:s.label}),e.jsx("span",{className:"text-[10px] text-blue-400 text-center max-w-[240px]",children:s.description}),a!=="all"&&e.jsx("span",{className:"mt-1 inline-block px-2 py-0.5 rounded-full bg-blue-100 text-[9px] font-medium text-blue-600 uppercase tracking-wide",children:"Seccion parcial"})]})}function Ra({block:l,onChange:a}){const s=l.config.contentType||"all";return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs font-semibold",children:"Tipo de contenido"}),e.jsx("p",{className:"text-[10px] text-muted-foreground mb-2",children:"Selecciona que informacion del sistema se insertara en este bloque"}),e.jsx("div",{className:"space-y-1",children:H.map(r=>e.jsxs("label",{className:`flex items-start gap-2 p-2 rounded-md border cursor-pointer transition-colors ${s===r.value?"border-blue-400 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[e.jsx("input",{type:"radio",name:`contentType-${l.id}`,value:r.value,checked:s===r.value,onChange:()=>{a("contentType",r.value),a("label",r.label)},className:"mt-0.5 h-3.5 w-3.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs font-medium",children:r.label}),e.jsx("div",{className:"text-[10px] text-muted-foreground",children:r.description})]})]},r.value))})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsx("p",{className:"text-[10px] text-muted-foreground leading-relaxed",children:"Al generar un informe, este bloque se reemplazara por las secciones correspondientes definidas en la plantilla del componente del sistema."})})]})}C({definition:k.content_placeholder,EditorPreview:Aa,ConfigPanel:Ra});const qa=[{title:"Intervencion",fields:[{label:"Actividad",placeholder:"Nivel 1"},{label:"Orden de trabajo",placeholder:"OT26-XXXXX"},{label:"Fecha",placeholder:"DD/MM/YYYY"},{label:"Horas",placeholder:"2:30"},{label:"Hora inicio",placeholder:"HH:MM"},{label:"Hora fin",placeholder:"HH:MM"}]},{title:"Personal",fields:[{label:"Tecnico PAS",placeholder:"Nombre"},{label:"Tecnico cliente",placeholder:"Nombre"},{label:"Tel. tecnico",placeholder:"+34 XXX XX XX XX"},{label:"Tel. contacto",placeholder:"+34 XXX XX XX XX"},{label:"Email tecnico",placeholder:"email@empresa.com"},{label:"Email contacto",placeholder:"email@cliente.com"}]}];function Da({block:l}){const a=l.config,t=a.title||"",s=a.accentColor||"#1e40af";return e.jsxs("div",{className:"w-full",children:[t&&e.jsx("div",{className:"text-[10px] font-bold uppercase tracking-wider mb-2 px-1",style:{color:s},children:t}),e.jsx("div",{className:"border border-gray-200 rounded overflow-hidden",children:qa.map((r,n)=>e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-1 text-[8px] font-bold uppercase tracking-wider text-white",style:{backgroundColor:s},children:r.title}),e.jsx("div",{className:"grid grid-cols-2",children:r.fields.map((c,i)=>e.jsxs("div",{className:`flex border-b border-gray-100 ${i%2===0?"border-r border-r-gray-100":""}`,children:[e.jsx("span",{className:"text-[8px] font-semibold text-gray-600 bg-gray-50 px-2 py-1 shrink-0 w-[90px]",children:c.label}),e.jsx("span",{className:"text-[8px] text-gray-400 px-2 py-1 flex-1 truncate",children:c.placeholder})]},i))})]},n))})]})}function Fa({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Titulo (opcional)"}),e.jsx(u,{value:t.title||"",onChange:s=>a("title",s.target.value),placeholder:"Ej: Datos de la intervencion",className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Color de acento"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t.accentColor||"#1e40af",onChange:s=>a("accentColor",s.target.value),className:"h-8 w-10 rounded border cursor-pointer"}),e.jsx(u,{value:t.accentColor||"#1e40af",onChange:s=>a("accentColor",s.target.value),className:"h-8 flex-1 font-mono text-xs"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Alineacion vertical en pagina"}),e.jsx("div",{className:"flex gap-1",children:["top","center","bottom"].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.verticalAlign||"top")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("verticalAlign",s),children:s==="top"?"Arriba":s==="center"?"Centro":"Abajo"},s))})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Datos de la intervencion agrupados por secciones. Se rellenan automaticamente al crear el informe."})]})}C({definition:k.intervention_data,EditorPreview:Da,ConfigPanel:Fa});function Ba({block:l}){const t=l.config.title||"";return e.jsxs("div",{className:"w-full",children:[t&&e.jsx("h3",{className:"text-xs font-bold mb-1.5 px-1",children:t}),e.jsxs("div",{className:"flex items-start gap-4 border border-gray-200 rounded p-3",children:[e.jsx("div",{className:"shrink-0 w-16 h-12 bg-gray-100 rounded flex items-center justify-center",children:e.jsx(Ie,{className:"h-6 w-6 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700",children:"Nombre del cliente"}),e.jsxs("div",{className:"text-[10px] text-gray-500 mt-1 space-y-0.5",children:[e.jsx("div",{children:"Direccion del cliente"}),e.jsx("div",{children:"Ciudad, CP (Provincia)"})]})]})]})]})}function La({block:l,onChange:a}){const t=l.config;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Titulo (opcional)"}),e.jsx(u,{value:t.title||"",onChange:s=>a("title",s.target.value),placeholder:"Ej: Datos del cliente",className:"h-8"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"Alineacion vertical en pagina"}),e.jsx("div",{className:"flex gap-1",children:["top","center","bottom"].map(s=>e.jsx("button",{className:`flex-1 rounded border px-2 py-1 text-xs ${(t.verticalAlign||"top")===s?"border-primary bg-primary/5 text-primary":"border-border hover:bg-accent"}`,onClick:()=>a("verticalAlign",s),children:s==="top"?"Arriba":s==="center"?"Centro":"Abajo"},s))})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:"Muestra los datos del cliente (nombre, logo, direccion) del informe. Se rellena automaticamente con los datos del cliente asignado."})]})}C({definition:k.client_data,EditorPreview:Ba,ConfigPanel:La});export{Ae as A,Xa as B,Be as C,ge as D,Oa as F,pe as L,Ye as P,Q as S,Ke as a,Ga as b,k as c,bs as d,Ua as e,Ha as f,Va as g,X as u};
